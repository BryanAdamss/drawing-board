import"crypto";var __assign=function(){return __assign=Object.assign||function(e){for(var t=1,a=arguments.length,n;t<a;t++)for(var r in n=arguments[t],n)Object.prototype.hasOwnProperty.call(n,r)&&(e[r]=n[r]);return e},__assign.apply(this,arguments)};function __read(t,a){var o="function"==typeof Symbol&&t[Symbol.iterator];if(!o)return t;var s=o.call(t),i=[],p,l;try{for(;(void 0===a||0<a--)&&!(p=s.next()).done;)i.push(p.value)}catch(e){l={error:e}}finally{try{p&&!p.done&&(o=s["return"])&&o.call(s)}finally{if(l)throw l.error}}return i}var inBrowser="undefined"!=typeof window,UA=inBrowser?window.navigator.userAgent.toLowerCase():"",isIE=!!UA&&/msie|trident/.test(UA);function blob2File(e,t){return isIE?(e.lastModifiedDate=new Date,e.name=t,e):new File([e],t,{type:e.type})}var getImageFromURL=function(e){return new Promise(function(t,n){if(!/^(http[s]?)|(data:image)/.test(e))return void n(new Error("\u56FE\u7247url\u683C\u5F0F\u4E0D\u6B63\u786E"));var i=new Image;i.src=e,i.onload=function(){t(i)},i.onerror=n,(i.complete||i.complete===void 0)&&(i.src="data:image/gif;base64,R0lGODlhAQABAIAAAAAAAP///ywAAAAAAQABAAACAUwAOw==",i.src=e)})},$=function(e){return document.querySelector(e)},MSG_CONTAINER_MISS_SELECTOR="container\u4E3A\u5FC5\u586B\u9879",MSG_CONTAINER_NOT_FOUND="\u627E\u4E0D\u5230container",MSG_ANGLE_NOT_LAWFUL="\u8BF7\u4F20\u5165\u5408\u6CD5\u7684\u89D2\u5EA6\u503C",MSG_CTX_CANT_GET="\u65E0\u6CD5\u83B7\u53D6\u5230context",MSG_LAST_DRAG_POINT_NOT_FOUNT="lastDragPoint\u65E0\u6CD5\u83B7\u53D6",MSG_LAST_PAINT_POINT_NOT_FOUNT="lastPaintPoint\u65E0\u6CD5\u83B7\u53D6",MSG_BG_URL_NOT_LAWFUL="\u8BF7\u4F20\u5165\u5408\u6CD5\u7684url",MSG_BLOB_CANT_GEN="\u751F\u6210blob\u9519\u8BEF",MSG_DATAURL_CANT_GEN="\u751F\u6210dataURL\u9519\u8BEF",DEFAULT_CONFIG={epsilon:1e-12,matrix:"Matrix",number:"number",precision:64,predictable:!1,randomSeed:null};function isNumber(e){return"number"==typeof e}function isBigNumber(e){return e&&!0===e.constructor.prototype.isBigNumber||!1}function isComplex(e){return e&&"object"==typeof e&&!0===Object.getPrototypeOf(e).isComplex||!1}function isFraction(e){return e&&"object"==typeof e&&!0===Object.getPrototypeOf(e).isFraction||!1}function isUnit(e){return e&&!0===e.constructor.prototype.isUnit||!1}function isString(e){return"string"==typeof e}var isArray=Array.isArray;function isMatrix(e){return e&&!0===e.constructor.prototype.isMatrix||!1}function isCollection(e){return Array.isArray(e)||isMatrix(e)}function isDenseMatrix(e){return e&&e.isDenseMatrix&&!0===e.constructor.prototype.isMatrix||!1}function isSparseMatrix(e){return e&&e.isSparseMatrix&&!0===e.constructor.prototype.isMatrix||!1}function isRange(e){return e&&!0===e.constructor.prototype.isRange||!1}function isIndex(e){return e&&!0===e.constructor.prototype.isIndex||!1}function isBoolean(e){return"boolean"==typeof e}function isResultSet(e){return e&&!0===e.constructor.prototype.isResultSet||!1}function isHelp(e){return e&&!0===e.constructor.prototype.isHelp||!1}function isFunction(e){return"function"==typeof e}function isDate(e){return e instanceof Date}function isRegExp(e){return e instanceof RegExp}function isObject(e){return!(!e||"object"!=typeof e||e.constructor!==Object||isComplex(e)||isFraction(e))}function isNull(e){return null===e}function isUndefined(e){return e===void 0}function isAccessorNode(e){return e&&!0===e.isAccessorNode&&!0===e.constructor.prototype.isNode||!1}function isArrayNode(e){return e&&!0===e.isArrayNode&&!0===e.constructor.prototype.isNode||!1}function isAssignmentNode(e){return e&&!0===e.isAssignmentNode&&!0===e.constructor.prototype.isNode||!1}function isBlockNode(e){return e&&!0===e.isBlockNode&&!0===e.constructor.prototype.isNode||!1}function isConditionalNode(e){return e&&!0===e.isConditionalNode&&!0===e.constructor.prototype.isNode||!1}function isConstantNode(e){return e&&!0===e.isConstantNode&&!0===e.constructor.prototype.isNode||!1}function isFunctionAssignmentNode(e){return e&&!0===e.isFunctionAssignmentNode&&!0===e.constructor.prototype.isNode||!1}function isFunctionNode(e){return e&&!0===e.isFunctionNode&&!0===e.constructor.prototype.isNode||!1}function isIndexNode(e){return e&&!0===e.isIndexNode&&!0===e.constructor.prototype.isNode||!1}function isNode(e){return e&&!0===e.isNode&&!0===e.constructor.prototype.isNode||!1}function isObjectNode(e){return e&&!0===e.isObjectNode&&!0===e.constructor.prototype.isNode||!1}function isOperatorNode(e){return e&&!0===e.isOperatorNode&&!0===e.constructor.prototype.isNode||!1}function isParenthesisNode(e){return e&&!0===e.isParenthesisNode&&!0===e.constructor.prototype.isNode||!1}function isRangeNode(e){return e&&!0===e.isRangeNode&&!0===e.constructor.prototype.isNode||!1}function isSymbolNode(e){return e&&!0===e.isSymbolNode&&!0===e.constructor.prototype.isNode||!1}function isChain(e){return e&&!0===e.constructor.prototype.isChain||!1}function typeOf(e){var n=typeof e;return"object"==n?null===e?"null":Array.isArray(e)?"Array":e instanceof Date?"Date":e instanceof RegExp?"RegExp":isBigNumber(e)?"BigNumber":isComplex(e)?"Complex":isFraction(e)?"Fraction":isMatrix(e)?"Matrix":isUnit(e)?"Unit":isIndex(e)?"Index":isRange(e)?"Range":isResultSet(e)?"ResultSet":isNode(e)?e.type:isChain(e)?"Chain":isHelp(e)?"Help":"Object":"function"==n?"Function":n}function clone(e){var t=typeof e;if("number"==t||"string"==t||"boolean"==t||null===e||e===void 0)return e;if("function"==typeof e.clone)return e.clone();if(Array.isArray(e))return e.map(function(e){return clone(e)});if(e instanceof Date)return new Date(e.valueOf());if(isBigNumber(e))return e;if(e instanceof RegExp)throw new TypeError("Cannot clone "+e);return mapObject(e,clone)}function mapObject(e,t){var n={};for(var i in e)hasOwnProperty(e,i)&&(n[i]=t(e[i]));return n}function extend(e,t){for(var n in t)hasOwnProperty(t,n)&&(e[n]=t[n]);return e}function deepStrictEqual(e,t){var n,a,r;if(Array.isArray(e)){if(!Array.isArray(t))return!1;if(e.length!==t.length)return!1;for(a=0,r=e.length;a<r;a++)if(!deepStrictEqual(e[a],t[a]))return!1;return!0}if("function"==typeof e)return e===t;if(e instanceof Object){if(Array.isArray(t)||!(t instanceof Object))return!1;for(n in e)if(!(n in t)||!deepStrictEqual(e[n],t[n]))return!1;for(n in t)if(!(n in e)||!deepStrictEqual(e[n],t[n]))return!1;return!0}return e===t}function hasOwnProperty(e,t){return e&&Object.hasOwnProperty.call(e,t)}function pickShallow(e,t){for(var n={},a=0;a<t.length;a++){var r=t[a],o=e[r];o!==void 0&&(n[r]=o)}return n}var MATRIX_OPTIONS=["Matrix","Array"],NUMBER_OPTIONS=["number","BigNumber","Fraction"];function _extends(){return _extends=Object.assign||function(e){for(var t=1,n;t<arguments.length;t++)for(var a in n=arguments[t],n)Object.prototype.hasOwnProperty.call(n,a)&&(e[a]=n[a]);return e},_extends.apply(this,arguments)}var config=function(e){if(e)throw new Error("The global config is readonly. \nPlease create a mathjs instance if you want to change the default configuration. \nExample:\n\n  import { create, all } from 'mathjs';\n  const mathjs = create(all);\n  mathjs.config({ number: 'BigNumber' });\n");return Object.freeze(DEFAULT_CONFIG)};_extends(config,DEFAULT_CONFIG,{MATRIX_OPTIONS,NUMBER_OPTIONS});var commonjsGlobal="undefined"==typeof globalThis?"undefined"==typeof window?"undefined"==typeof global?"undefined"==typeof self?{}:self:global:window:globalThis;function unwrapExports(e){return e&&e.__esModule&&Object.prototype.hasOwnProperty.call(e,"default")?e["default"]:e}function createCommonjsModule(e,t){return t={exports:{}},e(t,t.exports),t.exports}var typedFunction=createCommonjsModule(function(e){var t=Math.max,n=Math.min;(function(t,n){e.exports=n()})(commonjsGlobal,function(){function e(){return!0}function i(){return!1}function a(){}function r(){function o(e){var t=H($.types,function(t){return t.name===e});if(t)return t;if("any"===e)return G;var n=H($.types,function(t){return t.name.toLowerCase()===e.toLowerCase()});throw new TypeError("Unknown type \""+e+"\""+(n?". Did you mean \""+n.name+"\"?":""))}function s(e){return e===G?999:$.types.indexOf(e)}function p(e){var t=H($.types,function(t){return t.test(e)});if(t)return t.name;throw new TypeError("Value has unknown type. Value: "+e)}function l(e,t){var n=p(e);if(t===n)return e;for(var a=0,r;a<$.conversions.length;a++)if(r=$.conversions[a],r.from===n&&r.to===t)return r.convert(e);throw new Error("Cannot convert from "+n+" to "+t)}function d(e){return e.map(function(e){var t=e.types.map(f);return(e.restParam?"...":"")+t.join("|")}).join(",")}function c(e,t){var n=0===e.indexOf("..."),i=n?3<e.length?e.slice(3):"any":e,a=i.split("|").map(w).filter(T).filter(O),r=C(t,a),p=a.map(function(e){var t=o(e);return{name:e,typeIndex:s(t),test:t.test,conversion:null,conversionIndex:-1}}),l=r.map(function(e){var n=o(e.from);return{name:e.from,typeIndex:s(n),test:n.test,conversion:e,conversionIndex:t.indexOf(e)}});return{types:p.concat(l),restParam:n}}function m(e,t,n){var i=[];return""!==e.trim()&&(i=e.split(",").map(w).map(function(e,t,i){var a=c(e,n);if(a.restParam&&t!==i.length-1)throw new SyntaxError("Unexpected rest parameter \""+e+"\": only allowed for the last parameter");return a})),i.some(B)?null:{params:i,fn:t}}function u(e){var t=R(e);return!!t&&t.restParam}function g(e){return e.types.some(function(e){return null!=e.conversion})}function h(t){if(!t||0===t.types.length)return e;if(1===t.types.length)return o(t.types[0].name).test;if(2===t.types.length){var n=o(t.types[0].name).test,i=o(t.types[1].name).test;return function(e){return n(e)||i(e)}}var a=t.types.map(function(e){return o(e.name).test});return function(e){for(var t=0;t<a.length;t++)if(a[t](e))return!0;return!1}}function y(e){var t,n,i;if(u(e)){t=L(e).map(h);var a=t.length,r=h(R(e)),o=function(e){for(var t=a;t<e.length;t++)if(!r(e[t]))return!1;return!0};return function(e){for(var n=0;n<t.length;n++)if(!t[n](e[n]))return!1;return o(e)&&e.length>=a+1}}return 0===e.length?function(e){return 0===e.length}:1===e.length?(n=h(e[0]),function(e){return n(e[0])&&1===e.length}):2===e.length?(n=h(e[0]),i=h(e[1]),function(e){return n(e[0])&&i(e[1])&&2===e.length}):(t=e.map(h),function(e){for(var n=0;n<t.length;n++)if(!t[n](e[n]))return!1;return e.length===t.length})}function x(e,t){return t<e.params.length?e.params[t]:u(e.params)?R(e.params):null}function _(e,t,n){var i=x(e,t),a=i?n?i.types.filter(v):i.types:[];return a.map(f)}function f(e){return e.name}function v(e){return null===e.conversion||void 0===e.conversion}function b(e,t){var n=V(Y(e,function(e){return _(e,t,!1)}));return-1===n.indexOf("any")?n:["any"]}function M(e,i,a){var r=e||"unnamed",o=a,s,l,d;for(d=0;d<i.length;d++){var c=o.filter(function(e){var t=h(x(e,d));return(d<e.params.length||u(e.params))&&t(i[d])});if(0!==c.length)o=c;else if(l=b(o,d),0<l.length){var m=p(i[d]);return s=new TypeError("Unexpected type of argument in function "+r+" (expected: "+l.join(" or ")+", actual: "+m+", index: "+d+")"),s.data={category:"wrongType",fn:r,index:d,actual:m,expected:l},s}}var g=o.map(function(e){return u(e.params)?1/0:e.params.length});if(i.length<n.apply(null,g))return l=b(o,d),s=new TypeError("Too few arguments in function "+r+" (expected: "+l.join(" or ")+", index: "+i.length+")"),s.data={category:"tooFewArgs",fn:r,index:i.length,expected:l},s;var y=t.apply(null,g);return i.length>y?(s=new TypeError("Too many arguments in function "+r+" (expected: "+y+", actual: "+i.length+")"),s.data={category:"tooManyArgs",fn:r,index:i.length,expectedLength:y},s):(s=new TypeError("Arguments of type \""+i.join(", ")+"\" do not match any of the defined signatures of function "+r+"."),s.data={category:"mismatch",actual:i.map(p)},s)}function S(e){for(var t=999,a=0;a<e.types.length;a++)v(e.types[a])&&(t=n(t,e.types[a].typeIndex));return t}function N(e){for(var t=999,a=0;a<e.types.length;a++)v(e.types[a])||(t=n(t,e.types[a].conversionIndex));return t}function z(e,t){var n;return(n=e.restParam-t.restParam,0!==n)?n:(n=g(e)-g(t),0!==n)?n:(n=S(e)-S(t),0===n?N(e)-N(t):n)}function E(e,t){var a=n(e.params.length,t.params.length),r,o;if(o=e.params.some(g)-t.params.some(g),0!==o)return o;for(r=0;r<a;r++)if(o=g(e.params[r])-g(t.params[r]),0!==o)return o;for(r=0;r<a;r++)if(o=z(e.params[r],t.params[r]),0!==o)return o;return e.params.length-t.params.length}function C(e,t){var n={};return e.forEach(function(e){-1!==t.indexOf(e.from)||-1===t.indexOf(e.to)||n[e.from]||(n[e.from]=e)}),Object.keys(n).map(function(e){return n[e]})}function A(e,t){var n=t;if(e.some(g)){var a=u(e),r=e.map(I);n=function(){for(var e=[],n=a?arguments.length-1:arguments.length,o=0;o<n;o++)e[o]=r[o](arguments[o]);return a&&(e[n]=arguments[n].map(r[n])),t.apply(this,e)}}var o=n;if(u(e)){var s=e.length-1;o=function(){return n.apply(this,U(arguments,0,s).concat([U(arguments,s)]))}}return o}function I(e){var t=[],n=[],i,a,r,s;switch(e.types.forEach(function(e){e.conversion&&(t.push(o(e.conversion.from).test),n.push(e.conversion.convert))}),n.length){case 0:return function(e){return e};case 1:return i=t[0],r=n[0],function(e){return i(e)?r(e):e};case 2:return i=t[0],a=t[1],r=n[0],s=n[1],function(e){return i(e)?r(e):a(e)?s(e):e};default:return function(e){for(var a=0;a<n.length;a++)if(t[a](e))return n[a](e);return e};}}function k(e){var t={};return e.forEach(function(e){e.params.some(g)||D(e.params,!0).forEach(function(n){t[d(n)]=e.fn})}),t}function D(e,t){function n(e,i,a){if(i<e.length){var r=e[i],o=t?r.types.filter(v):r.types,s;if(r.restParam){var p=o.filter(v);s=p.length<o.length?[p,o]:[o]}else s=o.map(function(e){return[e]});return Y(s,function(t){return n(e,i+1,a.concat([t]))})}var l=a.map(function(t,n){return{types:t,restParam:n===e.length-1&&u(e)}});return[l]}return n(e,0,[])}function j(e,n){for(var a=t(e.params.length,n.params.length),r=0;r<a;r++){var o=_(e,r,!0),s=_(n,r,!0);if(!Z(o,s))return!1}var p=e.params.length,l=n.params.length,d=u(e.params),c=u(n.params);return d?c?p===l:l>=p:c?p>=l:p===l}function P(e,t){if(0===Object.keys(t).length)throw new SyntaxError("No signatures provided");var n=[];Object.keys(t).map(function(e){return m(e,t[e],$.conversions)}).filter(F).forEach(function(e){var t=H(n,function(t){return j(t,e)});if(t)throw new TypeError("Conflicting signatures \""+d(t.params)+"\" and \""+d(e.params)+"\".");n.push(e)});var r=Y(n,function(e){var t=e?D(e.params,!1):[];return t.map(function(t){return{params:t,fn:e.fn}})}).filter(F);r.sort(E);var o=r[0]&&2>=r[0].params.length&&!u(r[0].params),s=r[1]&&2>=r[1].params.length&&!u(r[1].params),p=r[2]&&2>=r[2].params.length&&!u(r[2].params),l=r[3]&&2>=r[3].params.length&&!u(r[3].params),c=r[4]&&2>=r[4].params.length&&!u(r[4].params),g=r[5]&&2>=r[5].params.length&&!u(r[5].params),x=r.map(function(e){return y(e.params)}),_=o?h(r[0].params[0]):i,f=s?h(r[1].params[0]):i,v=p?h(r[2].params[0]):i,b=l?h(r[3].params[0]):i,S=c?h(r[4].params[0]):i,N=g?h(r[5].params[0]):i,z=o?h(r[0].params[1]):i,C=s?h(r[1].params[1]):i,I=p?h(r[2].params[1]):i,P=l?h(r[3].params[1]):i,O=c?h(r[4].params[1]):i,w=g?h(r[5].params[1]):i,T=r.map(function(e){return A(e.params,e.fn)}),B=o?T[0]:a,L=s?T[1]:a,R=p?T[2]:a,U=l?T[3]:a,q=c?T[4]:a,Z=g?T[5]:a,V=o?r[0].params.length:-1,W=s?r[1].params.length:-1,X=p?r[2].params.length:-1,J=l?r[3].params.length:-1,G=c?r[4].params.length:-1,K=g?r[5].params.length:-1,Q=o&&s&&p&&l&&c&&g?6:0,ee=r.length,te=function(){for(var t=Q;t<ee;t++)if(x[t](arguments))return T[t].apply(this,arguments);throw M(e,arguments,r)},ne=function e(t,n){return arguments.length===V&&_(t)&&z(n)?B.apply(e,arguments):arguments.length===W&&f(t)&&C(n)?L.apply(e,arguments):arguments.length===X&&v(t)&&I(n)?R.apply(e,arguments):arguments.length===J&&b(t)&&P(n)?U.apply(e,arguments):arguments.length===G&&S(t)&&O(n)?q.apply(e,arguments):arguments.length===K&&N(t)&&w(n)?Z.apply(e,arguments):te.apply(e,arguments)};try{Object.defineProperty(ne,"name",{value:e})}catch(e){}return ne.signatures=k(r),ne}function O(e){return-1===$.ignore.indexOf(e)}function w(e){return e.trim()}function T(e){return!!e}function F(e){return null!==e}function B(e){return 0===e.types.length}function L(e){return e.slice(0,e.length-1)}function R(e){return e[e.length-1]}function U(e,t,n){return Array.prototype.slice.call(e,t,n)}function q(e,t){return-1!==e.indexOf(t)}function Z(e,t){for(var n=0;n<e.length;n++)if(q(t,e[n]))return!0;return!1}function H(e,t){for(var n=0;n<e.length;n++)if(t(e[n]))return e[n]}function V(e){for(var t={},n=0;n<e.length;n++)t[e[n]]=!0;return Object.keys(t)}function Y(e,t){return Array.prototype.concat.apply([],e.map(t))}function W(e){for(var t="",n=0,a;n<e.length;n++)if(a=e[n],("object"==typeof a.signatures||"string"==typeof a.signature)&&""!==a.name)if(""===t)t=a.name;else if(t!==a.name){var r=new Error("Function names do not match (expected: "+t+", actual: "+a.name+")");throw r.data={actual:a.name,expected:t},r}return t}function X(e){function t(e,t){if(n.hasOwnProperty(e)&&t!==n[e])throw r=new Error("Signature \""+e+"\" is defined twice"),r.data={signature:e},r}for(var n={},a=0,r,o;a<e.length;a++)if(o=e[a],"object"==typeof o.signatures)for(var s in o.signatures)o.signatures.hasOwnProperty(s)&&(t(s,o.signatures[s]),n[s]=o.signatures[s]);else if("string"==typeof o.signature)t(o.signature,o),n[o.signature]=o;else throw r=new TypeError("Function is no typed-function (index: "+a+")"),r.data={index:a},r;return n}var J=[{name:"number",test:function(e){return"number"==typeof e}},{name:"string",test:function(e){return"string"==typeof e}},{name:"boolean",test:function(e){return"boolean"==typeof e}},{name:"Function",test:function(e){return"function"==typeof e}},{name:"Array",test:Array.isArray},{name:"Date",test:function(e){return e instanceof Date}},{name:"RegExp",test:function(e){return e instanceof RegExp}},{name:"Object",test:function(e){return"object"==typeof e&&null!==e&&e.constructor===Object}},{name:"null",test:function(e){return null===e}},{name:"undefined",test:function(e){return void 0===e}}],G={name:"any",test:e},K=[],Q=[],$={types:J,conversions:Q,ignore:K};return $=P("typed",{"string, Object":P,Object:function(e){var t=[];for(var n in e)e.hasOwnProperty(n)&&t.push(e[n]);var i=W(t);return P(i,e)},"...Function":function(e){return P(W(e),X(e))},"string, ...Function":function(e,t){return P(e,X(t))}}),$.create=r,$.types=J,$.conversions=Q,$.ignore=K,$.convert=l,$.find=function(e,t){if(!e.signatures)throw new TypeError("Function is no typed-function");var n;if("string"==typeof t){n=t.split(",");for(var a=0;a<n.length;a++)n[a]=n[a].trim()}else if(Array.isArray(t))n=t;else throw new TypeError("String array or a comma separated string expected");var r=n.join(","),o=e.signatures[r];if(o)return o;throw new TypeError("Signature not found (signature: "+(e.name||"unnamed")+"("+n.join(", ")+"))")},$.addType=function(e,t){if(!e||"string"!=typeof e.name||"function"!=typeof e.test)throw new TypeError("Object with properties {name: string, test: function} expected");if(!1!==t)for(var n=0;n<$.types.length;n++)if("Object"===$.types[n].name)return void $.types.splice(n,0,e);$.types.push(e)},$.addConversion=function(e){if(!e||"string"!=typeof e.from||"string"!=typeof e.to||"function"!=typeof e.convert)throw new TypeError("Object with properties {from: string, to: string, convert: function} expected");$.conversions.push(e)},$}return r()})});function isInteger(e){return!("boolean"!=typeof e)||!!isFinite(e)&&e===Math.round(e)}function format(e,t){if("function"==typeof t)return t(e);if(e===1/0)return"Infinity";if(e===-Infinity)return"-Infinity";if(isNaN(e))return"NaN";var n="auto",i;switch(t&&(t.notation&&(n=t.notation),isNumber(t)?i=t:isNumber(t.precision)&&(i=t.precision)),n){case"fixed":return toFixed(e,i);case"exponential":return toExponential(e,i);case"engineering":return toEngineering(e,i);case"auto":return toPrecision(e,i,t&&t).replace(/((\.\d*?)(0+))($|e)/,function(){var t=arguments[2],n=arguments[4];return"."===t?n:t+n});default:throw new Error("Unknown notation \""+n+"\". Choose \"auto\", \"exponential\", or \"fixed\".");}}function splitNumber(e){var t=(e+"").toLowerCase().match(/^0*?(-?)(\d+\.?\d*)(e([+-]?\d+))?$/);if(!t)throw new SyntaxError("Invalid number "+e);var n=t[1],i=t[2],a=parseFloat(t[4]||"0"),r=i.indexOf(".");a+=-1===r?i.length-1:r-1;var o=i.replace(".","").replace(/^0*/,function(e){return a-=e.length,""}).replace(/0*$/,"").split("").map(function(e){return parseInt(e)});return 0===o.length&&(o.push(0),a++),{sign:n,coefficients:o,exponent:a}}function toEngineering(t,n){var a=Math.abs;if(isNaN(t)||!isFinite(t))return t+"";var r=splitNumber(t),o=roundDigits(r,n),s=o.exponent,e=o.coefficients,p=0==s%3?s:0>s?s-3-s%3:s-s%3;if(isNumber(n))for(;n>e.length||s-p+1>e.length;)e.push(0);else for(var l=a(s-p)-(e.length-1),d=0;d<l;d++)e.push(0);for(var c=a(s-p),m=1;0<c;)m++,c--;var u=e.slice(m).join(""),g=isNumber(n)&&u.length||u.match(/[1-9]/)?"."+u:"",h=e.slice(0,m).join("")+g+"e"+(0<=s?"+":"")+p.toString();return o.sign+h}function toFixed(e,t){if(isNaN(e)||!isFinite(e))return e+"";var n=splitNumber(e),i="number"==typeof t?roundDigits(n,n.exponent+1+t):n,a=i.coefficients,r=i.exponent+1,o=r+(t||0);return a.length<o&&(a=a.concat(zeros(o-a.length))),0>r&&(a=zeros(-r+1).concat(a),r=1),r<a.length&&a.splice(r,0,0===r?"0.":"."),i.sign+a.join("")}function toExponential(t,n){if(isNaN(t)||!isFinite(t))return t+"";var i=splitNumber(t),a=n?roundDigits(i,n):i,r=a.coefficients,o=a.exponent;r.length<n&&(r=r.concat(zeros(n-r.length)));var e=r.shift();return a.sign+e+(0<r.length?"."+r.join(""):"")+"e"+(0<=o?"+":"")+o}function toPrecision(t,n,i){if(isNaN(t)||!isFinite(t))return t+"";var a=i&&i.lowerExp!==void 0?i.lowerExp:-3,r=i&&i.upperExp!==void 0?i.upperExp:5,o=splitNumber(t),s=n?roundDigits(o,n):o;if(s.exponent<a||s.exponent>=r)return toExponential(t,n);var p=s.coefficients,l=s.exponent;p.length<n&&(p=p.concat(zeros(n-p.length))),p=p.concat(zeros(l-p.length+1+(p.length<n?n-p.length:0))),p=zeros(-l).concat(p);var e=0<l?l:0;return e<p.length-1&&p.splice(e+1,0,"."),s.sign+p.join("")}function roundDigits(e,t){for(var n={sign:e.sign,coefficients:e.coefficients,exponent:e.exponent},a=n.coefficients;0>=t;)a.unshift(0),n.exponent++,t++;if(a.length>t){var r=a.splice(t,a.length-t);if(5<=r[0]){var o=t-1;for(a[o]++;10===a[o];)a.pop(),0==o&&(a.unshift(0),n.exponent++,o++),o--,a[o]++}}return n}function zeros(e){for(var t=[],n=0;n<e;n++)t.push(0);return t}function digits(e){return e.toExponential().replace(/e.*$/,"").replace(/^0\.?0*|\./,"").length}var DBL_EPSILON=Number.EPSILON||2220446049250313e-31;function nearlyEqual(e,t,n){var i=Math.abs,a=Math.max;if(null===n||n===void 0)return e===t;if(e===t)return!0;if(isNaN(e)||isNaN(t))return!1;if(isFinite(e)&&isFinite(t)){var r=i(e-t);return!!(r<DBL_EPSILON)||r<=a(i(e),i(t))*n}return!1}function format$1(e,t){if("function"==typeof t)return t(e);if(!e.isFinite())return e.isNaN()?"NaN":e.gt(0)?"Infinity":"-Infinity";var n="auto",i;switch(void 0!==t&&(t.notation&&(n=t.notation),"number"==typeof t?i=t:t.precision&&(i=t.precision)),n){case"fixed":return toFixed$1(e,i);case"exponential":return toExponential$1(e,i);case"engineering":return toEngineering$1(e,i);case"auto":{var a=t&&void 0!==t.lowerExp?t.lowerExp:-3,r=t&&void 0!==t.upperExp?t.upperExp:5;if(e.isZero())return"0";var o=e.toSignificantDigits(i),s=o.e,p;return p=s>=a&&s<r?o.toFixed():toExponential$1(e,i),p.replace(/((\.\d*?)(0+))($|e)/,function(){var t=arguments[2],n=arguments[4];return"."===t?n:t+n})}default:throw new Error("Unknown notation \""+n+"\". Choose \"auto\", \"exponential\", or \"fixed\".");}}function toEngineering$1(t,n){var i=Math.pow,a=t.e,e=0==a%3?a:0>a?a-3-a%3:a-a%3,r=t.mul(i(10,-e)),o=r.toPrecision(n);return-1!==o.indexOf("e")&&(o=r.toString()),o+"e"+(0<=a?"+":"")+e.toString()}function toExponential$1(e,t){return void 0===t?e.toExponential():e.toExponential(t-1)}function toFixed$1(e,t){return e.toFixed(t)}function format$2(e,t){if("number"==typeof e)return format(e,t);if(isBigNumber(e))return format$1(e,t);if(looksLikeFraction(e))return t&&"decimal"===t.fraction?e.toString():e.s*e.n+"/"+e.d;if(Array.isArray(e))return formatArray(e,t);if(isString(e))return"\""+e+"\"";if("function"==typeof e)return e.syntax?e.syntax+"":"function";if(e&&"object"==typeof e){if("function"==typeof e.format)return e.format(t);if(e&&e.toString(t)!=={}.toString())return e.toString(t);var n=Object.keys(e).map(n=>"\""+n+"\": "+format$2(e[n],t));return"{"+n.join(", ")+"}"}return e+""}function formatArray(e,t){if(Array.isArray(e)){for(var n="[",a=e.length,r=0;r<a;r++)0!=r&&(n+=", "),n+=formatArray(e[r],t);return n+="]",n}return format$2(e,t)}function looksLikeFraction(e){return e&&"object"==typeof e&&"number"==typeof e.s&&"number"==typeof e.n&&"number"==typeof e.d||!1}function DimensionError(e,t,n){if(!(this instanceof DimensionError))throw new SyntaxError("Constructor must be called with the new operator");this.actual=e,this.expected=t,this.relation=n,this.message="Dimension mismatch ("+(Array.isArray(e)?"["+e.join(", ")+"]":e)+" "+(this.relation||"!=")+" "+(Array.isArray(t)?"["+t.join(", ")+"]":t)+")",this.stack=new Error().stack}DimensionError.prototype=new RangeError,DimensionError.prototype.constructor=RangeError,DimensionError.prototype.name="DimensionError",DimensionError.prototype.isDimensionError=!0;function IndexError(e,t,n){if(!(this instanceof IndexError))throw new SyntaxError("Constructor must be called with the new operator");this.index=e,3>arguments.length?(this.min=0,this.max=t):(this.min=t,this.max=n),this.message=void 0!==this.min&&this.index<this.min?"Index out of range ("+this.index+" < "+this.min+")":void 0!==this.max&&this.index>=this.max?"Index out of range ("+this.index+" > "+(this.max-1)+")":"Index out of range ("+this.index+")",this.stack=new Error().stack}IndexError.prototype=new RangeError,IndexError.prototype.constructor=RangeError,IndexError.prototype.name="IndexError",IndexError.prototype.isIndexError=!0;function arraySize(e){for(var t=[];Array.isArray(e);)t.push(e.length),e=e[0];return t}function _validate(e,t,n){var a=e.length,r;if(a!==t[n])throw new DimensionError(a,t[n]);if(n<t.length-1){for(r=0;r<a;r++){var o=e[r];if(!Array.isArray(o))throw new DimensionError(t.length-1,t.length,"<");_validate(e[r],t,n+1)}}else for(r=0;r<a;r++)if(Array.isArray(e[r]))throw new DimensionError(t.length+1,t.length,">")}function validate(e,t){var n=0===t.length;if(!n)_validate(e,t,0);else if(Array.isArray(e))throw new DimensionError(e.length,0)}function validateIndex(e,t){if(!isNumber(e)||!isInteger(e))throw new TypeError("Index must be an integer (value: "+e+")");if(0>e||"number"==typeof t&&e>=t)throw new IndexError(e,t)}function resize(e,t,n){if(!Array.isArray(e)||!Array.isArray(t))throw new TypeError("Array expected");if(0===t.length)throw new Error("Resizing to scalar is not supported");t.forEach(function(e){if(!isNumber(e)||!isInteger(e)||0>e)throw new TypeError("Invalid size, must contain positive integers (size: "+format$2(t)+")")});var i=void 0===n?0:n;return _resize(e,t,0,i),e}function _resize(e,t,n,a){var r=Math.min,o=e.length,s=t[n],p=r(o,s),l,d;if(e.length=s,n<t.length-1){var c=n+1;for(l=0;l<p;l++)d=e[l],Array.isArray(d)||(d=[d],e[l]=d),_resize(d,t,c,a);for(l=p;l<s;l++)d=[],e[l]=d,_resize(d,t,c,a)}else{for(l=0;l<p;l++)for(;Array.isArray(e[l]);)e[l]=e[l][0];for(l=p;l<s;l++)e[l]=a}}function reshape(t,n){function i(e){return e.reduce((e,t)=>e*t)}var a=flatten(t),r;if(!Array.isArray(t)||!Array.isArray(n))throw new TypeError("Array expected");if(0===n.length)throw new DimensionError(0,i(arraySize(t)),"!=");for(var o=1,s=0;s<n.length;s++)o*=n[s];if(a.length!==o)throw new DimensionError(i(n),i(arraySize(t)),"!=");try{r=_reshape(a,n)}catch(a){if(a instanceof DimensionError)throw new DimensionError(i(n),i(arraySize(t)),"!=");throw a}return r}function _reshape(e,t){for(var n=e,a=t.length-1,r,o;0<a;a--){o=t[a],r=[];for(var s=n.length/o,p=0;p<s;p++)r.push(n.slice(p*o,(p+1)*o));n=r}return n}function unsqueeze(e,t,n,a){var r=a||arraySize(e);if(n)for(var o=0;o<n;o++)e=[e],r.unshift(1);for(e=_unsqueeze(e,t,0);r.length<t;)r.push(1);return e}function _unsqueeze(e,t,n){var a,r;if(Array.isArray(e)){for(a=0,r=e.length;a<r;a++)e[a]=_unsqueeze(e[a],t,n+1)}else for(var o=n;o<t;o++)e=[e];return e}function flatten(e){if(!Array.isArray(e))return e;var t=[];return e.forEach(function e(n){Array.isArray(n)?n.forEach(e):t.push(n)}),t}function getArrayDataType(e,t){for(var n=0,a=0,r;a<e.length;a++){var o=e[a],s=Array.isArray(o);if(0==a&&s&&(n=o.length),s&&o.length!==n)return;var p=s?getArrayDataType(o,t):t(o);if(void 0===r)r=p;else if(r!==p)return"mixed"}return r}function factory(e,t,n,i){function a(i){var a=pickShallow(i,t.map(stripOptionalNotation));return assertDependencies(e,t,i),n(a)}return a.isFactory=!0,a.fn=e,a.dependencies=t.slice().sort(),i&&(a.meta=i),a}function assertDependencies(e,t,n){var i=t.filter(e=>!isOptionalDependency(e)).every(e=>n[e]!==void 0);if(!i){var a=t.filter(e=>n[e]===void 0);throw new Error("Cannot create function \"".concat(e,"\", ")+"some dependencies are missing: ".concat(a.map(e=>"\"".concat(e,"\"")).join(", "),"."))}}function isOptionalDependency(e){return e&&"?"===e[0]}function stripOptionalNotation(e){return e&&"?"===e[0]?e.slice(1):e}var _createTyped2=function(){return _createTyped2=typedFunction.create,typedFunction},dependencies=["?BigNumber","?Complex","?DenseMatrix","?Fraction"],createTyped=factory("typed",dependencies,function(e){var{BigNumber:t,Complex:n,DenseMatrix:i,Fraction:a}=e,r=_createTyped2();return r.types=[{name:"number",test:isNumber},{name:"Complex",test:isComplex},{name:"BigNumber",test:isBigNumber},{name:"Fraction",test:isFraction},{name:"Unit",test:isUnit},{name:"string",test:isString},{name:"Chain",test:isChain},{name:"Array",test:isArray},{name:"Matrix",test:isMatrix},{name:"DenseMatrix",test:isDenseMatrix},{name:"SparseMatrix",test:isSparseMatrix},{name:"Range",test:isRange},{name:"Index",test:isIndex},{name:"boolean",test:isBoolean},{name:"ResultSet",test:isResultSet},{name:"Help",test:isHelp},{name:"function",test:isFunction},{name:"Date",test:isDate},{name:"RegExp",test:isRegExp},{name:"null",test:isNull},{name:"undefined",test:isUndefined},{name:"AccessorNode",test:isAccessorNode},{name:"ArrayNode",test:isArrayNode},{name:"AssignmentNode",test:isAssignmentNode},{name:"BlockNode",test:isBlockNode},{name:"ConditionalNode",test:isConditionalNode},{name:"ConstantNode",test:isConstantNode},{name:"FunctionNode",test:isFunctionNode},{name:"FunctionAssignmentNode",test:isFunctionAssignmentNode},{name:"IndexNode",test:isIndexNode},{name:"Node",test:isNode},{name:"ObjectNode",test:isObjectNode},{name:"OperatorNode",test:isOperatorNode},{name:"ParenthesisNode",test:isParenthesisNode},{name:"RangeNode",test:isRangeNode},{name:"SymbolNode",test:isSymbolNode},{name:"Object",test:isObject}],r.conversions=[{from:"number",to:"BigNumber",convert:function(e){if(t||throwNoBignumber(e),15<digits(e))throw new TypeError("Cannot implicitly convert a number with >15 significant digits to BigNumber (value: "+e+"). Use function bignumber(x) to convert to BigNumber.");return new t(e)}},{from:"number",to:"Complex",convert:function(e){return n||throwNoComplex(e),new n(e,0)}},{from:"number",to:"string",convert:function(e){return e+""}},{from:"BigNumber",to:"Complex",convert:function(e){return n||throwNoComplex(e),new n(e.toNumber(),0)}},{from:"Fraction",to:"BigNumber",convert:function(){throw new TypeError("Cannot implicitly convert a Fraction to BigNumber or vice versa. Use function bignumber(x) to convert to BigNumber or fraction(x) to convert to Fraction.")}},{from:"Fraction",to:"Complex",convert:function(e){return n||throwNoComplex(e),new n(e.valueOf(),0)}},{from:"number",to:"Fraction",convert:function(e){a||throwNoFraction(e);var t=new a(e);if(t.valueOf()!==e)throw new TypeError("Cannot implicitly convert a number to a Fraction when there will be a loss of precision (value: "+e+"). Use function fraction(x) to convert to Fraction.");return t}},{from:"string",to:"number",convert:function(e){var t=+e;if(isNaN(t))throw new Error("Cannot convert \""+e+"\" to a number");return t}},{from:"string",to:"BigNumber",convert:function(e){t||throwNoBignumber(e);try{return new t(e)}catch(t){throw new Error("Cannot convert \""+e+"\" to BigNumber")}}},{from:"string",to:"Fraction",convert:function(e){a||throwNoFraction(e);try{return new a(e)}catch(t){throw new Error("Cannot convert \""+e+"\" to Fraction")}}},{from:"string",to:"Complex",convert:function(e){n||throwNoComplex(e);try{return new n(e)}catch(t){throw new Error("Cannot convert \""+e+"\" to Complex")}}},{from:"boolean",to:"number",convert:function(e){return+e}},{from:"boolean",to:"BigNumber",convert:function(e){return t||throwNoBignumber(e),new t(+e)}},{from:"boolean",to:"Fraction",convert:function(e){return a||throwNoFraction(e),new a(+e)}},{from:"boolean",to:"string",convert:function(e){return e+""}},{from:"Array",to:"Matrix",convert:function(e){return i||throwNoMatrix(),new i(e)}},{from:"Matrix",to:"Array",convert:function(e){return e.valueOf()}}],r});function throwNoBignumber(e){throw new Error("Cannot convert value ".concat(e," into a BigNumber: no class 'BigNumber' provided"))}function throwNoComplex(e){throw new Error("Cannot convert value ".concat(e," into a Complex number: no class 'Complex' provided"))}function throwNoMatrix(){throw new Error("Cannot convert array into a Matrix: no class 'DenseMatrix' provided")}function throwNoFraction(e){throw new Error("Cannot convert value ".concat(e," into a Fraction, no class 'Fraction' provided."))}var EXP_LIMIT=9e15,MAX_DIGITS=1e9,NUMERALS="0123456789abcdef",LN10="2.3025850929940456840179914546843642076011014886287729760333279009675726096773524802359972050895982983419677840422862486334095254650828067566662873690987816894829072083255546808437998948262331985283935053089653777326288461633662222876982198867465436674744042432743651550489343149393914796194044002221051017141748003688084012647080685567743216228355220114804663715659121373450747856947683463616792101806445070648000277502684916746550586856935673420670581136429224554405758925724208241314695689016758940256776311356919292033376587141660230105703089634572075440370847469940168269282808481184289314848524948644871927809676271275775397027668605952496716674183485704422507197965004714951050492214776567636938662976979522110718264549734772662425709429322582798502585509785265383207606726317164309505995087807523710333101197857547331541421808427543863591778117054309827482385045648019095610299291824318237525357709750539565187697510374970888692180205189339507238539205144634197265287286965110862571492198849978748873771345686209167058",PI="3.1415926535897932384626433832795028841971693993751058209749445923078164062862089986280348253421170679821480865132823066470938446095505822317253594081284811174502841027019385211055596446229489549303819644288109756659334461284756482337867831652712019091456485669234603486104543266482133936072602491412737245870066063155881748815209209628292540917153643678925903600113305305488204665213841469519415116094330572703657595919530921861173819326117931051185480744623799627495673518857527248912279381830119491298336733624406566430860213949463952247371907021798609437027705392171762931767523846748184676694051320005681271452635608277857713427577896091736371787214684409012249534301465495853710507922796892589235420199561121290219608640344181598136297747713099605187072113499999983729780499510597317328160963185950244594553469083026425223082533446850352619311881710100031378387528865875332083814206171776691473035982534904287554687311595628638823537875937519577818577805321712268066130019278766111959092164201989380952572010654858632789",DEFAULTS={precision:20,rounding:4,modulo:1,toExpNeg:-7,toExpPos:21,minE:-9000000000000000,maxE:9000000000000000,crypto:!1},external=!0,decimalError="[DecimalError] ",invalidArgument="[DecimalError] Invalid argument: ",precisionLimitExceeded="[DecimalError] Precision limit exceeded",cryptoUnavailable="[DecimalError] crypto unavailable",mathfloor=Math.floor,mathpow=Math.pow,isBinary=/^0b([01]+(\.[01]*)?|\.[01]+)(p[+-]?\d+)?$/i,isHex=/^0x([0-9a-f]+(\.[0-9a-f]*)?|\.[0-9a-f]+)(p[+-]?\d+)?$/i,isOctal=/^0o([0-7]+(\.[0-7]*)?|\.[0-7]+)(p[+-]?\d+)?$/i,isDecimal=/^(\d+(\.\d*)?|\.\d+)(e[+-]?\d+)?$/i,BASE=1e7,LOG_BASE=7,MAX_SAFE_INTEGER=9007199254740991,LN10_PRECISION=LN10.length-1,PI_PRECISION=PI.length-1,P={name:"[object Decimal]"},inexact,quadrant;P.absoluteValue=P.abs=function(){var e=new this.constructor(this);return 0>e.s&&(e.s=1),finalise(e)},P.ceil=function(){return finalise(new this.constructor(this),this.e+1,2)},P.comparedTo=P.cmp=function(e){var t=this,n=t.d,a=(e=new t.constructor(e)).d,r=t.s,o=e.s,s,p,l,d;if(!n||!a)return r&&o?r===o?n===a?0:!n^0>r?1:-1:r:NaN;if(!n[0]||!a[0])return n[0]?r:a[0]?-o:0;if(r!==o)return r;if(t.e!==e.e)return t.e>e.e^0>r?1:-1;for(l=n.length,d=a.length,(s=0,p=l<d?l:d);s<p;++s)if(n[s]!==a[s])return n[s]>a[s]^0>r?1:-1;return l===d?0:l>d^0>r?1:-1},P.cosine=P.cos=function(){var e=Math.max,t=this,n=t.constructor,i,a;return t.d?t.d[0]?(i=n.precision,a=n.rounding,n.precision=i+e(t.e,t.sd())+LOG_BASE,n.rounding=1,t=cosine(n,toLessThanHalfPi(n,t)),n.precision=i,n.rounding=a,finalise(2==quadrant||3==quadrant?t.neg():t,i,a,!0)):new n(1):new n(NaN)},P.cubeRoot=P.cbrt=function(){var i=Math.abs,a=this,o=a.constructor,p,l,d,c,u,g,h,y,x,_;if(!a.isFinite()||a.isZero())return new o(a);for(external=!1,g=a.s*mathpow(a.s*a,1/3),g&&i(g)!=1/0?c=new o(g.toString()):(d=digitsToString(a.d),p=a.e,(g=(p-d.length+1)%3)&&(d+=1==g||-2==g?"0":"00"),g=mathpow(d,1/3),p=mathfloor((p+1)/3)-(p%3==(0>p?-1:2)),g==1/0?d="5e"+p:(d=g.toExponential(),d=d.slice(0,d.indexOf("e")+1)+p),c=new o(d),c.s=a.s),h=(p=o.precision)+3;;)if(y=c,x=y.times(y).times(y),_=x.plus(a),c=divide(_.plus(a).times(y),_.plus(x),h+2,1),digitsToString(y.d).slice(0,h)===(d=digitsToString(c.d)).slice(0,h))if(d=d.slice(h-3,h+1),"9999"==d||!u&&"4999"==d){if(!u&&(finalise(y,p+1,0),y.times(y).times(y).eq(a))){c=y;break}h+=4,u=1}else{+d&&(+d.slice(1)||"5"!=d.charAt(0))||(finalise(c,p+1,1),l=!c.times(c).times(c).eq(a));break}return external=!0,finalise(c,p,o.rounding,l)},P.decimalPlaces=P.dp=function(){var e=this.d,t=NaN,i;if(e){if(i=e.length-1,t=(i-mathfloor(this.e/LOG_BASE))*LOG_BASE,i=e[i],i)for(;0==i%10;i/=10)t--;0>t&&(t=0)}return t},P.dividedBy=P.div=function(e){return divide(this,new this.constructor(e))},P.dividedToIntegerBy=P.divToInt=function(e){var t=this,n=t.constructor;return finalise(divide(t,new n(e),0,1,1),n.precision,n.rounding)},P.equals=P.eq=function(e){return 0===this.cmp(e)},P.floor=function(){return finalise(new this.constructor(this),this.e+1,3)},P.greaterThan=P.gt=function(e){return 0<this.cmp(e)},P.greaterThanOrEqualTo=P.gte=function(e){var t=this.cmp(e);return 1==t||0===t},P.hyperbolicCosine=P.cosh=function(){var e=this,t=e.constructor,a=new t(1),r,o,s,p,l;if(!e.isFinite())return new t(e.s?1/0:NaN);if(e.isZero())return a;s=t.precision,p=t.rounding,t.precision=s+Math.max(e.e,e.sd())+4,t.rounding=1,l=e.d.length,32>l?(r=Math.ceil(l/3),o=(1/tinyPow(4,r)).toString()):(r=16,o="2.3283064365386962890625e-10"),e=taylorSeries(t,1,e.times(o),new t(1),!0);for(var d=r,c=new t(8),m;d--;)m=e.times(e),e=a.minus(m.times(c.minus(m.times(c))));return finalise(e,t.precision=s,t.rounding=p,!0)},P.hyperbolicSine=P.sinh=function(){var e=Math.sqrt,t=Math.max,n=this,i=n.constructor,a,r,o,s;if(!n.isFinite()||n.isZero())return new i(n);if(r=i.precision,o=i.rounding,i.precision=r+t(n.e,n.sd())+4,i.rounding=1,s=n.d.length,3>s)n=taylorSeries(i,2,n,n,!0);else{a=1.4*e(s),a=16<a?16:0|a,n=n.times(1/tinyPow(5,a)),n=taylorSeries(i,2,n,n,!0);for(var p=new i(5),l=new i(16),d=new i(20),c;a--;)c=n.times(n),n=n.times(p.plus(c.times(l.times(c).plus(d))))}return i.precision=r,i.rounding=o,finalise(n,r,o,!0)},P.hyperbolicTangent=P.tanh=function(){var e=this,t=e.constructor,n,i;return e.isFinite()?e.isZero()?new t(e):(n=t.precision,i=t.rounding,t.precision=n+7,t.rounding=1,divide(e.sinh(),e.cosh(),t.precision=n,t.rounding=i)):new t(e.s)},P.inverseCosine=P.acos=function(){var e=this,t=e.constructor,n=e.abs().cmp(1),i=t.precision,a=t.rounding,r;return-1===n?e.isZero()?getPi(t,i+4,a).times(.5):(t.precision=i+6,t.rounding=1,e=e.asin(),r=getPi(t,i+4,a).times(.5),t.precision=i,t.rounding=a,r.minus(e)):0===n?e.isNeg()?getPi(t,i,a):new t(0):new t(NaN)},P.inverseHyperbolicCosine=P.acosh=function(){var e=Math.abs,t=Math.max,n=this,i=n.constructor,a,r;return n.lte(1)?new i(n.eq(1)?0:NaN):n.isFinite()?(a=i.precision,r=i.rounding,i.precision=a+t(e(n.e),n.sd())+4,i.rounding=1,external=!1,n=n.times(n).minus(1).sqrt().plus(n),external=!0,i.precision=a,i.rounding=r,n.ln()):new i(n)},P.inverseHyperbolicSine=P.asinh=function(){var e=Math.abs,t=Math.max,n=this,i=n.constructor,a,r;return!n.isFinite()||n.isZero()?new i(n):(a=i.precision,r=i.rounding,i.precision=a+2*t(e(n.e),n.sd())+6,i.rounding=1,external=!1,n=n.times(n).plus(1).sqrt().plus(n),external=!0,i.precision=a,i.rounding=r,n.ln())},P.inverseHyperbolicTangent=P.atanh=function(){var e=Math.max,t=this,n=t.constructor,i,a,r,o;return t.isFinite()?0<=t.e?new n(t.abs().eq(1)?t.s/0:t.isZero()?t:NaN):(i=n.precision,a=n.rounding,o=t.sd(),e(o,i)<2*-t.e-1)?finalise(new n(t),i,a,!0):(n.precision=r=o-t.e,t=divide(t.plus(1),new n(1).minus(t),r+i,1),n.precision=i+4,n.rounding=1,t=t.ln(),n.precision=i,n.rounding=a,t.times(.5)):new n(NaN)},P.inverseSine=P.asin=function(){var e=this,t=e.constructor,n,i,a,r;return e.isZero()?new t(e):(i=e.abs().cmp(1),a=t.precision,r=t.rounding,-1!==i)?0===i?(n=getPi(t,a+4,r).times(.5),n.s=e.s,n):new t(NaN):(t.precision=a+6,t.rounding=1,e=e.div(new t(1).minus(e.times(e)).sqrt().plus(1)).atan(),t.precision=a,t.rounding=r,e.times(2))},P.inverseTangent=P.atan=function(){var e=Math.ceil,a=Math.min,o=this,s=o.constructor,p=s.precision,l=s.rounding,d,c,m,u,g,h,y,_,f;if(!o.isFinite()){if(!o.s)return new s(NaN);if(p+4<=PI_PRECISION)return y=getPi(s,p+4,l).times(.5),y.s=o.s,y}else{if(o.isZero())return new s(o);if(o.abs().eq(1)&&p+4<=PI_PRECISION)return y=getPi(s,p+4,l).times(.25),y.s=o.s,y}for(s.precision=_=p+10,s.rounding=1,m=a(28,0|_/LOG_BASE+2),d=m;d;--d)o=o.div(o.times(o).plus(1).sqrt().plus(1));for(external=!1,c=e(_/LOG_BASE),u=1,f=o.times(o),y=new s(o),g=o;-1!==d;)if(g=g.times(f),h=y.minus(g.div(u+=2)),g=g.times(f),y=h.plus(g.div(u+=2)),void 0!==y.d[c])for(d=c;y.d[d]===h.d[d]&&d--;);return m&&(y=y.times(2<<m-1)),external=!0,finalise(y,s.precision=p,s.rounding=l,!0)},P.isFinite=function(){return!!this.d},P.isInteger=P.isInt=function(){return!!this.d&&mathfloor(this.e/LOG_BASE)>this.d.length-2},P.isNaN=function(){return!this.s},P.isNegative=P.isNeg=function(){return 0>this.s},P.isPositive=P.isPos=function(){return 0<this.s},P.isZero=function(){return!!this.d&&0===this.d[0]},P.lessThan=P.lt=function(e){return 0>this.cmp(e)},P.lessThanOrEqualTo=P.lte=function(e){return 1>this.cmp(e)},P.logarithm=P.log=function(e){var t=this,n=t.constructor,i=n.precision,a=n.rounding,o,s,p,l,c,m,u,g;if(null==e)e=new n(10),o=!0;else{if(e=new n(e),s=e.d,0>e.s||!s||!s[0]||e.eq(1))return new n(NaN);o=e.eq(10)}if(s=t.d,0>t.s||!s||!s[0]||t.eq(1))return new n(s&&!s[0]?-1/0:1==t.s?s?0:1/0:NaN);if(o)if(1<s.length)c=!0;else{for(l=s[0];0==l%10;)l/=10;c=1!==l}if(external=!1,u=i+5,m=naturalLogarithm(t,u),p=o?getLn10(n,u+10):naturalLogarithm(e,u),g=divide(m,p,u,1),checkRoundingDigits(g.d,l=i,a))do if(u+=10,m=naturalLogarithm(t,u),p=o?getLn10(n,u+10):naturalLogarithm(e,u),g=divide(m,p,u,1),!c){1e14==+digitsToString(g.d).slice(l+1,l+15)+1&&(g=finalise(g,i+1,0));break}while(checkRoundingDigits(g.d,l+=10,a));return external=!0,finalise(g,i,a)},P.minus=P.sub=function(t){var n=Math.ceil,a=Math.max,r=this,o=r.constructor,s,p,l,c,m,u,g,h,x,_,f,v;if(t=new o(t),!r.d||!t.d)return r.s&&t.s?r.d?t.s=-t.s:t=new o(t.d||r.s!==t.s?r:NaN):t=new o(NaN),t;if(r.s!=t.s)return t.s=-t.s,r.plus(t);if(x=r.d,v=t.d,g=o.precision,h=o.rounding,!x[0]||!v[0]){if(v[0])t.s=-t.s;else if(x[0])t=new o(r);else return new o(3===h?-0:0);return external?finalise(t,g,h):t}if(p=mathfloor(t.e/LOG_BASE),_=mathfloor(r.e/LOG_BASE),x=x.slice(),m=_-p,m){for(f=0>m,f?(s=x,m=-m,u=v.length):(s=v,p=_,u=x.length),l=a(n(g/LOG_BASE),u)+2,m>l&&(m=l,s.length=1),s.reverse(),l=m;l--;)s.push(0);s.reverse()}else{for(l=x.length,u=v.length,f=l<u,f&&(u=l),l=0;l<u;l++)if(x[l]!=v[l]){f=x[l]<v[l];break}m=0}for(f&&(s=x,x=v,v=s,t.s=-t.s),u=x.length,l=v.length-u;0<l;--l)x[u++]=0;for(l=v.length;l>m;){if(x[--l]<v[l]){for(c=l;c&&0===x[--c];)x[c]=9999999;--x[c],x[l]+=BASE}x[l]-=v[l]}for(;0===x[--u];)x.pop();for(;0===x[0];x.shift())--p;return x[0]?(t.d=x,t.e=getBase10Exponent(x,p),external?finalise(t,g,h):t):new o(3===h?-0:0)},P.modulo=P.mod=function(e){var t=this,n=t.constructor,i;return(e=new n(e),!t.d||!e.s||e.d&&!e.d[0])?new n(NaN):e.d&&(!t.d||t.d[0])?(external=!1,9==n.modulo?(i=divide(t,e.abs(),0,3,1),i.s*=e.s):i=divide(t,e,0,n.modulo,1),i=i.times(e),external=!0,t.minus(i)):finalise(new n(t),n.precision,n.rounding)},P.naturalExponential=P.exp=function(){return naturalExponential(this)},P.naturalLogarithm=P.ln=function(){return naturalLogarithm(this)},P.negated=P.neg=function(){var e=new this.constructor(this);return e.s=-e.s,finalise(e)},P.plus=P.add=function(t){var n=Math.ceil,a=this,r=a.constructor,o,s,p,l,c,m,u,g,h,x;if(t=new r(t),!a.d||!t.d)return a.s&&t.s?!a.d&&(t=new r(t.d||a.s===t.s?a:NaN)):t=new r(NaN),t;if(a.s!=t.s)return t.s=-t.s,a.minus(t);if(h=a.d,x=t.d,u=r.precision,g=r.rounding,!h[0]||!x[0])return x[0]||(t=new r(a)),external?finalise(t,u,g):t;if(c=mathfloor(a.e/LOG_BASE),p=mathfloor(t.e/LOG_BASE),h=h.slice(),l=c-p,l){for(0>l?(s=h,l=-l,m=x.length):(s=x,p=c,m=h.length),c=n(u/LOG_BASE),m=c>m?c+1:m+1,l>m&&(l=m,s.length=1),s.reverse();l--;)s.push(0);s.reverse()}for(m=h.length,l=x.length,0>m-l&&(l=m,s=x,x=h,h=s),o=0;l;)o=0|(h[--l]=h[l]+x[l]+o)/BASE,h[l]%=BASE;for(o&&(h.unshift(o),++p),m=h.length;0==h[--m];)h.pop();return t.d=h,t.e=getBase10Exponent(h,p),external?finalise(t,u,g):t},P.precision=P.sd=function(e){var t=this,n;if(void 0!==e&&e!==!!e&&1!==e&&0!==e)throw Error(invalidArgument+e);return t.d?(n=getPrecision(t.d),e&&t.e+1>n&&(n=t.e+1)):n=NaN,n},P.round=function(){var e=this,t=e.constructor;return finalise(new t(e),e.e+1,t.rounding)},P.sine=P.sin=function(){var e=Math.max,t=this,n=t.constructor,i,a;return t.isFinite()?t.isZero()?new n(t):(i=n.precision,a=n.rounding,n.precision=i+e(t.e,t.sd())+LOG_BASE,n.rounding=1,t=sine(n,toLessThanHalfPi(n,t)),n.precision=i,n.rounding=a,finalise(2<quadrant?t.neg():t,i,a,!0)):new n(NaN)},P.squareRoot=P.sqrt=function(){var i=Math.sqrt,a=this,o=a.d,p=a.e,l=a.s,d=a.constructor,c,u,g,h,y,x;if(1!==l||!o||!o[0])return new d(!l||0>l&&(!o||o[0])?NaN:o?a:1/0);for(external=!1,l=i(+a),0==l||l==1/0?(u=digitsToString(o),0==(u.length+p)%2&&(u+="0"),l=i(u),p=mathfloor((p+1)/2)-(0>p||p%2),l==1/0?u="5e"+p:(u=l.toExponential(),u=u.slice(0,u.indexOf("e")+1)+p),h=new d(u)):h=new d(l.toString()),g=(p=d.precision)+3;;)if(x=h,h=x.plus(divide(a,x,g+2,1)).times(.5),digitsToString(x.d).slice(0,g)===(u=digitsToString(h.d)).slice(0,g))if(u=u.slice(g-3,g+1),"9999"==u||!y&&"4999"==u){if(!y&&(finalise(x,p+1,0),x.times(x).eq(a))){h=x;break}g+=4,y=1}else{+u&&(+u.slice(1)||"5"!=u.charAt(0))||(finalise(h,p+1,1),c=!h.times(h).eq(a));break}return external=!0,finalise(h,p,d.rounding,c)},P.tangent=P.tan=function(){var e=this,t=e.constructor,n,i;return e.isFinite()?e.isZero()?new t(e):(n=t.precision,i=t.rounding,t.precision=n+10,t.rounding=1,e=e.sin(),e.s=1,e=divide(e,new t(1).minus(e.times(e)).sqrt(),n+10,0),t.precision=n,t.rounding=i,finalise(2==quadrant||4==quadrant?e.neg():e,n,i,!0)):new t(NaN)},P.times=P.mul=function(n){var a=this,o=a.constructor,s=a.d,p=(n=new o(n)).d,l,d,c,m,u,g,h,x,_;if(n.s*=a.s,!s||!s[0]||!p||!p[0])return new o(n.s&&(!s||s[0]||p)&&(!p||p[0]||s)?s&&p?0*n.s:n.s/0:NaN);for(d=mathfloor(a.e/LOG_BASE)+mathfloor(n.e/LOG_BASE),x=s.length,_=p.length,x<_&&(u=s,s=p,p=u,g=x,x=_,_=g),u=[],g=x+_,c=g;c--;)u.push(0);for(c=_;0<=--c;){for(l=0,m=x+c;m>c;)h=u[m]+p[c]*s[m-c-1]+l,u[m--]=0|h%BASE,l=0|h/BASE;u[m]=0|(u[m]+l)%BASE}for(;!u[--g];)u.pop();return l?++d:u.shift(),n.d=u,n.e=getBase10Exponent(u,d),external?finalise(n,o.precision,o.rounding):n},P.toBinary=function(e,t){return toStringBinary(this,2,e,t)},P.toDecimalPlaces=P.toDP=function(e,t){var n=this,i=n.constructor;return(n=new i(n),void 0===e)?n:(checkInt32(e,0,MAX_DIGITS),void 0===t?t=i.rounding:checkInt32(t,0,8),finalise(n,e+n.e+1,t))},P.toExponential=function(e,t){var n=this,i=n.constructor,a;return void 0===e?a=finiteToString(n,!0):(checkInt32(e,0,MAX_DIGITS),void 0===t?t=i.rounding:checkInt32(t,0,8),n=finalise(new i(n),e+1,t),a=finiteToString(n,!0,e+1)),n.isNeg()&&!n.isZero()?"-"+a:a},P.toFixed=function(e,t){var n=this,i=n.constructor,a,r;return void 0===e?a=finiteToString(n):(checkInt32(e,0,MAX_DIGITS),void 0===t?t=i.rounding:checkInt32(t,0,8),r=finalise(new i(n),e+n.e+1,t),a=finiteToString(r,!1,e+r.e+1)),n.isNeg()&&!n.isZero()?"-"+a:a},P.toFraction=function(t){var i=this,a=i.d,o=i.constructor,s,p,l,c,m,u,g,h,y,x,_,f;if(!a)return new o(i);if(y=p=new o(1),l=h=new o(0),s=new o(l),m=s.e=getPrecision(a)-i.e-1,u=m%LOG_BASE,s.d[0]=mathpow(10,0>u?LOG_BASE+u:u),null==t)t=0<m?s:y;else{if(g=new o(t),!g.isInt()||g.lt(y))throw Error(invalidArgument+g);t=g.gt(s)?0<m?s:y:g}for(external=!1,g=new o(digitsToString(a)),x=o.precision,o.precision=m=2*(a.length*LOG_BASE);;){if(_=divide(g,s,0,1,1),c=p.plus(_.times(l)),1==c.cmp(t))break;p=l,l=c,c=y,y=h.plus(_.times(c)),h=c,c=s,s=g.minus(_.times(c)),g=c}return c=divide(t.minus(p),l,0,1,1),h=h.plus(c.times(y)),p=p.plus(c.times(l)),h.s=y.s=i.s,f=1>divide(y,l,m,1).minus(i).abs().cmp(divide(h,p,m,1).minus(i).abs())?[y,l]:[h,p],o.precision=x,external=!0,f},P.toHexadecimal=P.toHex=function(e,t){return toStringBinary(this,16,e,t)},P.toNearest=function(e,t){var n=this,i=n.constructor;if(n=new i(n),null==e){if(!n.d)return n;e=new i(1),t=i.rounding}else{if(e=new i(e),void 0===t?t=i.rounding:checkInt32(t,0,8),!n.d)return e.s?n:e;if(!e.d)return e.s&&(e.s=n.s),e}return e.d[0]?(external=!1,n=divide(n,e,0,t,1).times(e),external=!0,finalise(n)):(e.s=n.s,n=e),n},P.toNumber=function(){return+this},P.toOctal=function(e,t){return toStringBinary(this,8,e,t)},P.toPower=P.pow=function(t){var n=Math.LN10,i=Math.log,a=Math.min,o=this,p=o.constructor,l=+(t=new p(t)),d,c,m,u,g,h;if(!o.d||!t.d||!o.d[0]||!t.d[0])return new p(mathpow(+o,l));if(o=new p(o),o.eq(1))return o;if(m=p.precision,g=p.rounding,t.eq(1))return finalise(o,m,g);if(d=mathfloor(t.e/LOG_BASE),d>=t.d.length-1&&(c=0>l?-l:l)<=MAX_SAFE_INTEGER)return u=intPow(p,o,c,m),0>t.s?new p(1).div(u):finalise(u,m,g);if(h=o.s,0>h){if(d<t.d.length-1)return new p(NaN);if(0==(1&t.d[d])&&(h=1),0==o.e&&1==o.d[0]&&1==o.d.length)return o.s=h,o}return(c=mathpow(+o,l),d=0!=c&&isFinite(c)?new p(c+"").e:mathfloor(l*(i("0."+digitsToString(o.d))/n+o.e+1)),d>p.maxE+1||d<p.minE-1)?new p(0<d?h/0:0):(external=!1,p.rounding=o.s=1,c=a(12,(d+"").length),u=naturalExponential(t.times(naturalLogarithm(o,m+c)),m),u.d&&(u=finalise(u,m+5,1),checkRoundingDigits(u.d,m,g)&&(d=m+10,u=finalise(naturalExponential(t.times(naturalLogarithm(o,d+c)),d),d+5,1),1e14==+digitsToString(u.d).slice(m+1,m+15)+1&&(u=finalise(u,m+1,0)))),u.s=h,external=!0,p.rounding=g,finalise(u,m,g))},P.toPrecision=function(e,t){var n=this,i=n.constructor,a;return void 0===e?a=finiteToString(n,n.e<=i.toExpNeg||n.e>=i.toExpPos):(checkInt32(e,1,MAX_DIGITS),void 0===t?t=i.rounding:checkInt32(t,0,8),n=finalise(new i(n),e,t),a=finiteToString(n,e<=n.e||n.e<=i.toExpNeg,e)),n.isNeg()&&!n.isZero()?"-"+a:a},P.toSignificantDigits=P.toSD=function(e,t){var n=this,i=n.constructor;return void 0===e?(e=i.precision,t=i.rounding):(checkInt32(e,1,MAX_DIGITS),void 0===t?t=i.rounding:checkInt32(t,0,8)),finalise(new i(n),e,t)},P.toString=function(){var e=this,t=e.constructor,n=finiteToString(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()&&!e.isZero()?"-"+n:n},P.truncated=P.trunc=function(){return finalise(new this.constructor(this),this.e+1,1)},P.valueOf=P.toJSON=function(){var e=this,t=e.constructor,n=finiteToString(e,e.e<=t.toExpNeg||e.e>=t.toExpPos);return e.isNeg()?"-"+n:n};function digitsToString(e){var t=e.length-1,n="",a=e[0],r,o,s;if(0<t){for(n+=a,r=1;r<t;r++)s=e[r]+"",o=LOG_BASE-s.length,o&&(n+=getZeroString(o)),n+=s;a=e[r],s=a+"",o=LOG_BASE-s.length,o&&(n+=getZeroString(o))}else if(0===a)return"0";for(;0==a%10;)a/=10;return n+a}function checkInt32(e,t,n){if(e!==~~e||e<t||e>n)throw Error(invalidArgument+e)}function checkRoundingDigits(e,t,n,a){var o=Math.ceil,s,p,l,d;for(p=e[0];10<=p;p/=10)--t;return 0>--t?(t+=LOG_BASE,s=0):(s=o((t+1)/LOG_BASE),t%=LOG_BASE),p=mathpow(10,LOG_BASE-t),d=0|e[s]%p,null==a?3>t?(0==t?d=0|d/100:1==t&&(d=0|d/10),l=4>n&&99999==d||3<n&&49999==d||5e4==d||0==d):l=(4>n&&d+1==p||3<n&&d+1==p/2)&&(0|e[s+1]/p/100)==mathpow(10,t-2)-1||(d==p/2||0==d)&&0==(0|e[s+1]/p/100):4>t?(0==t?d=0|d/1e3:1==t?d=0|d/100:2==t&&(d=0|d/10),l=(a||4>n)&&9999==d||!a&&3<n&&4999==d):l=((a||4>n)&&d+1==p||!a&&3<n&&d+1==p/2)&&(0|e[s+1]/p/1e3)==mathpow(10,t-3)-1,l}function convertBase(e,t,n){for(var a=[0],r=0,o=e.length,s,p;r<o;){for(p=a.length;p--;)a[p]*=t;for(a[0]+=NUMERALS.indexOf(e.charAt(r++)),s=0;s<a.length;s++)a[s]>n-1&&(void 0===a[s+1]&&(a[s+1]=0),a[s+1]+=0|a[s]/n,a[s]%=n)}return a.reverse()}function cosine(e,t){var n=Math.ceil,a=t.d.length,r,o;32>a?(r=n(a/3),o=(1/tinyPow(4,r)).toString()):(r=16,o="2.3283064365386962890625e-10"),e.precision+=r,t=taylorSeries(e,1,t.times(o),new e(1));for(var s=r,p;s--;)p=t.times(t),t=p.times(p).minus(p).times(8).plus(1);return e.precision-=r,t}var divide=function(){function e(e,t,n){var a=0,r=e.length,o;for(e=e.slice();r--;)o=e[r]*t+a,e[r]=0|o%n,a=0|o/n;return a&&e.unshift(a),e}function t(e,t,n,a){var o,s;if(n!=a)s=n>a?1:-1;else for(o=s=0;o<n;o++)if(e[o]!=t[o]){s=e[o]>t[o]?1:-1;break}return s}function n(e,t,n,a){for(var r=0;n--;)e[n]-=r,r=e[n]<t[n]?1:0,e[n]=r*a+e[n]-t[n];for(;!e[0]&&1<e.length;)e.shift()}return function(a,r,o,s,p,l){var d=a.constructor,c=a.s==r.s?1:-1,m=a.d,u=r.d,g,h,y,x,_,f,v,b,M,S,N,z,E,C,A,I,D,j,P,O;if(!m||!m[0]||!u||!u[0])return new d(a.s&&r.s&&(m?!(u&&m[0]==u[0]):!!u)?m&&0==m[0]||!u?0*c:c/0:NaN);for(l?(_=1,h=a.e-r.e):(l=BASE,_=LOG_BASE,h=mathfloor(a.e/_)-mathfloor(r.e/_)),P=u.length,D=m.length,M=new d(c),S=M.d=[],y=0;u[y]==(m[y]||0);y++);if(u[y]>(m[y]||0)&&h--,null==o?(C=o=d.precision,s=d.rounding):p?C=o+(a.e-r.e)+1:C=o,0>C)S.push(1),f=!0;else{if(C=0|C/_+2,y=0,1==P){for(x=0,u=u[0],C++;(y<D||x)&&C--;y++)A=x*l+(m[y]||0),S[y]=0|A/u,x=0|A%u;f=x||y<D}else{for(x=0|l/(u[0]+1),1<x&&(u=e(u,x,l),m=e(m,x,l),P=u.length,D=m.length),I=P,N=m.slice(0,P),z=N.length;z<P;)N[z++]=0;O=u.slice(),O.unshift(0),j=u[0],u[1]>=l/2&&++j;do x=0,g=t(u,N,P,z),0>g?(E=N[0],P!=z&&(E=E*l+(N[1]||0)),x=0|E/j,1<x?(x>=l&&(x=l-1),v=e(u,x,l),b=v.length,z=N.length,g=t(v,N,b,z),1==g&&(x--,n(v,P<b?O:u,b,l))):(0==x&&(g=x=1),v=u.slice()),b=v.length,b<z&&v.unshift(0),n(N,v,z,l),-1==g&&(z=N.length,g=t(u,N,P,z),1>g&&(x++,n(N,P<z?O:u,z,l))),z=N.length):0===g&&(x++,N=[0]),S[y++]=x,g&&N[0]?N[z++]=m[I]||0:(N=[m[I]],z=1);while((I++<D||void 0!==N[0])&&C--);f=void 0!==N[0]}S[0]||S.shift()}if(1==_)M.e=h,inexact=f;else{for(y=1,x=S[0];10<=x;x/=10)y++;M.e=y+h*_-1,finalise(M,p?o+M.e+1:o,s,f)}return M}}();function finalise(e,t,n,a){var r=Math.ceil,o=e.constructor,s,p,l,d,c,m,u,g,h;out:if(null!=t){if(g=e.d,!g)return e;for(s=1,d=g[0];10<=d;d/=10)s++;if(p=t-s,0>p)p+=LOG_BASE,l=t,u=g[h=0],c=0|u/mathpow(10,s-l-1)%10;else if(h=r((p+1)/LOG_BASE),d=g.length,!(h>=d)){for(u=d=g[h],s=1;10<=d;d/=10)s++;p%=LOG_BASE,l=p-LOG_BASE+s,c=0>l?0:0|u/mathpow(10,s-l-1)%10}else if(a){for(;d++<=h;)g.push(0);u=c=0,s=1,p%=LOG_BASE,l=p-LOG_BASE+1}else break out;if(a=a||0>t||void 0!==g[h+1]||(0>l?u:u%mathpow(10,s-l-1)),m=4>n?(c||a)&&(0==n||n==(0>e.s?3:2)):5<c||5==c&&(4==n||a||6==n&&1&(0<p?0<l?u/mathpow(10,s-l):0:g[h-1])%10||n==(0>e.s?8:7)),1>t||!g[0])return g.length=0,m?(t-=e.e+1,g[0]=mathpow(10,(LOG_BASE-t%LOG_BASE)%LOG_BASE),e.e=-t||0):g[0]=e.e=0,e;if(0==p?(g.length=h,d=1,h--):(g.length=h+1,d=mathpow(10,LOG_BASE-p),g[h]=0<l?(0|u/mathpow(10,s-l)%mathpow(10,l))*d:0),m)for(;;)if(0==h){for(p=1,l=g[0];10<=l;l/=10)p++;for(l=g[0]+=d,d=1;10<=l;l/=10)d++;p!=d&&(e.e++,g[0]==BASE&&(g[0]=1));break}else{if(g[h]+=d,g[h]!=BASE)break;g[h--]=0,d=1}for(p=g.length;0===g[--p];)g.pop()}return external&&(e.e>o.maxE?(e.d=null,e.e=NaN):e.e<o.minE&&(e.e=0,e.d=[0])),e}function finiteToString(t,n,i){if(!t.isFinite())return nonFiniteToString(t);var a=t.e,e=digitsToString(t.d),r=e.length,o;return n?(i&&0<(o=i-r)?e=e.charAt(0)+"."+e.slice(1)+getZeroString(o):1<r&&(e=e.charAt(0)+"."+e.slice(1)),e=e+(0>t.e?"e":"e+")+t.e):0>a?(e="0."+getZeroString(-a-1)+e,i&&0<(o=i-r)&&(e+=getZeroString(o))):a>=r?(e+=getZeroString(a+1-r),i&&0<(o=i-a-1)&&(e=e+"."+getZeroString(o))):((o=a+1)<r&&(e=e.slice(0,o)+"."+e.slice(o)),i&&0<(o=i-r)&&(a+1===r&&(e+="."),e+=getZeroString(o))),e}function getBase10Exponent(t,n){var i=t[0];for(n*=LOG_BASE;10<=i;i/=10)n++;return n}function getLn10(e,t,n){if(t>LN10_PRECISION)throw external=!0,n&&(e.precision=n),Error(precisionLimitExceeded);return finalise(new e(LN10),t,1,!0)}function getPi(e,t,n){if(t>PI_PRECISION)throw Error(precisionLimitExceeded);return finalise(new e(PI),t,n,!0)}function getPrecision(e){var t=e.length-1,n=t*LOG_BASE+1;if(t=e[t],t){for(;0==t%10;t/=10)n--;for(t=e[0];10<=t;t/=10)n++}return n}function getZeroString(e){for(var t="";e--;)t+="0";return t}function intPow(e,t,i,a){var o=Math.ceil,s=new e(1),p=o(a/LOG_BASE+4),l;for(external=!1;;){if(i%2&&(s=s.times(t),truncate(s.d,p)&&(l=!0)),i=mathfloor(i/2),0===i){i=s.d.length-1,l&&0===s.d[i]&&++s.d[i];break}t=t.times(t),truncate(t.d,p)}return external=!0,s}function isOdd(e){return 1&e.d[e.d.length-1]}function maxOrMin(e,t,n){for(var a=new e(t[0]),r=0,o;++r<t.length;)if(o=new e(t[r]),!o.s){a=o;break}else a[n](o)&&(a=o);return a}function naturalExponential(e,n){var a=Math.LN10,r=Math.log,o=0,s=0,p=0,l=e.constructor,d=l.rounding,c=l.precision,m,u,g,h,y,_,f;if(!e.d||!e.d[0]||17<e.e)return new l(e.d?e.d[0]?0>e.s?0:1/0:1:e.s?0>e.s?0:e:0/0);for(null==n?(external=!1,f=c):f=n,_=new l(.03125);-2<e.e;)e=e.times(_),p+=5;for(u=0|2*(r(mathpow(2,p))/a)+5,f+=u,m=h=y=new l(1),l.precision=f;;){if(h=finalise(h.times(e),f,1),m=m.times(++s),_=y.plus(divide(h,m,f,1)),digitsToString(_.d).slice(0,f)===digitsToString(y.d).slice(0,f)){for(g=p;g--;)y=finalise(y.times(y),f,1);if(null!=n)return l.precision=c,y;if(3>o&&checkRoundingDigits(y.d,f-u,d,o))l.precision=f+=10,m=h=_=new l(1),s=0,o++;else return finalise(y,l.precision=c,d,external=!0)}y=_}}function naturalLogarithm(i,a){var r=Math.abs,o=1,s=i,p=s.d,l=s.constructor,d=l.rounding,m=l.precision,u,g,h,y,_,f,v,b,M,S,N;if(0>s.s||!p||!p[0]||!s.e&&1==p[0]&&1==p.length)return new l(p&&!p[0]?-1/0:1==s.s?p?0:s:NaN);if(null==a?(external=!1,M=m):M=a,l.precision=M+=10,u=digitsToString(p),g=u.charAt(0),15e14>r(y=s.e)){for(;7>g&&1!=g||1==g&&3<u.charAt(1);)s=s.times(i),u=digitsToString(s.d),g=u.charAt(0),o++;y=s.e,1<g?(s=new l("0."+u),y++):s=new l(g+"."+u.slice(1))}else return b=getLn10(l,M+2,m).times(y+""),s=naturalLogarithm(new l(g+"."+u.slice(1)),M-10).plus(b),l.precision=m,null==a?finalise(s,m,d,external=!0):s;for(S=s,v=_=s=divide(s.minus(1),s.plus(1),M,1),N=finalise(s.times(s),M,1),h=3;;){if(_=finalise(_.times(N),M,1),b=v.plus(divide(_,new l(h),M,1)),digitsToString(b.d).slice(0,M)===digitsToString(v.d).slice(0,M)){if(v=v.times(2),0!==y&&(v=v.plus(getLn10(l,M+2,m).times(y+""))),v=divide(v,new l(o),M,1),null!=a)return l.precision=m,v;if(checkRoundingDigits(v.d,M-10,d,f))l.precision=M+=10,b=_=s=divide(S.minus(1),S.plus(1),M,1),N=finalise(s.times(s),M,1),h=f=1;else return finalise(v,l.precision=m,d,external=!0)}v=b,h+=2}}function nonFiniteToString(e){return e.s*e.s/0+""}function parseDecimal(t,n){var a,r,o;for(-1<(a=n.indexOf("."))&&(n=n.replace(".","")),0<(r=n.search(/e/i))?(0>a&&(a=r),a+=+n.slice(r+1),n=n.substring(0,r)):0>a&&(a=n.length),r=0;48===n.charCodeAt(r);r++);for(o=n.length;48===n.charCodeAt(o-1);--o);if(n=n.slice(r,o),n){if(o-=r,t.e=a=a-r-1,t.d=[],r=(a+1)%LOG_BASE,0>a&&(r+=LOG_BASE),r<o){for(r&&t.d.push(+n.slice(0,r)),o-=LOG_BASE;r<o;)t.d.push(+n.slice(r,r+=LOG_BASE));n=n.slice(r),r=LOG_BASE-n.length}else r-=o;for(;r--;)n+="0";t.d.push(+n),external&&(t.e>t.constructor.maxE?(t.d=null,t.e=NaN):t.e<t.constructor.minE&&(t.e=0,t.d=[0]))}else t.e=0,t.d=[0];return t}function parseOther(e,t){var n=Math.abs,a,r,o,s,l,d,c,m,u;if("Infinity"===t||"NaN"===t)return+t||(e.s=NaN),e.e=NaN,e.d=null,e;if(isHex.test(t))a=16,t=t.toLowerCase();else if(isBinary.test(t))a=2;else if(isOctal.test(t))a=8;else throw Error(invalidArgument+t);for(s=t.search(/p/i),0<s?(c=+t.slice(s+1),t=t.substring(2,s)):t=t.slice(2),s=t.indexOf("."),l=0<=s,r=e.constructor,l&&(t=t.replace(".",""),d=t.length,s=d-s,o=intPow(r,new r(a),s,2*s)),m=convertBase(t,a,BASE),u=m.length-1,s=u;0===m[s];--s)m.pop();return 0>s?new r(0*e.s):(e.e=getBase10Exponent(m,u),e.d=m,external=!1,l&&(e=divide(e,o,4*d)),c&&(e=e.times(54>n(c)?mathpow(2,c):Decimal.pow(2,c))),external=!0,e)}function sine(e,t){var n=t.d.length,i;if(3>n)return taylorSeries(e,2,t,t);i=1.4*Math.sqrt(n),i=16<i?16:0|i,t=t.times(1/tinyPow(5,i)),t=taylorSeries(e,2,t,t);for(var a=new e(5),r=new e(16),o=new e(20),s;i--;)s=t.times(t),t=t.times(a.plus(s.times(r.times(s).minus(o))));return t}function taylorSeries(e,i,a,r,o){var s=Math.ceil,p=e.precision,l=s(p/LOG_BASE),d,c,m,g;for(external=!1,g=a.times(a),m=new e(r);;){if(c=divide(m.times(g),new e(i++*i++),p,1),m=o?r.plus(c):r.minus(c),r=divide(c.times(g),new e(i++*i++),p,1),c=m.plus(r),void 0!==c.d[l]){for(d=l;c.d[d]===m.d[d]&&d--;);if(-1==d)break}d=m,m=r,r=c,c=d}return external=!0,c.d.length=l+1,c}function tinyPow(t,i){for(var a=t;--i;)a*=t;return a}function toLessThanHalfPi(e,n){var i=0>n.s,a=getPi(e,e.precision,1),r=a.times(.5),o;if(n=n.abs(),n.lte(r))return quadrant=i?4:1,n;if(o=n.divToInt(a),o.isZero())quadrant=i?3:2;else{if(n=n.minus(o.times(a)),n.lte(r))return quadrant=isOdd(o)?i?2:3:i?4:1,n;quadrant=isOdd(o)?i?1:4:i?3:2}return n.minus(a).abs()}function toStringBinary(t,n,a,r){var o=t.constructor,s=void 0!==a,p,l,d,c,m,u,g,h,_;if(s?(checkInt32(a,1,MAX_DIGITS),void 0===r?r=o.rounding:checkInt32(r,0,8)):(a=o.precision,r=o.rounding),!t.isFinite())g=nonFiniteToString(t);else{for(g=finiteToString(t),d=g.indexOf("."),s?(p=2,16==n?a=4*a-3:8==n&&(a=3*a-2)):p=n,0<=d&&(g=g.replace(".",""),_=new o(1),_.e=g.length-d,_.d=convertBase(finiteToString(_),10,p),_.e=_.d.length),h=convertBase(g,10,p),l=m=h.length;0==h[--m];)h.pop();if(!h[0])g=s?"0p+0":"0";else{if(0>d?l--:(t=new o(t),t.d=h,t.e=l,t=divide(t,_,a,r,0,p),h=t.d,l=t.e,u=inexact),d=h[a],c=p/2,u=u||void 0!==h[a+1],u=4>r?(void 0!==d||u)&&(0===r||r===(0>t.s?3:2)):d>c||d===c&&(4===r||u||6===r&&1&h[a-1]||r===(0>t.s?8:7)),h.length=a,u)for(;++h[--a]>p-1;)h[a]=0,a||(++l,h.unshift(1));for(m=h.length;!h[m-1];--m);for(d=0,g="";d<m;d++)g+=NUMERALS.charAt(h[d]);if(s){if(1<m)if(16==n||8==n){for(d=16==n?4:3,--m;m%d;m++)g+="0";for(h=convertBase(g,p,n),m=h.length;!h[m-1];--m);for(d=1,g="1.";d<m;d++)g+=NUMERALS.charAt(h[d])}else g=g.charAt(0)+"."+g.slice(1);g=g+(0>l?"p":"p+")+l}else if(0>l){for(;++l;)g="0"+g;g="0."+g}else if(++l>m)for(l-=m;l--;)g+="0";else l<m&&(g=g.slice(0,l)+"."+g.slice(l))}g=(16==n?"0x":2==n?"0b":8==n?"0o":"")+g}return 0>t.s?"-"+g:g}function truncate(e,t){if(e.length>t)return e.length=t,!0}function abs(e){return new this(e).abs()}function acos(e){return new this(e).acos()}function acosh(e){return new this(e).acosh()}function add(e,t){return new this(e).plus(t)}function asin(e){return new this(e).asin()}function asinh(e){return new this(e).asinh()}function atan(e){return new this(e).atan()}function atanh(e){return new this(e).atanh()}function atan2(e,t){e=new this(e),t=new this(t);var n=this.precision,i=this.rounding,a=n+4,o;return e.s&&t.s?e.d||t.d?!t.d||e.isZero()?(o=0>t.s?getPi(this,n,i):new this(0),o.s=e.s):!e.d||t.isZero()?(o=getPi(this,a,1).times(.5),o.s=e.s):0>t.s?(this.precision=a,this.rounding=1,o=this.atan(divide(e,t,a,1)),t=getPi(this,a,1),this.precision=n,this.rounding=i,o=0>e.s?o.minus(t):o.plus(t)):o=this.atan(divide(e,t,a,1)):(o=getPi(this,a,1).times(0<t.s?.25:.75),o.s=e.s):o=new this(NaN),o}function cbrt(e){return new this(e).cbrt()}function ceil(e){return finalise(e=new this(e),e.e+1,2)}function config$1(e){if(!e||"object"!=typeof e)throw Error("[DecimalError] Object expected");var t=!0===e.defaults,n=["precision",1,MAX_DIGITS,"rounding",0,8,"toExpNeg",-9000000000000000,0,"toExpPos",0,EXP_LIMIT,"maxE",0,EXP_LIMIT,"minE",-9000000000000000,0,"modulo",0,9],a,r,o;for(a=0;a<n.length;a+=3)if((r=n[a],t)&&(this[r]=DEFAULTS[r]),void 0!==(o=e[r]))if(mathfloor(o)===o&&o>=n[a+1]&&o<=n[a+2])this[r]=o;else throw Error(invalidArgument+r+": "+o);if((r="crypto",t)&&(this[r]=DEFAULTS[r]),void 0!==(o=e[r]))if(!0!==o&&!1!==o&&0!==o&&1!==o)throw Error(invalidArgument+r+": "+o);else if(!o)this[r]=!1;else if("undefined"!=typeof crypto&&crypto&&(crypto.getRandomValues||crypto.randomBytes))this[r]=!0;else throw Error(cryptoUnavailable);return this}function cos(e){return new this(e).cos()}function cosh(e){return new this(e).cosh()}function clone$1(e){function n(a){var r=this,o,s,p;if(!(r instanceof n))return new n(a);if(r.constructor=n,a instanceof n)return r.s=a.s,void(external?!a.d||a.e>n.maxE?(r.e=NaN,r.d=null):a.e<n.minE?(r.e=0,r.d=[0]):(r.e=a.e,r.d=a.d.slice()):(r.e=a.e,r.d=a.d?a.d.slice():a.d));if(p=typeof a,"number"===p){if(0===a)return r.s=0>1/a?-1:1,r.e=0,void(r.d=[0]);if(0>a?(a=-a,r.s=-1):r.s=1,a===~~a&&1e7>a){for(o=0,s=a;10<=s;s/=10)o++;return void(external?o>n.maxE?(r.e=NaN,r.d=null):o<n.minE?(r.e=0,r.d=[0]):(r.e=o,r.d=[a]):(r.e=o,r.d=[a]))}return 0==0*a?parseDecimal(r,a.toString()):(a||(r.s=NaN),r.e=NaN,void(r.d=null))}if("string"!==p)throw Error(invalidArgument+a);return 45===(s=a.charCodeAt(0))?(a=a.slice(1),r.s=-1):(43===s&&(a=a.slice(1)),r.s=1),isDecimal.test(a)?parseDecimal(r,a):parseOther(r,a)}var a,t,r;if(n.prototype=P,n.ROUND_UP=0,n.ROUND_DOWN=1,n.ROUND_CEIL=2,n.ROUND_FLOOR=3,n.ROUND_HALF_UP=4,n.ROUND_HALF_DOWN=5,n.ROUND_HALF_EVEN=6,n.ROUND_HALF_CEIL=7,n.ROUND_HALF_FLOOR=8,n.EUCLID=9,n.config=n.set=config$1,n.clone=clone$1,n.isDecimal=isDecimalInstance,n.abs=abs,n.acos=acos,n.acosh=acosh,n.add=add,n.asin=asin,n.asinh=asinh,n.atan=atan,n.atanh=atanh,n.atan2=atan2,n.cbrt=cbrt,n.ceil=ceil,n.cos=cos,n.cosh=cosh,n.div=div,n.exp=exp,n.floor=floor,n.hypot=hypot,n.ln=ln,n.log=log,n.log10=log10,n.log2=log2,n.max=max,n.min=min,n.mod=mod,n.mul=mul,n.pow=pow,n.random=random,n.round=round,n.sign=sign,n.sin=sin,n.sinh=sinh,n.sqrt=sqrt,n.sub=sub,n.tan=tan,n.tanh=tanh,n.trunc=trunc,void 0===e&&(e={}),e&&!0!==e.defaults)for(r=["precision","rounding","toExpNeg","toExpPos","maxE","minE","modulo","crypto"],a=0;a<r.length;)e.hasOwnProperty(t=r[a++])||(e[t]=this[t]);return n.config(e),n}function div(e,t){return new this(e).div(t)}function exp(e){return new this(e).exp()}function floor(e){return finalise(e=new this(e),e.e+1,3)}function hypot(){var e=new this(0),a,r;for(external=!1,a=0;a<arguments.length;)if(r=new this(arguments[a++]),!r.d){if(r.s)return external=!0,new this(1/0);e=r}else e.d&&(e=e.plus(r.times(r)));return external=!0,e.sqrt()}function isDecimalInstance(e){return e instanceof Decimal||e&&"[object Decimal]"===e.name||!1}function ln(e){return new this(e).ln()}function log(e,t){return new this(e).log(t)}function log2(e){return new this(e).log(2)}function log10(e){return new this(e).log(10)}function max(){return maxOrMin(this,arguments,"lt")}function min(){return maxOrMin(this,arguments,"gt")}function mod(e,t){return new this(e).mod(t)}function mul(e,t){return new this(e).mul(t)}function pow(e,t){return new this(e).pow(t)}function random(t){var a=Math.ceil,o=0,s=new this(1),r=[],p,l,c,m;if(void 0===t?t=this.precision:checkInt32(t,1,MAX_DIGITS),c=a(t/LOG_BASE),!this.crypto)for(;o<c;)r[o++]=0|1e7*Math.random();else if(crypto.getRandomValues)for(p=crypto.getRandomValues(new Uint32Array(c));o<c;)m=p[o],429e7<=m?p[o]=crypto.getRandomValues(new Uint32Array(1))[0]:r[o++]=m%1e7;else if(crypto.randomBytes){for(p=crypto.randomBytes(c*=4);o<c;)m=p[o]+(p[o+1]<<8)+(p[o+2]<<16)+((127&p[o+3])<<24),214e7<=m?crypto.randomBytes(4).copy(p,o):(r.push(m%1e7),o+=4);o=c/4}else throw Error(cryptoUnavailable);for(c=r[--o],t%=LOG_BASE,c&&t&&(m=mathpow(10,LOG_BASE-t),r[o]=(0|c/m)*m);0===r[o];o--)r.pop();if(0>o)l=0,r=[0];else{for(l=-1;0===r[0];l-=LOG_BASE)r.shift();for(c=1,m=r[0];10<=m;m/=10)c++;c<LOG_BASE&&(l-=LOG_BASE-c)}return s.e=l,s.d=r,s}function round(e){return finalise(e=new this(e),e.e+1,this.rounding)}function sign(e){return e=new this(e),e.d?e.d[0]?e.s:0*e.s:e.s||NaN}function sin(e){return new this(e).sin()}function sinh(e){return new this(e).sinh()}function sqrt(e){return new this(e).sqrt()}function sub(e,t){return new this(e).sub(t)}function tan(e){return new this(e).tan()}function tanh(e){return new this(e).tanh()}function trunc(e){return finalise(e=new this(e),e.e+1,1)}P[Symbol.for("nodejs.util.inspect.custom")]=P.toString,P[Symbol.toStringTag]="Decimal";var Decimal=clone$1(DEFAULTS);LN10=new Decimal(LN10),PI=new Decimal(PI);var name="BigNumber",dependencies$1=["?on","config"],createBigNumberClass=factory("BigNumber",dependencies$1,e=>{var{on:t,config:n}=e,i=Decimal.clone({precision:n.precision,modulo:9});return i.prototype.type="BigNumber",i.prototype.isBigNumber=!0,i.prototype.toJSON=function(){return{mathjs:"BigNumber",value:this.toString()}},i.fromJSON=function(e){return new i(e.value)},t&&t("config",function(e,t){e.precision!==t.precision&&i.config({precision:e.precision})}),i},{isClass:!0}),complex=createCommonjsModule(function(e,t){var n=Math.floor,i=Math.PI,r=Math.log,o=Math.sqrt,s=Math.ceil,p=Math.pow,l=Math.abs,d=Math.round;(function(){var u=Math.sin,g=Math.exp,h=Math.cos,y=Math.atan2;function c(e,t){var n=l(e),i=l(t);return 0===e?r(i):0===t?r(n):3e3>n&&3e3>i?.5*r(e*e+t*t):r(e/h(y(t,e)))}function m(e,t){if(!(this instanceof m))return new m(e,t);var n=M(e,t);this.re=n.re,this.im=n.im}var x=function(e){return .5*(g(e)+g(-e))},_=function(e){return .5*(g(e)-g(-e))},f=function(e){var t=i/4;if(e<-t||e>t)return h(e)-1;var n=e*e;return n*(-.5+n*(1/24+n*(-1/720+n*(1/40320+n*(-1/3628800+n*(1/4790014600+n*(-1/87178291200+n*(1/20922789888e3))))))))},v=function(e,t){var n=l(e),i=l(t);return 3e3>n&&3e3>i?o(n*n+i*i):(n<i?(n=i,i=e/t):i=t/e,n*o(1+i*i))},b=function(){throw SyntaxError("Invalid Param")},M=function(e,t){var n=Number.isFinite,a={re:0,im:0};if(e===void 0||null===e)a.re=a.im=0;else if(t!==void 0)a.re=e,a.im=t;else switch(typeof e){case"object":if("im"in e&&"re"in e)a.re=e.re,a.im=e.im;else if("abs"in e&&"arg"in e){if(!n(e.abs)&&n(e.arg))return m.INFINITY;a.re=e.abs*h(e.arg),a.im=e.abs*u(e.arg)}else if("r"in e&&"phi"in e){if(!n(e.r)&&n(e.phi))return m.INFINITY;a.re=e.r*h(e.phi),a.im=e.r*u(e.phi)}else 2===e.length?(a.re=e[0],a.im=e[1]):b();break;case"string":a.im=a.re=0;var r=e.match(/\d+\.?\d*e[+-]?\d+|\d+\.?\d*|\.\d+|./g),o=1,s=0;null===r&&b();for(var p=0,l;p<r.length;p++)if(l=r[p]," "===l||"\t"===l||"\n"===l);else"+"===l?o++:"-"===l?s++:"i"===l||"I"===l?(0===o+s&&b()," "===r[p+1]||isNaN(r[p+1])?a.im+=parseFloat((s%2?"-":"")+"1"):(a.im+=parseFloat((s%2?"-":"")+r[p+1]),p++),o=s=0):((0===o+s||isNaN(l))&&b(),"i"===r[p+1]||"I"===r[p+1]?(a.im+=parseFloat((s%2?"-":"")+l),p++):a.re+=parseFloat((s%2?"-":"")+l),o=s=0);0<o+s&&b();break;case"number":a.im=0,a.re=e;break;default:b();}return a};m.prototype={re:0,im:0,sign:function(){var e=this.abs();return new m(this.re/e,this.im/e)},add:function(e,t){var n=new m(e,t);return this.isInfinite()&&n.isInfinite()?m.NAN:this.isInfinite()||n.isInfinite()?m.INFINITY:new m(this.re+n.re,this.im+n.im)},sub:function(e,t){var n=new m(e,t);return this.isInfinite()&&n.isInfinite()?m.NAN:this.isInfinite()||n.isInfinite()?m.INFINITY:new m(this.re-n.re,this.im-n.im)},mul:function(e,t){var n=new m(e,t);return this.isInfinite()&&n.isZero()||this.isZero()&&n.isInfinite()?m.NAN:this.isInfinite()||n.isInfinite()?m.INFINITY:0===n.im&&0===this.im?new m(this.re*n.re,0):new m(this.re*n.re-this.im*n.im,this.re*n.im+this.im*n.re)},div:function(e,n){var i=new m(e,n);if(this.isZero()&&i.isZero()||this.isInfinite()&&i.isInfinite())return m.NAN;if(this.isInfinite()||i.isZero())return m.INFINITY;if(this.isZero()||i.isInfinite())return m.ZERO;e=this.re,n=this.im;var r=i.re,o=i.im,s,p;return 0===o?new m(e/r,n/r):l(r)<l(o)?(p=r/o,s=r*p+o,new m((e*p+n)/s,(n*p-e)/s)):(p=o/r,s=o*p+r,new m((e+n*p)/s,(n-e*p)/s))},pow:function(e,t){var n=new m(e,t);if(e=this.re,t=this.im,n.isZero())return m.ONE;if(0===n.im){if(0===t&&0<=e)return new m(p(e,n.re),0);if(0===e)switch((n.re%4+4)%4){case 0:return new m(p(t,n.re),0);case 1:return new m(0,p(t,n.re));case 2:return new m(-p(t,n.re),0);case 3:return new m(0,-p(t,n.re));}}if(0===e&&0===t&&0<n.re&&0<=n.im)return m.ZERO;var i=y(t,e),r=c(e,t);return e=g(n.re*r-n.im*i),t=n.im*r+n.re*i,new m(e*h(t),e*u(t))},sqrt:function(){var e=this.re,t=this.im,n=this.abs(),i,a;if(0<=e){if(0===t)return new m(o(e),0);i=.5*o(2*(n+e))}else i=l(t)/o(2*(n-e));return a=0>=e?.5*o(2*(n-e)):l(t)/o(2*(n+e)),new m(i,0>t?-a:a)},exp:function(){var e=g(this.re);if(0===this.im);return new m(e*h(this.im),e*u(this.im))},expm1:function(){var e=Math.expm1,t=this.re,n=this.im;return new m(e(t)*h(n)+f(n),g(t)*u(n))},log:function(){var e=this.re,t=this.im;return new m(c(e,t),y(t,e))},abs:function(){return v(this.re,this.im)},arg:function(){return y(this.im,this.re)},sin:function(){var e=this.re,t=this.im;return new m(u(e)*x(t),h(e)*_(t))},cos:function(){var e=this.re,t=this.im;return new m(h(e)*x(t),-u(e)*_(t))},tan:function(){var e=2*this.re,t=2*this.im,n=h(e)+x(t);return new m(u(e)/n,_(t)/n)},cot:function(){var e=2*this.re,t=2*this.im,n=h(e)-x(t);return new m(-u(e)/n,_(t)/n)},sec:function(){var e=this.re,t=this.im,n=.5*x(2*t)+.5*h(2*e);return new m(h(e)*x(t)/n,u(e)*_(t)/n)},csc:function(){var e=this.re,t=this.im,n=.5*x(2*t)-.5*h(2*e);return new m(u(e)*x(t)/n,-h(e)*_(t)/n)},asin:function(){var e=this.re,t=this.im,n=new m(t*t-e*e+1,-2*e*t).sqrt(),i=new m(n.re-t,n.im+e).log();return new m(i.im,-i.re)},acos:function(){var e=this.re,t=this.im,n=new m(t*t-e*e+1,-2*e*t).sqrt(),a=new m(n.re-t,n.im+e).log();return new m(i/2-a.im,a.re)},atan:function(){var e=this.re,t=this.im;if(0===e){if(1===t)return new m(0,1/0);if(-1===t)return new m(0,-Infinity)}var n=e*e+(1-t)*(1-t),i=new m((1-t*t-e*e)/n,-2*e/n).log();return new m(-.5*i.im,.5*i.re)},acot:function(){var e=this.re,t=this.im;if(0===t)return new m(y(1,e),0);var n=e*e+t*t;return 0==n?new m(0===e?0:e/0,0===t?0:-t/0).atan():new m(e/n,-t/n).atan()},asec:function(){var e=this.re,t=this.im;if(0===e&&0===t)return new m(0,1/0);var n=e*e+t*t;return 0==n?new m(0===e?0:e/0,0===t?0:-t/0).acos():new m(e/n,-t/n).acos()},acsc:function(){var e=this.re,t=this.im;if(0===e&&0===t)return new m(i/2,1/0);var n=e*e+t*t;return 0==n?new m(0===e?0:e/0,0===t?0:-t/0).asin():new m(e/n,-t/n).asin()},sinh:function(){var e=this.re,t=this.im;return new m(_(e)*h(t),x(e)*u(t))},cosh:function(){var e=this.re,t=this.im;return new m(x(e)*h(t),_(e)*u(t))},tanh:function(){var e=2*this.re,t=2*this.im,n=x(e)+h(t);return new m(_(e)/n,u(t)/n)},coth:function(){var e=2*this.re,t=2*this.im,n=x(e)-h(t);return new m(_(e)/n,-u(t)/n)},csch:function(){var e=this.re,t=this.im,n=h(2*t)-x(2*e);return new m(-2*_(e)*h(t)/n,2*x(e)*u(t)/n)},sech:function(){var e=this.re,t=this.im,n=h(2*t)+x(2*e);return new m(2*x(e)*h(t)/n,-2*_(e)*u(t)/n)},asinh:function(){var e=this.im;this.im=-this.re,this.re=e;var t=this.asin();return this.re=-this.im,this.im=e,e=t.re,t.re=-t.im,t.im=e,t},acosh:function(){var e=this.acos();if(0>=e.im){var t=e.re;e.re=-e.im,e.im=t}else{var t=e.im;e.im=-e.re,e.re=t}return e},atanh:function(){var e=this.re,t=this.im,n=1-e,i=1+e,a=n*n+t*t,r=0===a?new m(-1===e?0:e/0,0===t?0:t/0):new m((i*n-t*t)/a,(t*n+i*t)/a),o=r.re;return r.re=c(r.re,r.im)/2,r.im=y(r.im,o)/2,1<e&&0===t&&(r.im=-r.im),r},acoth:function(){var e=this.re,t=this.im;if(0===e&&0===t)return new m(0,i/2);var n=e*e+t*t;return 0==n?new m(0===e?0:e/0,0===t?0:-t/0).atanh():new m(e/n,-t/n).atanh()},acsch:function(){var e=this.re,t=this.im;if(0===t)return new m(0===e?1/0:r(e+o(e*e+1)),0);var n=e*e+t*t;return 0==n?new m(0===e?0:e/0,0===t?0:-t/0).asinh():new m(e/n,-t/n).asinh()},asech:function(){var e=this.re,t=this.im;if(this.isZero())return m.INFINITY;var n=e*e+t*t;return 0==n?new m(0===e?0:e/0,0===t?0:-t/0).acosh():new m(e/n,-t/n).acosh()},inverse:function(){if(this.isZero())return m.INFINITY;if(this.isInfinite())return m.ZERO;var e=this.re,t=this.im,n=e*e+t*t;return new m(e/n,-t/n)},conjugate:function(){return new m(this.re,-this.im)},neg:function(){return new m(-this.re,-this.im)},ceil:function(e){return e=p(10,e||0),new m(s(this.re*e)/e,s(this.im*e)/e)},floor:function(e){return e=p(10,e||0),new m(n(this.re*e)/e,n(this.im*e)/e)},round:function(e){return e=p(10,e||0),new m(d(this.re*e)/e,d(this.im*e)/e)},equals:function(e,t){var n=new m(e,t);return l(n.re-this.re)<=m.EPSILON&&l(n.im-this.im)<=m.EPSILON},clone:function(){return new m(this.re,this.im)},toString:function(){var e=this.re,t=this.im,n="";return this.isNaN()?"NaN":this.isZero()?"0":this.isInfinite()?"Infinity":(0!==e&&(n+=e),0!==t&&(0===e?0>t&&(n+="-"):n+=0>t?" - ":" + ",t=l(t),1!==t&&(n+=t),n+="i"),n?n:"0")},toVector:function(){return[this.re,this.im]},valueOf:function(){return 0===this.im?this.re:null},isNaN:function(){return isNaN(this.re)||isNaN(this.im)},isZero:function(){return(0===this.re||-0===this.re)&&(0===this.im||-0===this.im)},isFinite:function(){return isFinite(this.re)&&isFinite(this.im)},isInfinite:function(){return!(this.isNaN()||this.isFinite())}},m.ZERO=new m(0,0),m.ONE=new m(1,0),m.I=new m(0,1),m.PI=new m(i,0),m.E=new m(Math.E,0),m.INFINITY=new m(1/0,1/0),m.NAN=new m(NaN,NaN),m.EPSILON=1e-16,Object.defineProperty(t,"__esModule",{value:!0}),m["default"]=m,m.Complex=m,e.exports=m})()}),Complex=unwrapExports(complex),name$1="Complex",dependencies$2=[],createComplexClass=factory(name$1,dependencies$2,()=>(Complex.prototype.type="Complex",Complex.prototype.isComplex=!0,Complex.prototype.toJSON=function(){return{mathjs:"Complex",re:this.re,im:this.im}},Complex.prototype.toPolar=function(){return{r:this.abs(),phi:this.arg()}},Complex.prototype.format=function(e){var t=Math.pow,n=Math.abs,i="",a=this.im,r=this.re,o=format(this.re,e),s=format(this.im,e),p=isNumber(e)?e:e?e.precision:null;if(null!==p){var l=t(10,-p);n(r/a)<l&&(r=0),n(a/r)<l&&(a=0)}return i=0===a?o:0===r?1===a?"i":-1===a?"-i":s+"i":0>a?-1===a?o+" - i":o+" - "+s.substring(1)+"i":1===a?o+" + i":o+" + "+s+"i",i},Complex.fromPolar=function(){switch(arguments.length){case 1:{var e=arguments[0];if("object"==typeof e)return Complex(e);throw new TypeError("Input has to be an object with r and phi keys.")}case 2:{var t=arguments[0],n=arguments[1];if(isNumber(t)){if(isUnit(n)&&n.hasBase("ANGLE")&&(n=n.toNumber("rad")),isNumber(n))return new Complex({r:t,phi:n});throw new TypeError("Phi is not a number nor an angle unit.")}else throw new TypeError("Radius r is not a number.")}default:throw new SyntaxError("Wrong number of arguments in function fromPolar");}},Complex.prototype.valueOf=Complex.prototype.toString,Complex.fromJSON=function(e){return new Complex(e)},Complex.compare=function(e,t){return e.re>t.re?1:e.re<t.re?-1:e.im>t.im?1:e.im<t.im?-1:0},Complex),{isClass:!0}),fraction=createCommonjsModule(function(e){var i=Math.floor,a=Math.LN10,r=Math.log,o=Math.ceil,p=Math.pow,l=Math.abs,d=Math.round;(function(){function t(e){function t(){var t=Error.apply(this,arguments);t.name=this.name=e,this.stack=t.stack,this.message=t.message}function n(){}return n.prototype=Error.prototype,t.prototype=new n,t}function c(e,t){return isNaN(e=parseInt(e,10))&&m(),e*t}function m(){throw new v}function u(t,n,i){for(var a=1;0<n;t=t*t%i,n>>=1)1&n&&(a=a*t%i);return a}function h(e,n){for(;0==n%2;n/=2);for(;0==n%5;n/=5);if(1===n)return 0;for(var i=10%n,a=1;1!==i;a++)if(i=10*i%n,2000<a)return 0;return a}function y(e,n,i){for(var a=1,r=u(10,i,n),o=0;300>o;o++){if(a===r)return o;a=10*a%n,r=10*r%n}return 0}function x(e,t){if(!e)return t;if(!t)return e;for(;;){if(e%=t,!e)return t;if(t%=e,!t)return e}}function _(e,t){return this instanceof _?void(M(e,t),e=_.REDUCE?x(f.d,f.n):1,this.s=f.s,this.n=f.n/e,this.d=f.d/e):new _(e,t)}var f={s:1,n:0,d:1},g=_.DivisionByZero=t("DivisionByZero"),v=_.InvalidParameter=t("InvalidParameter"),M=function(e,t){var o=0,u=1,h=1,_=0,b=0,S=0,E=1,I=1,k=0,j=1,P=1,O=1,T=1e7,N;if(e===void 0||null===e);else if(t!==void 0)o=e,u=t,h=o*u;else switch(typeof e){case"object":{"d"in e&&"n"in e?(o=e.n,u=e.d,"s"in e&&(o*=e.s)):0 in e?(o=e[0],1 in e&&(u=e[1])):m(),h=o*u;break}case"number":{if(0>e&&(h=e,e=-e),0==e%1)o=e;else if(0<e){for(1<=e&&(I=p(10,i(1+r(e)/a)),e/=I);j<=T&&O<=T;)if(N=(k+P)/(j+O),e===N){j+O<=T?(o=k+P,u=j+O):O>j?(o=P,u=O):(o=k,u=j);break}else e>N?(k+=P,j+=O):(P+=k,O+=j),j>T?(o=P,u=O):(o=k,u=j);o*=I}else(isNaN(e)||isNaN(t))&&(u=o=NaN);break}case"string":if(j=e.match(/\d+|./g),null===j&&m(),"-"===j[k]?(h=-1,k++):"+"===j[k]&&k++,j.length===k+1?b=c(j[k++],h):"."===j[k+1]||"."===j[k]?("."!==j[k]&&(_=c(j[k++],h)),k++,(k+1===j.length||"("===j[k+1]&&")"===j[k+3]||"'"===j[k+1]&&"'"===j[k+3])&&(b=c(j[k],h),E=p(10,j[k].length),k++),("("===j[k]&&")"===j[k+2]||"'"===j[k]&&"'"===j[k+2])&&(S=c(j[k+1],h),I=p(10,j[k+1].length)-1,k+=3)):"/"===j[k+1]||":"===j[k+1]?(b=c(j[k],h),E=c(j[k+2],1),k+=3):"/"===j[k+3]&&" "===j[k+1]&&(_=c(j[k],h),b=c(j[k+2],h),E=c(j[k+4],1),k+=5),j.length<=k){u=E*I,h=o=S+u*_+I*b;break}default:m();}if(0===u)throw new g;f.s=0>h?-1:1,f.n=l(o),f.d=l(u)};_.REDUCE=1,_.prototype={s:1,n:0,d:1,abs:function(){return new _(this.n,this.d)},neg:function(){return new _(-this.s*this.n,this.d)},add:function(e,t){return M(e,t),new _(this.s*this.n*f.d+f.s*this.d*f.n,this.d*f.d)},sub:function(e,t){return M(e,t),new _(this.s*this.n*f.d-f.s*this.d*f.n,this.d*f.d)},mul:function(e,t){return M(e,t),new _(this.s*f.s*this.n*f.n,this.d*f.d)},div:function(e,t){return M(e,t),new _(this.s*f.s*this.n*f.d,this.d*f.n)},clone:function(){return new _(this)},mod:function(e,t){return isNaN(this.n)||isNaN(this.d)?new _(NaN):void 0===e?new _(this.s*this.n%this.d,1):(M(e,t),0===f.n&&0===this.d&&_(0,0),new _(this.s*(f.d*this.n)%(f.n*this.d),f.d*this.d))},gcd:function(e,t){return M(e,t),new _(x(f.n,this.n)*x(f.d,this.d),f.d*this.d)},lcm:function(e,t){return M(e,t),0===f.n&&0===this.n?new _:new _(f.n*this.n,x(f.n,this.n)*x(f.d,this.d))},ceil:function(e){return e=p(10,e||0),isNaN(this.n)||isNaN(this.d)?new _(NaN):new _(o(e*this.s*this.n/this.d),e)},floor:function(e){return e=p(10,e||0),isNaN(this.n)||isNaN(this.d)?new _(NaN):new _(i(e*this.s*this.n/this.d),e)},round:function(e){return e=p(10,e||0),isNaN(this.n)||isNaN(this.d)?new _(NaN):new _(d(e*this.s*this.n/this.d),e)},inverse:function(){return new _(this.s*this.d,this.n)},pow:function(e){return 0>e?new _(p(this.s*this.d,-e),p(this.n,-e)):new _(p(this.s*this.n,e),p(this.d,e))},equals:function(e,t){return M(e,t),this.s*this.n*f.d==f.s*f.n*this.d},compare:function(e,n){M(e,n);var i=this.s*this.n*f.d-f.s*f.n*this.d;return(0<i)-(0>i)},simplify:function(e){function t(e){return 1===e.length?new _(e[0]):t(e.slice(1)).inverse().add(e[0])}if(isNaN(this.n)||isNaN(this.d))return this;var n=this.abs().toContinued();e=e||.001;for(var a=0,r;a<n.length;a++)if(r=t(n.slice(0,a+1)),r.sub(this.abs()).abs().valueOf()<e)return r.mul(this.s);return this},divisible:function(e,t){return M(e,t),f.n*this.d&&!(this.n*f.d%(f.n*this.d))},valueOf:function(){return this.s*this.n/this.d},toFraction:function(e){var t="",a=this.n,r=this.d,o;return 0>this.s&&(t+="-"),1===r?t+=a:(e&&0<(o=i(a/r))&&(t+=o,t+=" ",a%=r),t+=a,t+="/",t+=r),t},toLatex:function(e){var t="",a=this.n,r=this.d,o;return 0>this.s&&(t+="-"),1===r?t+=a:(e&&0<(o=i(a/r))&&(t+=o,a%=r),t+="\\frac{",t+=a,t+="}{",t+=r,t+="}"),t},toContinued:function(){var e=this.n,n=this.d,r=[],o;if(isNaN(e)||isNaN(n))return r;do r.push(i(e/n)),o=e%n,e=n,n=o;while(1!==e);return r},toString:function(e){var t=this.n,n=this.d,a;if(isNaN(t)||isNaN(n))return"NaN";_.REDUCE||(a=x(t,n),t/=a,n/=a),e=e||15;var r=h(t,n),o=y(t,n,r),s=-1===this.s?"-":"";if(s+=0|t/n,t%=n,t*=10,t&&(s+="."),r){for(var p=o;p--;)s+=0|t/n,t%=n,t*=10;s+="(";for(var p=r;p--;)s+=0|t/n,t%=n,t*=10;s+=")"}else for(var p=e;t&&p--;)s+=0|t/n,t%=n,t*=10;return s}},Object.defineProperty(_,"__esModule",{value:!0}),_["default"]=_,_.Fraction=_,e.exports=_})()}),Fraction=unwrapExports(fraction),name$2="Fraction",dependencies$3=[],createFractionClass=factory(name$2,dependencies$3,()=>(Fraction.prototype.type="Fraction",Fraction.prototype.isFraction=!0,Fraction.prototype.toJSON=function(){return{mathjs:"Fraction",n:this.s*this.n,d:this.d}},Fraction.fromJSON=function(e){return new Fraction(e)},Fraction),{isClass:!0}),name$3="Matrix",dependencies$4=[],createMatrixClass=factory(name$3,dependencies$4,()=>{function e(){if(!(this instanceof e))throw new SyntaxError("Constructor must be called with the new operator")}return e.prototype.type="Matrix",e.prototype.isMatrix=!0,e.prototype.storage=function(){throw new Error("Cannot invoke storage on a Matrix interface")},e.prototype.datatype=function(){throw new Error("Cannot invoke datatype on a Matrix interface")},e.prototype.create=function(){throw new Error("Cannot invoke create on a Matrix interface")},e.prototype.subset=function(){throw new Error("Cannot invoke subset on a Matrix interface")},e.prototype.get=function(){throw new Error("Cannot invoke get on a Matrix interface")},e.prototype.set=function(){throw new Error("Cannot invoke set on a Matrix interface")},e.prototype.resize=function(){throw new Error("Cannot invoke resize on a Matrix interface")},e.prototype.reshape=function(){throw new Error("Cannot invoke reshape on a Matrix interface")},e.prototype.clone=function(){throw new Error("Cannot invoke clone on a Matrix interface")},e.prototype.size=function(){throw new Error("Cannot invoke size on a Matrix interface")},e.prototype.map=function(){throw new Error("Cannot invoke map on a Matrix interface")},e.prototype.forEach=function(){throw new Error("Cannot invoke forEach on a Matrix interface")},e.prototype.toArray=function(){throw new Error("Cannot invoke toArray on a Matrix interface")},e.prototype.valueOf=function(){throw new Error("Cannot invoke valueOf on a Matrix interface")},e.prototype.format=function(){throw new Error("Cannot invoke format on a Matrix interface")},e.prototype.toString=function(){throw new Error("Cannot invoke toString on a Matrix interface")},e},{isClass:!0}),name$4="DenseMatrix",dependencies$5=["Matrix"],createDenseMatrixClass=factory(name$4,dependencies$5,e=>{var c=Math.min;function t(e,n){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");if(n&&!isString(n))throw new Error("Invalid datatype: "+n);if(isMatrix(e))"DenseMatrix"===e.type?(this._data=clone(e._data),this._size=clone(e._size),this._datatype=n||e._datatype):(this._data=e.toArray(),this._size=e.size(),this._datatype=n||e._datatype);else if(e&&isArray(e.data)&&isArray(e.size))this._data=e.data,this._size=e.size,validate(this._data,this._size),this._datatype=n||e.datatype;else if(isArray(e))this._data=l(e),this._size=arraySize(this._data),validate(this._data,this._size),this._datatype=n;else if(e)throw new TypeError("Unsupported type of data ("+typeOf(e)+")");else this._data=[],this._size=[0],this._datatype=n}function n(e,n){if(!isIndex(n))throw new TypeError("Invalid index");var r=n.isScalar();if(r)return e.get(n.min());var o=n.size();if(o.length!==e._size.length)throw new DimensionError(o.length,e._size.length);for(var s=n.min(),p=n.max(),l=0,d=e._size.length;l<d;l++)validateIndex(s[l],e._size[l]),validateIndex(p[l],e._size[l]);return new t(a(e._data,n,o.length,0),e._datatype)}function a(e,t,n,r){var o=t.dimension(r);return r===n-1?o.map(function(t){return validateIndex(t,e.length),e[t]}).valueOf():o.map(function(o){validateIndex(o,e.length);var i=e[o];return a(i,t,n,r+1)}).valueOf()}function r(e,t,n,a){if(!t||!0!==t.isIndex)throw new TypeError("Invalid index");var r=t.size(),s=t.isScalar(),l;if(isMatrix(n)?(l=n.size(),n=n.valueOf()):l=arraySize(n),s){if(0!==l.length)throw new TypeError("Scalar expected");e.set(t.min(),n,a)}else{if(r.length<e._size.length)throw new DimensionError(r.length,e._size.length,"<");if(l.length<r.length){for(var d=0,c=0;1===r[d]&&1===l[d];)d++;for(;1===r[d];)c++,d++;n=unsqueeze(n,r.length,c,l)}if(!deepStrictEqual(r,l))throw new DimensionError(r,l,">");var m=t.max().map(function(e){return e+1});p(e,m,a);var u=r.length;o(e._data,t,n,u,0)}return e}function o(e,t,n,i,a){var r=t.dimension(a);a===i-1?r.forEach(function(t,i){validateIndex(t),e[t]=n[i[0]]}):r.forEach(function(r,s){validateIndex(r),o(e[r],t,n[s[0]],i,a+1)})}function s(e,t,n){if(0===t.length){for(var i=e._data;isArray(i);)i=i[0];return i}return e._size=t.slice(0),e._data=resize(e._data,e._size,n),e}function p(e,t,n){for(var a=e._size.slice(0),r=!1;a.length<t.length;)a.push(0),r=!0;for(var o=0,p=t.length;o<p;o++)t[o]>a[o]&&(a[o]=t[o],r=!0);r&&s(e,a,n)}function l(e){for(var t=0,n=e.length,a;t<n;t++)a=e[t],isArray(a)?e[t]=l(a):a&&!0===a.isMatrix&&(e[t]=l(a.valueOf()));return e}var{Matrix:m}=e;return t.prototype=new m,t.prototype.createDenseMatrix=function(e,n){return new t(e,n)},t.prototype.type="DenseMatrix",t.prototype.isDenseMatrix=!0,t.prototype.getDataType=function(){return getArrayDataType(this._data,typeOf)},t.prototype.storage=function(){return"dense"},t.prototype.datatype=function(){return this._datatype},t.prototype.create=function(e,n){return new t(e,n)},t.prototype.subset=function(e,t,i){switch(arguments.length){case 1:return n(this,e);case 2:case 3:return r(this,e,t,i);default:throw new SyntaxError("Wrong number of arguments");}},t.prototype.get=function(e){if(!isArray(e))throw new TypeError("Array expected");if(e.length!==this._size.length)throw new DimensionError(e.length,this._size.length);for(var t=0;t<e.length;t++)validateIndex(e[t],this._size[t]);for(var n=this._data,a=0,r=e.length,o;a<r;a++)o=e[a],validateIndex(o,n.length),n=n[o];return n},t.prototype.set=function(e,t,n){if(!isArray(e))throw new TypeError("Array expected");if(e.length<this._size.length)throw new DimensionError(e.length,this._size.length,"<");var a=e.map(function(e){return e+1}),r,o,s;p(this,a,n);var l=this._data;for(r=0,o=e.length-1;r<o;r++)s=e[r],validateIndex(s,l.length),l=l[s];return s=e[e.length-1],validateIndex(s,l.length),l[s]=t,this},t.prototype.resize=function(e,t,n){if(!isCollection(e))throw new TypeError("Array or Matrix expected");var i=e.valueOf().map(e=>Array.isArray(e)&&1===e.length?e[0]:e),a=n?this.clone():this;return s(a,i,t)},t.prototype.reshape=function(e,t){var n=t?this.clone():this;return n._data=reshape(n._data,e),n._size=e.slice(0),n},t.prototype.clone=function(){var e=new t({data:clone(this._data),size:clone(this._size),datatype:this._datatype});return e},t.prototype.size=function(){return this._size.slice(0)},t.prototype.map=function(e){var n=this,i=function t(i,a){return isArray(i)?i.map(function(e,n){return t(e,a.concat(n))}):e(i,a,n)}(this._data,[]),a=void 0===this._datatype?void 0:getArrayDataType(i,typeOf);return new t(i,a)},t.prototype.forEach=function(e){var t=this;(function n(i,a){isArray(i)?i.forEach(function(e,t){n(e,a.concat(t))}):e(i,a,t)})(this._data,[])},t.prototype.toArray=function(){return clone(this._data)},t.prototype.valueOf=function(){return this._data},t.prototype.format=function(e){return format$2(this._data,e)},t.prototype.toString=function(){return format$2(this._data)},t.prototype.toJSON=function(){return{mathjs:"DenseMatrix",data:this._data,size:this._size,datatype:this._datatype}},t.prototype.diagonal=function(e){if(!e)e=0;else if(isBigNumber(e)&&(e=e.toNumber()),!isNumber(e)||!isInteger(e))throw new TypeError("The parameter k must be an integer number");for(var a=0<e?e:0,r=0>e?-e:0,o=this._size[0],s=this._size[1],p=c(o-r,s-a),n=[],l=0;l<p;l++)n[l]=this._data[l+r][l+a];return new t({data:n,size:[p],datatype:this._datatype})},t.diagonal=function(e,a,r,i){if(!isArray(e))throw new TypeError("Array expected, size parameter");if(2!==e.length)throw new Error("Only two dimensions matrix are supported");if(e=e.map(function(e){if(isBigNumber(e)&&(e=e.toNumber()),!isNumber(e)||!isInteger(e)||1>e)throw new Error("Size values must be positive integers");return e}),!r)r=0;else if(isBigNumber(r)&&(r=r.toNumber()),!isNumber(r)||!isInteger(r))throw new TypeError("The parameter k must be an integer number");var o=0<r?r:0,s=0>r?-r:0,p=e[0],l=e[1],m=c(p-s,l-o),n;if(isArray(a)){if(a.length!==m)throw new Error("Invalid value array length");n=function(e){return a[e]}}else if(isMatrix(a)){var u=a.size();if(1!==u.length||u[0]!==m)throw new Error("Invalid matrix length");n=function(e){return a.get([e])}}else n=function(){return a};i||(i=isBigNumber(n(0))?n(0).mul(0):0);var g=[];if(0<e.length){g=resize(g,e,i);for(var h=0;h<m;h++)g[h+s][h+o]=n(h)}return new t({data:g,size:[p,l]})},t.fromJSON=function(e){return new t(e)},t.prototype.swapRows=function(e,n){if(!isNumber(e)||!isInteger(e)||!isNumber(n)||!isInteger(n))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return validateIndex(e,this._size[0]),validateIndex(n,this._size[0]),t._swapRows(e,n,this._data),this},t._swapRows=function(e,t,n){var i=n[e];n[e]=n[t],n[t]=i},t},{isClass:!0});function deepMap(e,t){return e&&"function"==typeof e.map?e.map(function(e){return deepMap(e,t)}):t(e)}var n1="number",n2="number, number";function absNumber(e){return Math.abs(e)}absNumber.signature="number";function addNumber(e,t){return e+t}addNumber.signature=n2;function multiplyNumber(e,t){return e*t}multiplyNumber.signature=n2;function unaryMinusNumber(e){return-e}unaryMinusNumber.signature="number";function nearlyEqual$1(e,t,n){if(null===n||n===void 0)return e.eq(t);if(e.eq(t))return!0;if(e.isNaN()||t.isNaN())return!1;if(e.isFinite()&&t.isFinite()){var i=e.minus(t).abs();if(i.isZero())return!0;var a=e.constructor.max(e.abs(),t.abs());return i.lte(a.times(n))}return!1}function complexEquals(e,t,n){return nearlyEqual(e.re,t.re,n)&&nearlyEqual(e.im,t.im,n)}var name$5="equalScalar",dependencies$6=["typed","config"],createEqualScalar=factory("equalScalar",dependencies$6,e=>{var{typed:t,config:n}=e;return t(name$5,{"boolean, boolean":function(e,t){return e===t},"number, number":function(e,t){return nearlyEqual(e,t,n.epsilon)},"BigNumber, BigNumber":function(e,t){return e.eq(t)||nearlyEqual$1(e,t,n.epsilon)},"Fraction, Fraction":function(e,t){return e.equals(t)},"Complex, Complex":function(e,t){return complexEquals(e,t,n.epsilon)},"Unit, Unit":function(e,t){if(!e.equalBase(t))throw new Error("Cannot compare units with different base");return this(e.value,t.value)}})}),createEqualScalarNumber=factory("equalScalar",["typed","config"],e=>{var{typed:t,config:n}=e;return t(name$5,{"number, number":function(e,t){return nearlyEqual(e,t,n.epsilon)}})}),name$6="SparseMatrix",dependencies$7=["typed","equalScalar","Matrix"],createSparseMatrixClass=factory(name$6,dependencies$7,e=>{var u=Math.floor,g=Math.max,h=Math.min;function t(e,a){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");if(a&&!isString(a))throw new Error("Invalid datatype: "+a);if(isMatrix(e))n(this,e,a);else if(e&&isArray(e.index)&&isArray(e.ptr)&&isArray(e.size))this._values=e.values,this._index=e.index,this._ptr=e.ptr,this._size=e.size,this._datatype=a||e.datatype;else if(isArray(e))i(this,e,a);else if(e)throw new TypeError("Unsupported type of data ("+typeOf(e)+")");else this._values=[],this._index=[],this._ptr=[0],this._size=[0,0],this._datatype=a}function n(e,t,n){"SparseMatrix"===t.type?(e._values=t._values?clone(t._values):void 0,e._index=clone(t._index),e._ptr=clone(t._ptr),e._size=clone(t._size),e._datatype=n||t._datatype):i(e,t.valueOf(),n||t._datatype)}function i(e,t,n){e._values=[],e._index=[],e._ptr=[],e._datatype=n;var a=t.length,r=0,o=x,s=0;if(isString(n)&&(o=y.find(x,[n,n])||x,s=y.convert(0,n)),0<a){var p=0;do{e._ptr.push(e._index.length);for(var l=0,d;l<a;l++)if(d=t[l],!isArray(d))0==p&&1>r&&(r=1),o(d,s)||(e._values.push(d),e._index.push(l));else if(0==p&&r<d.length&&(r=d.length),p<d.length){var c=d[p];o(c,s)||(e._values.push(c),e._index.push(l))}p++}while(p<r)}e._ptr.push(e._index.length),e._size=[a,r]}function a(e,n){if(!isIndex(n))throw new TypeError("Invalid index");var a=n.isScalar();if(a)return e.get(n.min());var r=n.size();if(r.length!==e._size.length)throw new DimensionError(r.length,e._size.length);var o=n.min(),s=n.max(),p,l,d,c;for(p=0,l=e._size.length;p<l;p++)validateIndex(o[p],e._size[p]),validateIndex(s[p],e._size[p]);var m=e._values,u=e._index,g=e._ptr,h=n.dimension(0),y=n.dimension(1),x=[],_=[];h.forEach(function(e,t){_[e]=t[0],x[e]=!0});var f=m?[]:void 0,v=[],b=[];return y.forEach(function(e){for(b.push(v.length),d=g[e],c=g[e+1];d<c;d++)p=u[d],!0===x[p]&&(v.push(_[p]),f&&f.push(m[d]))}),b.push(v.length),new t({values:f,index:v,ptr:b,size:r,datatype:e._datatype})}function r(e,t,a,r){if(!t||!0!==t.isIndex)throw new TypeError("Invalid index");var o=t.size(),s=t.isScalar(),p;if(isMatrix(a)?(p=a.size(),a=a.toArray()):p=arraySize(a),s){if(0!==p.length)throw new TypeError("Scalar expected");e.set(t.min(),a,r)}else{if(1!==o.length&&2!==o.length)throw new DimensionError(o.length,e._size.length,"<");if(p.length<o.length){for(var l=0,d=0;1===o[l]&&1===p[l];)l++;for(;1===o[l];)d++,l++;a=unsqueeze(a,o.length,d,p)}if(!deepStrictEqual(o,p))throw new DimensionError(o,p,">");for(var c=t.min()[0],u=t.min()[1],g=p[0],m=p[1],n=0;n<g;n++)for(var h=0,_;h<m;h++)_=a[n][h],e.set([n+c,h+u],_,r)}return e}function o(e,t,n,i){if(0==n-t)return n;for(var a=t;a<n;a++)if(i[a]===e)return a;return t}function s(e,t,n,i,a){n.splice(e,1),i.splice(e,1);for(var r=t+1;r<a.length;r++)a[r]--}function p(e,t,n,i,a,r,o){a.splice(e,0,i),r.splice(e,0,t);for(var s=n+1;s<o.length;s++)o[s]++}function l(e,t,a,o){var s=o||0,l=x,m=0;isString(e._datatype)&&(l=y.find(x,[e._datatype,e._datatype])||x,m=y.convert(0,e._datatype),s=y.convert(s,e._datatype));var u=!l(s,m),g=e._size[0],r=e._size[1],h,_,f;if(a>r){for(_=r;_<a;_++)if(e._ptr[_]=e._values.length,u)for(h=0;h<g;h++)e._values.push(s),e._index.push(h);e._ptr[a]=e._values.length}else a<r&&(e._ptr.splice(a+1,r-a),e._values.splice(e._ptr[a],e._values.length),e._index.splice(e._ptr[a],e._index.length));if(r=a,t>g){if(u){var v=0;for(_=0;_<r;_++){e._ptr[_]+=v,f=e._ptr[_+1]+v;var b=0;for(h=g;h<t;h++,b++)e._values.splice(f+b,0,s),e._index.splice(f+b,0,h),v++}e._ptr[r]=e._values.length}}else if(t<g){var M=0;for(_=0;_<r;_++){e._ptr[_]-=M;var S=e._ptr[_],N=e._ptr[_+1]-M;for(f=S;f<N;f++)h=e._index[f],h>t-1&&(e._values.splice(f,1),e._index.splice(f,1),M++)}e._ptr[_]=e._values.length}return e._size[0]=t,e._size[1]=a,e}function d(e,n,a,r,o,s,p){var l=[],d=[],c=[],m=x,u=0;isString(e._datatype)&&(m=y.find(x,[e._datatype,e._datatype])||x,u=y.convert(0,e._datatype));for(var g=function(e,t,n){e=s(e,t,n),m(e,u)||(l.push(e),d.push(t))},h=r;h<=o;h++){c.push(l.length);var _=e._ptr[h],f=e._ptr[h+1];if(p)for(var v=_,b;v<f;v++)b=e._index[v],b>=n&&b<=a&&g(e._values[v],b-n,h-r);else{for(var M={},S=_,N;S<f;S++)N=e._index[S],M[N]=e._values[S];for(var z=n,E;z<=a;z++)E=z in M?M[z]:0,g(E,z-n,h-r)}}return c.push(l.length),new t({values:l,index:d,ptr:c,size:[a-n+1,o-r+1]})}function c(e,t,n,r,o){var s=r[0],p=r[1],l=[],a,d;for(a=0;a<s;a++)for(l[a]=[],d=0;d<p;d++)l[a][d]=0;for(d=0;d<p;d++)for(var c=n[d],m=n[d+1],u=c;u<m;u++)a=t[u],l[a][d]=e?o?clone(e[u]):e[u]:1;return l}var{typed:y,equalScalar:x,Matrix:_}=e;return t.prototype=new _,t.prototype.createSparseMatrix=function(e,n){return new t(e,n)},t.prototype.type="SparseMatrix",t.prototype.isSparseMatrix=!0,t.prototype.getDataType=function(){return getArrayDataType(this._values,typeOf)},t.prototype.storage=function(){return"sparse"},t.prototype.datatype=function(){return this._datatype},t.prototype.create=function(e,n){return new t(e,n)},t.prototype.density=function(){var e=this._size[0],t=this._size[1];return 0!==e&&0!==t?this._index.length/(e*t):0},t.prototype.subset=function(e,t,n){if(!this._values)throw new Error("Cannot invoke subset on a Pattern only matrix");switch(arguments.length){case 1:return a(this,e);case 2:case 3:return r(this,e,t,n);default:throw new SyntaxError("Wrong number of arguments");}},t.prototype.get=function(e){if(!isArray(e))throw new TypeError("Array expected");if(e.length!==this._size.length)throw new DimensionError(e.length,this._size.length);if(!this._values)throw new Error("Cannot invoke get on a Pattern only matrix");var t=e[0],n=e[1];validateIndex(t,this._size[0]),validateIndex(n,this._size[1]);var i=o(t,this._ptr[n],this._ptr[n+1],this._index);return i<this._ptr[n+1]&&this._index[i]===t?this._values[i]:0},t.prototype.set=function(e,t,n){if(!isArray(e))throw new TypeError("Array expected");if(e.length!==this._size.length)throw new DimensionError(e.length,this._size.length);if(!this._values)throw new Error("Cannot invoke set on a Pattern only matrix");var a=e[0],i=e[1],r=this._size[0],d=this._size[1],c=x,m=0;isString(this._datatype)&&(c=y.find(x,[this._datatype,this._datatype])||x,m=y.convert(0,this._datatype)),(a>r-1||i>d-1)&&(l(this,g(a+1,r),g(i+1,d),n),r=this._size[0],d=this._size[1]),validateIndex(a,r),validateIndex(i,d);var u=o(a,this._ptr[i],this._ptr[i+1],this._index);return u<this._ptr[i+1]&&this._index[u]===a?c(t,m)?s(u,i,this._values,this._index,this._ptr):this._values[u]=t:p(u,a,i,t,this._values,this._index,this._ptr),this},t.prototype.resize=function(e,t,n){if(!isCollection(e))throw new TypeError("Array or Matrix expected");var i=e.valueOf().map(e=>Array.isArray(e)&&1===e.length?e[0]:e);if(2!==i.length)throw new Error("Only two dimensions matrix are supported");i.forEach(function(e){if(!isNumber(e)||!isInteger(e)||0>e)throw new TypeError("Invalid size, must contain positive integers (size: "+format$2(i)+")")});var a=n?this.clone():this;return l(a,i[0],i[1],t)},t.prototype.reshape=function(e,t){if(!isArray(e))throw new TypeError("Array expected");if(2!==e.length)throw new Error("Sparse matrices can only be reshaped in two dimensions");if(e.forEach(function(t){if(!isNumber(t)||!isInteger(t)||0>t)throw new TypeError("Invalid size, must contain positive integers (size: "+format$2(e)+")")}),this._size[0]*this._size[1]!=e[0]*e[1])throw new Error("Reshaping sparse matrix will result in the wrong number of elements");var n=t?this.clone():this;if(this._size[0]===e[0]&&this._size[1]===e[1])return n;for(var a=[],r=0;r<n._ptr.length;r++)for(var s=0;s<n._ptr[r+1]-n._ptr[r];s++)a.push(r);for(var l=n._values.slice(),d=n._index.slice(),c=0;c<n._index.length;c++){var m=d[c],g=a[c],y=m*n._size[1]+g;a[c]=y%e[1],d[c]=u(y/e[1])}n._values.length=0,n._index.length=0,n._ptr.length=e[1]+1,n._size=e.slice();for(var x=0;x<n._ptr.length;x++)n._ptr[x]=0;for(var _=0;_<l.length;_++){var f=d[_],b=a[_],M=l[_],v=o(f,n._ptr[b],n._ptr[b+1],n._index);p(v,f,b,M,n._values,n._index,n._ptr)}return n},t.prototype.clone=function(){var e=new t({values:this._values?clone(this._values):void 0,index:clone(this._index),ptr:clone(this._ptr),size:clone(this._size),datatype:this._datatype});return e},t.prototype.size=function(){return this._size.slice(0)},t.prototype.map=function(e,t){if(!this._values)throw new Error("Cannot invoke map on a Pattern only matrix");var n=this,i=this._size[0],a=this._size[1];return d(this,0,i-1,0,a-1,function(t,a,i){return e(t,[a,i],n)},t)},t.prototype.forEach=function(e,t){if(!this._values)throw new Error("Cannot invoke forEach on a Pattern only matrix");for(var n=this,a=this._size[0],r=this._size[1],o=0;o<r;o++){var s=this._ptr[o],p=this._ptr[o+1];if(t)for(var l=s,d;l<p;l++)d=this._index[l],e(this._values[l],[d,o],n);else{for(var c={},m=s,u;m<p;m++)u=this._index[m],c[u]=this._values[m];for(var g=0,h;g<a;g++)h=g in c?c[g]:0,e(h,[g,o],n)}}},t.prototype.toArray=function(){return c(this._values,this._index,this._ptr,this._size,!0)},t.prototype.valueOf=function(){return c(this._values,this._index,this._ptr,this._size,!1)},t.prototype.format=function(e){for(var t=this._size[0],n=this._size[1],a=this.density(),r="Sparse Matrix ["+format$2(t,e)+" x "+format$2(n,e)+"] density: "+format$2(a,e)+"\n",o=0;o<n;o++)for(var s=this._ptr[o],p=this._ptr[o+1],l=s,d;l<p;l++)d=this._index[l],r+="\n    ("+format$2(d,e)+", "+format$2(o,e)+") ==> "+(this._values?format$2(this._values[l],e):"X");return r},t.prototype.toString=function(){return format$2(this.toArray())},t.prototype.toJSON=function(){return{mathjs:"SparseMatrix",values:this._values,index:this._index,ptr:this._ptr,size:this._size,datatype:this._datatype}},t.prototype.diagonal=function(e){if(!e)e=0;else if(isBigNumber(e)&&(e=e.toNumber()),!isNumber(e)||!isInteger(e))throw new TypeError("The parameter k must be an integer number");var a=0<e?e:0,r=0>e?-e:0,o=this._size[0],s=this._size[1],p=h(o-r,s-a),n=[],l=[],d=[];d[0]=0;for(var c=a;c<s&&n.length<p;c++)for(var m=this._ptr[c],u=this._ptr[c+1],g=m,y;g<u;g++)if(y=this._index[g],y===c-a+r){n.push(this._values[g]),l[n.length-1]=y-r;break}return d.push(n.length),new t({values:n,index:l,ptr:d,size:[p,1]})},t.fromJSON=function(e){return new t(e)},t.diagonal=function(e,a,r,o,s){if(!isArray(e))throw new TypeError("Array expected, size parameter");if(2!==e.length)throw new Error("Only two dimensions matrix are supported");if(e=e.map(function(e){if(isBigNumber(e)&&(e=e.toNumber()),!isNumber(e)||!isInteger(e)||1>e)throw new Error("Size values must be positive integers");return e}),!r)r=0;else if(isBigNumber(r)&&(r=r.toNumber()),!isNumber(r)||!isInteger(r))throw new TypeError("The parameter k must be an integer number");var p=x,l=0;isString(s)&&(p=y.find(x,[s,s])||x,l=y.convert(0,s));var d=0<r?r:0,c=0>r?-r:0,m=e[0],u=e[1],g=h(m-c,u-d),n;if(isArray(a)){if(a.length!==g)throw new Error("Invalid value array length");n=function(e){return a[e]}}else if(isMatrix(a)){var _=a.size();if(1!==_.length||_[0]!==g)throw new Error("Invalid matrix length");n=function(e){return a.get([e])}}else n=function(){return a};for(var f=[],b=[],M=[],S=0;S<u;S++){M.push(f.length);var N=S-d;if(0<=N&&N<g){var i=n(N);p(i,l)||(b.push(N+c),f.push(i))}}return M.push(f.length),new t({values:f,index:b,ptr:M,size:[m,u]})},t.prototype.swapRows=function(e,n){if(!isNumber(e)||!isInteger(e)||!isNumber(n)||!isInteger(n))throw new Error("Row index must be positive integers");if(2!==this._size.length)throw new Error("Only two dimensional matrix is supported");return validateIndex(e,this._size[0]),validateIndex(n,this._size[0]),t._swapRows(e,n,this._size[1],this._values,this._index,this._ptr),this},t._forEachRow=function(e,t,n,i,a){for(var r=i[e],o=i[e+1],s=r;s<o;s++)a(n[s],t[s])},t._swapRows=function(e,t,n,i,a,r){for(var s=0;s<n;s++){var p=r[s],l=r[s+1],d=o(e,p,l,a),c=o(t,p,l,a);if(d<l&&c<l&&a[d]===e&&a[c]===t){if(i){var m=i[d];i[d]=i[c],i[c]=m}continue}if(d<l&&a[d]===e&&(c>=l||a[c]!==t)){var u=i?i[d]:void 0;a.splice(c,0,t),i&&i.splice(c,0,u),a.splice(c<=d?d+1:d,1),i&&i.splice(c<=d?d+1:d,1);continue}if(c<l&&a[c]===t&&(d>=l||a[d]!==e)){var g=i?i[c]:void 0;a.splice(d,0,e),i&&i.splice(d,0,g),a.splice(d<=c?c+1:c,1),i&&i.splice(d<=c?c+1:c,1)}}},t},{isClass:!0}),name$7="number",dependencies$8=["typed"],createNumber=factory(name$7,dependencies$8,e=>{var{typed:t}=e,n=t("number",{"":function(){return 0},number:function(e){return e},string:function(e){if("NaN"===e)return NaN;var t=+e;if(isNaN(t))throw new SyntaxError("String \""+e+"\" is no valid number");if(["0b","0o","0x"].includes(e.substring(0,2))){if(4294967295<t)throw new SyntaxError("String \"".concat(e,"\" is out of range"));2147483648&t&&(t=-1*~(t-1))}return t},BigNumber:function(e){return e.toNumber()},Fraction:function(e){return e.valueOf()},Unit:function(){throw new Error("Second argument with valueless unit expected")},null:function(){return 0},"Unit, string | Unit":function(e,t){return e.toNumber(t)},"Array | Matrix":function(e){return deepMap(e,this)}});return n.fromJSON=function(e){return parseFloat(e.value)},n}),name$8="bignumber",dependencies$9=["typed","BigNumber"],createBignumber=factory(name$8,dependencies$9,e=>{var{typed:t,BigNumber:n}=e;return t("bignumber",{"":function(){return new n(0)},number:function(e){return new n(e+"")},string:function(e){return new n(e)},BigNumber:function(e){return e},Fraction:function(e){return new n(e.n).div(e.d).times(e.s)},null:function(){return new n(0)},"Array | Matrix":function(e){return deepMap(e,this)}})}),name$9="fraction",dependencies$a=["typed","Fraction"],createFraction=factory(name$9,dependencies$a,e=>{var{typed:t,Fraction:n}=e;return t("fraction",{number:function(e){if(!isFinite(e)||isNaN(e))throw new Error(e+" cannot be represented as a fraction");return new n(e)},string:function(e){return new n(e)},"number, number":function(e,t){return new n(e,t)},null:function(){return new n(0)},BigNumber:function(e){return new n(e.toString())},Fraction:function(e){return e},Object:function(e){return new n(e)},"Array | Matrix":function(e){return deepMap(e,this)}})}),name$a="matrix",dependencies$b=["typed","Matrix","DenseMatrix","SparseMatrix"],createMatrix=factory(name$a,dependencies$b,e=>{function t(e,t,n){if("dense"===t||"default"===t||t===void 0)return new a(e,n);if("sparse"===t)return new r(e,n);throw new TypeError("Unknown matrix type "+JSON.stringify(t)+".")}var{typed:n,Matrix:i,DenseMatrix:a,SparseMatrix:r}=e;return n(name$a,{"":function(){return t([])},string:function(e){return t([],e)},"string, string":function(e,n){return t([],e,n)},Array:function(e){return t(e)},Matrix:function(e){return t(e,e.storage())},"Array | Matrix, string":t,"Array | Matrix, string, string":t})}),name$b="unaryMinus",dependencies$c=["typed"],createUnaryMinus=factory(name$b,dependencies$c,e=>{var{typed:t}=e;return t(name$b,{number:unaryMinusNumber,Complex:function(e){return e.neg()},BigNumber:function(e){return e.neg()},Fraction:function(e){return e.neg()},Unit:function(e){var t=e.clone();return t.value=this(e.value),t},"Array | Matrix":function(e){return deepMap(e,this)}})}),name$c="abs",dependencies$d=["typed"],createAbs=factory(name$c,dependencies$d,e=>{var{typed:t}=e;return t(name$c,{number:absNumber,Complex:function(e){return e.abs()},BigNumber:function(e){return e.abs()},Fraction:function(e){return e.abs()},"Array | Matrix":function(e){return deepMap(e,this)},Unit:function(e){return e.abs()}})}),name$d="addScalar",dependencies$e=["typed"],createAddScalar=factory(name$d,dependencies$e,e=>{var{typed:t}=e;return t(name$d,{"number, number":addNumber,"Complex, Complex":function(e,t){return e.add(t)},"BigNumber, BigNumber":function(e,t){return e.plus(t)},"Fraction, Fraction":function(e,t){return e.add(t)},"Unit, Unit":function(e,t){if(null===e.value||void 0===e.value)throw new Error("Parameter x contains a unit with undefined value");if(null===t.value||void 0===t.value)throw new Error("Parameter y contains a unit with undefined value");if(!e.equalBase(t))throw new Error("Units do not match");var n=e.clone();return n.value=this(n.value,t.value),n.fixPrefix=!1,n}})}),name$e="algorithm11",dependencies$f=["typed","equalScalar"],createAlgorithm11=factory(name$e,dependencies$f,e=>{var{typed:t,equalScalar:n}=e;return function(e,a,r,o){var s=e._values,p=e._index,l=e._ptr,d=e._size,c=e._datatype;if(!s)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var m=d[0],u=d[1],g=n,h=0,y=r,x;"string"==typeof c&&(x=c,g=t.find(n,[x,x]),h=t.convert(0,x),a=t.convert(a,x),y=t.find(r,[x,x]));for(var _=[],f=[],M=[],S=0;S<u;S++){M[S]=f.length;for(var N=l[S],z=l[S+1],E=N;E<z;E++){var C=p[E],i=o?y(a,s[E]):y(s[E],a);g(i,h)||(f.push(C),_.push(i))}}return M[u]=f.length,e.createSparseMatrix({values:_,index:f,ptr:M,size:[m,u],datatype:x})}}),name$f="algorithm14",dependencies$g=["typed"],createAlgorithm14=factory(name$f,dependencies$g,e=>{function t(e,a,r,o,n,s,p){var l=[];if(a===r.length-1)for(var d=0;d<o;d++)l[d]=p?e(s,n[d]):e(n[d],s);else for(var c=0;c<o;c++)l[c]=t(e,a+1,r,r[a+1],n[c],s,p);return l}var{typed:n}=e;return function(e,i,a,r){var o=e._data,s=e._size,p=e._datatype,l=a,d;"string"==typeof p&&(d=p,i=n.convert(i,d),l=n.find(a,[d,d]));var c=0<s.length?t(l,0,s,s[0],o,i,r):[];return e.createDenseMatrix({data:c,size:clone(s),datatype:d})}}),name$g="algorithm01",dependencies$h=["typed"],createAlgorithm01=factory(name$g,dependencies$h,e=>{var{typed:t}=e;return function(e,n,a,r){var o=e._data,s=e._size,p=e._datatype,l=n._values,d=n._index,c=n._ptr,m=n._size,u=n._datatype;if(s.length!==m.length)throw new DimensionError(s.length,m.length);if(s[0]!==m[0]||s[1]!==m[1])throw new RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+m+")");if(!l)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var g=s[0],h=s[1],y="string"==typeof p&&p===u?p:void 0,_=y?t.find(a,[y,y]):a,f=[],v,b;for(v=0;v<g;v++)f[v]=[];var M=[],x=[];for(b=0;b<h;b++){for(var S=b+1,N=c[b],z=c[b+1],E=N;E<z;E++)v=d[E],M[v]=r?_(l[E],o[v][b]):_(o[v][b],l[E]),x[v]=S;for(v=0;v<g;v++)f[v][b]=x[v]===S?M[v]:o[v][b]}return e.createDenseMatrix({data:f,size:[g,h],datatype:y})}}),name$h="algorithm10",dependencies$i=["typed","DenseMatrix"],createAlgorithm10=factory(name$h,dependencies$i,e=>{var{typed:t,DenseMatrix:n}=e;return function(e,a,o,s){var p=e._values,l=e._index,d=e._ptr,c=e._size,m=e._datatype;if(!p)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var u=c[0],g=c[1],h=o,y;"string"==typeof m&&(y=m,a=t.convert(a,y),h=t.find(o,[y,y]));for(var _=[],f=[],x=[],v=0,M;v<g;v++){M=v+1;for(var S=d[v],N=d[v+1],z=S,E;z<N;z++)E=l[z],f[E]=p[z],x[E]=M;for(var C=0;C<u;C++)0==v&&(_[C]=[]),_[C][v]=x[C]===M?s?h(a,f[C]):h(f[C],a):a}return new n({data:_,size:[u,g],datatype:y})}}),name$i="algorithm13",dependencies$j=["typed"],createAlgorithm13=factory(name$i,dependencies$j,e=>{function t(e,a,r,o,n,s){var p=[];if(a===r.length-1)for(var l=0;l<o;l++)p[l]=e(n[l],s[l]);else for(var d=0;d<o;d++)p[d]=t(e,a+1,r,r[a+1],n[d],s[d]);return p}var{typed:n}=e;return function(e,i,a){var r=e._data,o=e._size,p=e._datatype,l=i._data,d=i._size,c=i._datatype,m=[];if(o.length!==d.length)throw new DimensionError(o.length,d.length);for(var u=0;u<o.length;u++){if(o[u]!==d[u])throw new RangeError("Dimension mismatch. Matrix A ("+o+") must match Matrix B ("+d+")");m[u]=o[u]}var g=a,h;"string"==typeof p&&p===c&&(h=p,g=n.find(a,[h,h]));var y=0<m.length?t(g,0,m,m[0],r,l):[];return e.createDenseMatrix({data:y,size:m,datatype:h})}}),name$j="algorithm03",dependencies$k=["typed"],createAlgorithm03=factory(name$j,dependencies$k,e=>{var{typed:t}=e;return function(e,n,a,r){var o=e._data,s=e._size,p=e._datatype,l=n._values,d=n._index,c=n._ptr,m=n._size,u=n._datatype;if(s.length!==m.length)throw new DimensionError(s.length,m.length);if(s[0]!==m[0]||s[1]!==m[1])throw new RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+m+")");if(!l)throw new Error("Cannot perform operation on Dense Matrix and Pattern Sparse Matrix");var g=s[0],h=s[1],_=0,f=a,v;"string"==typeof p&&p===u&&(v=p,_=t.convert(0,v),f=t.find(a,[v,v]));for(var b=[],M=0;M<g;M++)b[M]=[];for(var S=[],x=[],N=0,E;N<h;N++){E=N+1;for(var C=c[N],A=c[N+1],I=C,D;I<A;I++)D=d[I],S[D]=r?f(l[I],o[D][N]):f(o[D][N],l[I]),x[D]=E;for(var P=0;P<g;P++)b[P][N]=x[P]===E?S[P]:r?f(_,o[P][N]):f(o[P][N],_)}return e.createDenseMatrix({data:b,size:[g,h],datatype:v})}}),name$k="algorithm05",dependencies$l=["typed","equalScalar"],createAlgorithm05=factory(name$k,dependencies$l,e=>{var{typed:t,equalScalar:n}=e;return function(e,a,r){var o=e._values,s=e._index,p=e._ptr,l=e._size,d=e._datatype,c=a._values,m=a._index,u=a._ptr,g=a._size,h=a._datatype;if(l.length!==g.length)throw new DimensionError(l.length,g.length);if(l[0]!==g[0]||l[1]!==g[1])throw new RangeError("Dimension mismatch. Matrix A ("+l+") must match Matrix B ("+g+")");var y=l[0],x=l[1],_=n,f=0,v=r,b;"string"==typeof d&&d===h&&(b=d,_=t.find(n,[b,b]),f=t.convert(0,b),v=t.find(r,[b,b]));var M=o&&c?[]:void 0,S=[],N=[],z=M?[]:void 0,E=M?[]:void 0,C=[],A=[],I,D,P,O;for(D=0;D<x;D++){N[D]=S.length;var w=D+1;for(P=p[D],O=p[D+1];P<O;P++)I=s[P],S.push(I),C[I]=w,z&&(z[I]=o[P]);for(P=u[D],O=u[D+1];P<O;P++)I=m[P],C[I]!==w&&S.push(I),A[I]=w,E&&(E[I]=c[P]);if(M)for(P=N[D];P<S.length;){I=S[P];var T=C[I],F=A[I];if(T===w||F===w){var B=T===w?z[I]:f,L=F===w?E[I]:f,R=v(B,L);_(R,f)?S.splice(P,1):(M.push(R),P++)}}}return N[x]=S.length,e.createSparseMatrix({values:M,index:S,ptr:N,size:[y,x],datatype:b})}}),name$l="algorithm12",dependencies$m=["typed","DenseMatrix"],createAlgorithm12=factory(name$l,dependencies$m,e=>{var{typed:t,DenseMatrix:n}=e;return function(e,a,o,s){var p=e._values,l=e._index,d=e._ptr,c=e._size,m=e._datatype;if(!p)throw new Error("Cannot perform operation on Pattern Sparse Matrix and Scalar value");var u=c[0],g=c[1],h=o,y;"string"==typeof m&&(y=m,a=t.convert(a,y),h=t.find(o,[y,y]));for(var _=[],f=[],x=[],v=0,M;v<g;v++){M=v+1;for(var S=d[v],N=d[v+1],z=S,E;z<N;z++)E=l[z],f[E]=p[z],x[E]=M;for(var C=0;C<u;C++)0==v&&(_[C]=[]),_[C][v]=x[C]===M?s?h(a,f[C]):h(f[C],a):s?h(a,0):h(0,a)}return new n({data:_,size:[u,g],datatype:y})}}),name$m="multiplyScalar",dependencies$n=["typed"],createMultiplyScalar=factory(name$m,dependencies$n,e=>{var{typed:t}=e;return t("multiplyScalar",{"number, number":multiplyNumber,"Complex, Complex":function(e,t){return e.mul(t)},"BigNumber, BigNumber":function(e,t){return e.times(t)},"Fraction, Fraction":function(e,t){return e.mul(t)},"number | Fraction | BigNumber | Complex, Unit":function(e,t){var n=t.clone();return n.value=null===n.value?n._normalize(e):this(n.value,e),n},"Unit, number | Fraction | BigNumber | Complex":function(e,t){var n=e.clone();return n.value=null===n.value?n._normalize(t):this(n.value,t),n},"Unit, Unit":function(e,t){return e.multiply(t)}})}),name$n="multiply",dependencies$o=["typed","matrix","addScalar","multiplyScalar","equalScalar","dot"],createMultiply=factory(name$n,dependencies$o,e=>{function t(e,t){switch(e.length){case 1:switch(t.length){case 1:if(e[0]!==t[0])throw new RangeError("Dimension mismatch in multiplication. Vectors must have the same length");break;case 2:if(e[0]!==t[0])throw new RangeError("Dimension mismatch in multiplication. Vector length ("+e[0]+") must match Matrix rows ("+t[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+t.length+" dimensions)");}break;case 2:switch(t.length){case 1:if(e[1]!==t[0])throw new RangeError("Dimension mismatch in multiplication. Matrix columns ("+e[1]+") must match Vector length ("+t[0]+")");break;case 2:if(e[1]!==t[0])throw new RangeError("Dimension mismatch in multiplication. Matrix A columns ("+e[1]+") must match Matrix B rows ("+t[0]+")");break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix B has "+t.length+" dimensions)");}break;default:throw new Error("Can only multiply a 1 or 2 dimensional matrix (Matrix A has "+e.length+" dimensions)");}}function n(e,t,i){if(0===i)throw new Error("Cannot multiply two empty vectors");return u(e,t)}function i(e,t){if("dense"!==t.storage())throw new Error("Support for SparseMatrix not implemented");return r(e,t)}function r(e,t){var n=e._data,a=e._size,r=e._datatype,s=t._data,p=t._size,m=t._datatype,u=a[0],g=p[1],h=l,y=d,x;r&&m&&r===m&&"string"==typeof r&&(x=r,h=o.find(l,[x,x]),y=o.find(d,[x,x]));for(var _=[],c=0,f;c<g;c++){f=y(n[0],s[0][c]);for(var v=1;v<u;v++)f=h(f,y(n[v],s[v][c]));_[c]=f}return e.createDenseMatrix({data:_,size:[g],datatype:x})}var{typed:o,matrix:s,addScalar:l,multiplyScalar:d,equalScalar:m,dot:u}=e,g=createAlgorithm11({typed:o,equalScalar:m}),h=createAlgorithm14({typed:o}),_=o("_multiplyMatrixVector",{"DenseMatrix, any":function(e,t){var n=e._data,a=e._size,r=e._datatype,s=t._data,p=t._datatype,m=a[0],u=a[1],g=l,h=d,y;r&&p&&r===p&&"string"==typeof r&&(y=r,g=o.find(l,[y,y]),h=o.find(d,[y,y]));for(var x=[],c=0;c<m;c++){for(var _=n[c],f=h(_[0],s[0]),v=1;v<u;v++)f=g(f,h(_[v],s[v]));x[c]=f}return e.createDenseMatrix({data:x,size:[m],datatype:y})},"SparseMatrix, any":function(e,t){var n=e._values,i=e._index,a=e._ptr,r=e._datatype;if(!n)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var s=t._data,c=t._datatype,u=e._size[0],g=t._size[0],h=[],y=[],_=[],f=l,v=d,b=m,M=0,S;r&&c&&r===c&&"string"==typeof r&&(S=r,f=o.find(l,[S,S]),v=o.find(d,[S,S]),b=o.find(m,[S,S]),M=o.convert(0,S));var N=[],x=[];_[0]=0;for(var z=0,E;z<g;z++)if(E=s[z],!b(E,M))for(var C=a[z],A=a[z+1],I=C,k;I<A;I++)k=i[I],x[k]?N[k]=f(N[k],v(E,n[I])):(x[k]=!0,y.push(k),N[k]=v(E,n[I]));for(var D=y.length,j=0,P;j<D;j++)P=y[j],h[j]=N[P];return _[1]=y.length,e.createSparseMatrix({values:h,index:y,ptr:_,size:[u,1],datatype:S})}}),f=o("_multiplyMatrixMatrix",{"DenseMatrix, DenseMatrix":function(e,t){var n=e._data,a=e._size,r=e._datatype,s=t._data,p=t._size,m=t._datatype,u=a[0],g=a[1],h=p[1],y=l,_=d,f;r&&m&&r===m&&"string"==typeof r&&(f=r,y=o.find(l,[f,f]),_=o.find(d,[f,f]));for(var v=[],c=0,b;c<u;c++){b=n[c],v[c]=[];for(var M=0,S;M<h;M++){S=_(b[0],s[0][M]);for(var N=1;N<g;N++)S=y(S,_(b[N],s[N][M]));v[c][M]=S}}return e.createDenseMatrix({data:v,size:[u,h],datatype:f})},"DenseMatrix, SparseMatrix":function(e,t){var n=e._data,a=e._size,r=e._datatype,s=t._values,p=t._index,u=t._ptr,g=t._size,h=t._datatype;if(!s)throw new Error("Cannot multiply Dense Matrix times Pattern only Matrix");var y=a[0],x=g[1],_=l,f=d,v=m,b=0,M;r&&h&&r===h&&"string"==typeof r&&(M=r,_=o.find(l,[M,M]),f=o.find(d,[M,M]),v=o.find(m,[M,M]),b=o.convert(0,M));for(var S=[],N=[],z=[],E=t.createSparseMatrix({values:S,index:N,ptr:z,size:[y,x],datatype:M}),c=0;c<x;c++){z[c]=N.length;var C=u[c],A=u[c+1];if(A>C)for(var I=0,k=0;k<y;k++){for(var D=k+1,j=void 0,P=C,O;P<A;P++)O=p[P],I===D?j=_(j,f(n[k][O],s[P])):(j=f(n[k][O],s[P]),I=D);I!==D||v(j,b)||(N.push(k),S.push(j))}}return z[x]=N.length,E},"SparseMatrix, DenseMatrix":function(e,t){var n=e._values,i=e._index,a=e._ptr,r=e._datatype;if(!n)throw new Error("Cannot multiply Pattern only Matrix times Dense Matrix");var s=t._data,u=t._datatype,g=e._size[0],h=t._size[0],y=t._size[1],_=l,f=d,v=m,b=0,M;r&&u&&r===u&&"string"==typeof r&&(M=r,_=o.find(l,[M,M]),f=o.find(d,[M,M]),v=o.find(m,[M,M]),b=o.convert(0,M));for(var S=[],N=[],z=[],E=e.createSparseMatrix({values:S,index:N,ptr:z,size:[g,y],datatype:M}),c=[],x=[],C=0;C<y;C++){z[C]=N.length;for(var A=C+1,I=0,k;I<h;I++)if(k=s[I][C],!v(k,b))for(var D=a[I],j=a[I+1],P=D,O;P<j;P++)O=i[P],x[O]===A?c[O]=_(c[O],f(k,n[P])):(x[O]=A,N.push(O),c[O]=f(k,n[P]));for(var w=z[C],T=N.length,F=w,B;F<T;F++)B=N[F],S[F]=c[B]}return z[y]=N.length,E},"SparseMatrix, SparseMatrix":function(e,t){var n=e._values,i=e._index,a=e._ptr,r=e._datatype,s=t._values,m=t._index,u=t._ptr,g=t._datatype,h=e._size[0],y=t._size[1],_=n&&s,f=l,v=d,b;r&&g&&r===g&&"string"==typeof r&&(b=r,f=o.find(l,[b,b]),v=o.find(d,[b,b]));for(var M=_?[]:void 0,S=[],N=[],z=e.createSparseMatrix({values:M,index:S,ptr:N,size:[h,y],datatype:b}),c=_?[]:void 0,x=[],E=0,C,A,I,k,D,j,P,O;E<y;E++){N[E]=S.length;var w=E+1;for(D=u[E],j=u[E+1],k=D;k<j;k++)if(O=m[k],_)for(A=a[O],I=a[O+1],C=A;C<I;C++)P=i[C],x[P]===w?c[P]=f(c[P],v(s[k],n[C])):(x[P]=w,S.push(P),c[P]=v(s[k],n[C]));else for(A=a[O],I=a[O+1],C=A;C<I;C++)P=i[C],x[P]!==w&&(x[P]=w,S.push(P));if(_)for(var T=N[E],F=S.length,B=T,L;B<F;B++)L=S[B],M[B]=c[L]}return N[y]=S.length,z}});return o(name$n,extend({"Array, Array":function(e,n){t(arraySize(e),arraySize(n));var i=this(s(e),s(n));return isMatrix(i)?i.valueOf():i},"Matrix, Matrix":function(e,a){var r=e.size(),o=a.size();return t(r,o),1===r.length?1===o.length?n(e,a,r[0]):i(e,a):1===o.length?_(e,a):f(e,a)},"Matrix, Array":function(e,t){return this(e,s(t))},"Array, Matrix":function(e,t){return this(s(e,t.storage()),t)},"SparseMatrix, any":function(e,t){return g(e,t,d,!1)},"DenseMatrix, any":function(e,t){return h(e,t,d,!1)},"any, SparseMatrix":function(e,t){return g(t,e,d,!0)},"any, DenseMatrix":function(e,t){return h(t,e,d,!0)},"Array, any":function(e,t){return h(s(e),t,d,!1).valueOf()},"any, Array":function(e,t){return h(s(t),e,d,!0).valueOf()},"any, any":d,"any, any, ...any":function(e,t,n){for(var a=this(e,t),r=0;r<n.length;r++)a=this(a,n[r]);return a}},d.signatures))}),name$o="subtract",dependencies$p=["typed","matrix","equalScalar","addScalar","unaryMinus","DenseMatrix"],createSubtract=factory(name$o,dependencies$p,e=>{var{typed:t,matrix:n,equalScalar:i,addScalar:a,unaryMinus:r,DenseMatrix:o}=e,s=createAlgorithm01({typed:t}),p=createAlgorithm03({typed:t}),l=createAlgorithm05({typed:t,equalScalar:i}),d=createAlgorithm10({typed:t,DenseMatrix:o}),c=createAlgorithm13({typed:t}),m=createAlgorithm14({typed:t});return t(name$o,{"number, number":function(e,t){return e-t},"Complex, Complex":function(e,t){return e.sub(t)},"BigNumber, BigNumber":function(e,t){return e.minus(t)},"Fraction, Fraction":function(e,t){return e.sub(t)},"Unit, Unit":function(e,t){if(null===e.value)throw new Error("Parameter x contains a unit with undefined value");if(null===t.value)throw new Error("Parameter y contains a unit with undefined value");if(!e.equalBase(t))throw new Error("Units do not match");var n=e.clone();return n.value=this(n.value,t.value),n.fixPrefix=!1,n},"SparseMatrix, SparseMatrix":function(e,t){return checkEqualDimensions(e,t),l(e,t,this)},"SparseMatrix, DenseMatrix":function(e,t){return checkEqualDimensions(e,t),p(t,e,this,!0)},"DenseMatrix, SparseMatrix":function(e,t){return checkEqualDimensions(e,t),s(e,t,this,!1)},"DenseMatrix, DenseMatrix":function(e,t){return checkEqualDimensions(e,t),c(e,t,this)},"Array, Array":function(e,t){return this(n(e),n(t)).valueOf()},"Array, Matrix":function(e,t){return this(n(e),t)},"Matrix, Array":function(e,t){return this(e,n(t))},"SparseMatrix, any":function(e,t){return d(e,r(t),a)},"DenseMatrix, any":function(e,t){return m(e,t,this)},"any, SparseMatrix":function(e,t){return d(t,e,this,!0)},"any, DenseMatrix":function(e,t){return m(t,e,this,!0)},"Array, any":function(e,t){return m(n(e),t,this,!1).valueOf()},"any, Array":function(e,t){return m(n(t),e,this,!0).valueOf()}})});function checkEqualDimensions(e,t){var n=e.size(),i=t.size();if(n.length!==i.length)throw new DimensionError(n.length,i.length)}var name$p="algorithm07",dependencies$q=["typed","DenseMatrix"],createAlgorithm07=factory("algorithm07",dependencies$q,e=>{function t(e,t,n,a,r){for(var o=e._values,s=e._index,p=e._ptr,l=p[t],d=p[t+1],c;l<d;l++)c=s[l],n[c]=r,a[c]=o[l]}var{typed:n,DenseMatrix:r}=e;return function(e,a,o){var s=e._size,p=e._datatype,l=a._size,d=a._datatype;if(s.length!==l.length)throw new DimensionError(s.length,l.length);if(s[0]!==l[0]||s[1]!==l[1])throw new RangeError("Dimension mismatch. Matrix A ("+s+") must match Matrix B ("+l+")");var c=s[0],m=s[1],u=0,g=o,h;"string"==typeof p&&p===d&&(h=p,u=n.convert(0,h),g=n.find(o,[h,h]));var y=[],x,_;for(x=0;x<c;x++)y[x]=[];var f=[],v=[],b=[],M=[];for(_=0;_<m;_++){var S=_+1;for(t(e,_,b,f,S),t(a,_,M,v,S),x=0;x<c;x++){var N=b[x]===S?f[x]:u,z=M[x]===S?v[x]:u;y[x][_]=g(N,z)}}return new r({data:y,size:[c,m],datatype:h})}}),name$q="conj",dependencies$r=["typed"],createConj=factory(name$q,dependencies$r,e=>{var{typed:t}=e;return t(name$q,{number:function(e){return e},BigNumber:function(e){return e},Complex:function(e){return e.conjugate()},"Array | Matrix":function(e){return deepMap(e,this)}})}),name$r="identity",dependencies$s=["typed","config","matrix","BigNumber","DenseMatrix","SparseMatrix"],createIdentity=factory(name$r,dependencies$s,e=>{function t(e,t){switch(e.length){case 0:return t?r(t):[];case 1:return n(e[0],e[0],t);case 2:return n(e[0],e[1],t);default:throw new Error("Vector containing two values expected");}}function n(e,t,n){var i=isBigNumber(e)||isBigNumber(t)?o:null;if(isBigNumber(e)&&(e=e.toNumber()),isBigNumber(t)&&(t=t.toNumber()),!isInteger(e)||1>e)throw new Error("Parameters in function identity must be positive integers");if(!isInteger(t)||1>t)throw new Error("Parameters in function identity must be positive integers");var a=i?new o(1):1,r=i?new i(0):0,l=[e,t];if(n){if("sparse"===n)return p.diagonal(l,a,0,r);if("dense"===n)return s.diagonal(l,a,0,r);throw new TypeError("Unknown matrix type \"".concat(n,"\""))}for(var c=resize([],l,r),m=e<t?e:t,u=0;u<m;u++)c[u][u]=a;return c}var{typed:i,config:a,matrix:r,BigNumber:o,DenseMatrix:s,SparseMatrix:p}=e;return i(name$r,{"":function(){return"Matrix"===a.matrix?r([]):[]},string:function(e){return r(e)},"number | BigNumber":function(e){return n(e,e,"Matrix"===a.matrix?"dense":void 0)},"number | BigNumber, string":function(e,t){return n(e,e,t)},"number | BigNumber, number | BigNumber":function(e,t){return n(e,t,"Matrix"===a.matrix?"dense":void 0)},"number | BigNumber, number | BigNumber, string":function(e,t,i){return n(e,t,i)},Array:function(e){return t(e)},"Array, string":function(e,n){return t(e,n)},Matrix:function(e){return t(e.valueOf(),e.storage())},"Matrix, string":function(e,n){return t(e.valueOf(),n)}})}),name$s="ones",dependencies$t=["typed","config","matrix","BigNumber"],createOnes=factory(name$s,dependencies$t,e=>{function t(e,t){var a=n(e),r=a?new s(1):1;if(i(e),t){var p=o(t);return 0<e.length?p.resize(e,r):p}var l=[];return 0<e.length?resize(l,e,r):l}function n(e){var t=!1;return e.forEach(function(e,n,i){isBigNumber(e)&&(t=!0,i[n]=e.toNumber())}),t}function i(e){e.forEach(function(e){if("number"!=typeof e||!isInteger(e)||0>e)throw new Error("Parameters in function ones must be positive integers")})}var{typed:a,config:r,matrix:o,BigNumber:s}=e;return a("ones",{"":function(){return"Array"===r.matrix?t([]):t([],"default")},"...number | BigNumber | string":function(e){var n=e[e.length-1];if("string"==typeof n){var i=e.pop();return t(e,i)}return"Array"===r.matrix?t(e):t(e,"default")},Array:t,Matrix:function(e){var n=e.storage();return t(e.valueOf(),n)},"Array | Matrix, string":function(e,n){return t(e.valueOf(),n)}})});function noBignumber(){throw new Error("No \"bignumber\" implementation available")}function noFraction(){throw new Error("No \"fraction\" implementation available")}function noMatrix(){throw new Error("No \"matrix\" implementation available")}var name$t="size",dependencies$u=["typed","config","?matrix"],createSize=factory("size",dependencies$u,e=>{var{typed:t,config:n,matrix:i}=e;return t(name$t,{Matrix:function(e){return e.create(e.size())},Array:arraySize,string:function(e){return"Array"===n.matrix?[e.length]:i([e.length])},"number | Complex | BigNumber | Unit | boolean | null":function(){return"Array"===n.matrix?[]:i?i([]):noMatrix()}})}),name$u="numeric",dependencies$v=["number","?bignumber","?fraction"],createNumeric=factory(name$u,dependencies$v,e=>{var{number:t,bignumber:n,fraction:i}=e,a={string:!0,number:!0,BigNumber:!0,Fraction:!0},r={number:e=>t(e),BigNumber:n?e=>n(e):noBignumber,Fraction:i?e=>i(e):noFraction};return function(e,t){var n=typeOf(e);if(!(n in a))throw new TypeError("Cannot convert "+e+" of type \""+n+"\"; valid input types are "+Object.keys(a).join(", "));if(!(t in r))throw new TypeError("Cannot convert "+e+" to type \""+t+"\"; valid output types are "+Object.keys(r).join(", "));return t===n?e:r[t](e)}}),name$v="divideScalar",dependencies$w=["typed","numeric"],createDivideScalar=factory(name$v,dependencies$w,e=>{var{typed:t,numeric:n}=e;return t(name$v,{"number, number":function(e,t){return e/t},"Complex, Complex":function(e,t){return e.div(t)},"BigNumber, BigNumber":function(e,t){return e.div(t)},"Fraction, Fraction":function(e,t){return e.div(t)},"Unit, number | Fraction | BigNumber":function(e,t){var i=e.clone(),a=n(1,typeOf(t));return i.value=this(null===i.value?i._normalize(a):i.value,t),i},"number | Fraction | BigNumber, Unit":function(e,t){var i=t.clone();i=i.pow(-1);var a=n(1,typeOf(e));return i.value=this(e,null===t.value?t._normalize(a):t.value),i},"Unit, Unit":function(e,t){return e.divide(t)}})}),name$w="smaller",dependencies$x=["typed","config","matrix","DenseMatrix"],createSmaller=factory(name$w,dependencies$x,e=>{var{typed:t,config:n,matrix:i,DenseMatrix:a}=e,r=createAlgorithm03({typed:t}),o=createAlgorithm07({typed:t,DenseMatrix:a}),s=createAlgorithm12({typed:t,DenseMatrix:a}),p=createAlgorithm13({typed:t}),l=createAlgorithm14({typed:t});return t(name$w,{"boolean, boolean":function(e,t){return e<t},"number, number":function(e,t){return e<t&&!nearlyEqual(e,t,n.epsilon)},"BigNumber, BigNumber":function(e,t){return e.lt(t)&&!nearlyEqual$1(e,t,n.epsilon)},"Fraction, Fraction":function(e,t){return-1===e.compare(t)},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(e,t){if(!e.equalBase(t))throw new Error("Cannot compare units with different base");return this(e.value,t.value)},"SparseMatrix, SparseMatrix":function(e,t){return o(e,t,this)},"SparseMatrix, DenseMatrix":function(e,t){return r(t,e,this,!0)},"DenseMatrix, SparseMatrix":function(e,t){return r(e,t,this,!1)},"DenseMatrix, DenseMatrix":function(e,t){return p(e,t,this)},"Array, Array":function(e,t){return this(i(e),i(t)).valueOf()},"Array, Matrix":function(e,t){return this(i(e),t)},"Matrix, Array":function(e,t){return this(e,i(t))},"SparseMatrix, any":function(e,t){return s(e,t,this,!1)},"DenseMatrix, any":function(e,t){return l(e,t,this,!1)},"any, SparseMatrix":function(e,t){return s(t,e,this,!0)},"any, DenseMatrix":function(e,t){return l(t,e,this,!0)},"Array, any":function(e,t){return l(i(e),t,this,!1).valueOf()},"any, Array":function(e,t){return l(i(t),e,this,!0).valueOf()}})}),name$x="larger",dependencies$y=["typed","config","matrix","DenseMatrix"],createLarger=factory(name$x,dependencies$y,e=>{var{typed:t,config:n,matrix:i,DenseMatrix:a}=e,r=createAlgorithm03({typed:t}),o=createAlgorithm07({typed:t,DenseMatrix:a}),s=createAlgorithm12({typed:t,DenseMatrix:a}),p=createAlgorithm13({typed:t}),l=createAlgorithm14({typed:t});return t(name$x,{"boolean, boolean":function(e,t){return e>t},"number, number":function(e,t){return e>t&&!nearlyEqual(e,t,n.epsilon)},"BigNumber, BigNumber":function(e,t){return e.gt(t)&&!nearlyEqual$1(e,t,n.epsilon)},"Fraction, Fraction":function(e,t){return 1===e.compare(t)},"Complex, Complex":function(){throw new TypeError("No ordering relation is defined for complex numbers")},"Unit, Unit":function(e,t){if(!e.equalBase(t))throw new Error("Cannot compare units with different base");return this(e.value,t.value)},"SparseMatrix, SparseMatrix":function(e,t){return o(e,t,this)},"SparseMatrix, DenseMatrix":function(e,t){return r(t,e,this,!0)},"DenseMatrix, SparseMatrix":function(e,t){return r(e,t,this,!1)},"DenseMatrix, DenseMatrix":function(e,t){return p(e,t,this)},"Array, Array":function(e,t){return this(i(e),i(t)).valueOf()},"Array, Matrix":function(e,t){return this(i(e),t)},"Matrix, Array":function(e,t){return this(e,i(t))},"SparseMatrix, any":function(e,t){return s(e,t,this,!1)},"DenseMatrix, any":function(e,t){return l(e,t,this,!1)},"any, SparseMatrix":function(e,t){return s(t,e,this,!0)},"any, DenseMatrix":function(e,t){return l(t,e,this,!0)},"Array, any":function(e,t){return l(i(e),t,this,!1).valueOf()},"any, Array":function(e,t){return l(i(t),e,this,!0).valueOf()}})}),name$y="FibonacciHeap",dependencies$z=["smaller","larger"],createFibonacciHeapClass=factory(name$y,dependencies$z,e=>{var o=Math.log;function t(){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");this._minimum=null,this._size=0}function n(e,t,n){t.key=n;var r=t.parent;return r&&s(t.key,r.key)&&(i(e,t,r),a(e,r)),s(t.key,e.key)&&(e=t),e}function i(e,t,n){t.left.right=t.right,t.right.left=t.left,n.degree--,n.child===t&&(n.child=t.right),0===n.degree&&(n.child=null),t.left=e,t.right=e.right,e.right=t,t.right.left=t,t.parent=null,t.mark=!1}function a(e,t){var n=t.parent;n&&(t.mark?(i(e,t,n),a(n)):t.mark=!0)}function r(e,t){var n=Math.floor(o(t)*l)+1,a=Array(n),r=0,m=e;if(m)for(r++,m=m.right;m!==e;)r++,m=m.right;for(var u;0<r;){for(var g=m.degree,h=m.right;u=a[g],!!u;){if(p(m.key,u.key)){var _=u;u=m,m=_}c(u,m),a[g]=null,g++}a[g]=m,m=h,r--}e=null;for(var f=0;f<n;f++)(u=a[f],!!u)&&(e?(u.left.right=u.right,u.right.left=u.left,u.left=e,u.right=e.right,e.right=u,u.right.left=u,s(u.key,e.key)&&(e=u)):e=u);return e}var{smaller:s,larger:p}=e,l=1/o((1+Math.sqrt(5))/2);t.prototype.type="FibonacciHeap",t.prototype.isFibonacciHeap=!0,t.prototype.insert=function(e,t){var n={key:e,value:t,degree:0};if(this._minimum){var i=this._minimum;n.left=i,n.right=i.right,i.right=n,n.right.left=n,s(e,i.key)&&(this._minimum=n)}else n.left=n,n.right=n,this._minimum=n;return this._size++,n},t.prototype.size=function(){return this._size},t.prototype.clear=function(){this._minimum=null,this._size=0},t.prototype.isEmpty=function(){return 0===this._size},t.prototype.extractMinimum=function(){var e=this._minimum;if(null===e)return e;for(var t=this._minimum,n=e.degree,i=e.child,a;0<n;)a=i.right,i.left.right=i.right,i.right.left=i.left,i.left=t,i.right=t.right,t.right=i,i.right.left=i,i.parent=null,i=a,n--;return e.left.right=e.right,e.right.left=e.left,e===e.right?t=null:(t=e.right,t=r(t,this._size)),this._size--,this._minimum=t,e},t.prototype.remove=function(e){this._minimum=n(this._minimum,e,-1),this.extractMinimum()};var c=function(e,t){e.left.right=e.right,e.right.left=e.left,e.parent=t,t.child?(e.left=t.child,e.right=t.child.right,t.child.right=e,e.right.left=e):(t.child=e,e.right=e,e.left=e),t.degree++,e.mark=!1};return t},{isClass:!0}),name$z="Spa",dependencies$A=["addScalar","equalScalar","FibonacciHeap"],createSpaClass=factory(name$z,dependencies$A,e=>{function t(){if(!(this instanceof t))throw new SyntaxError("Constructor must be called with the new operator");this._values=[],this._heap=new a}var{addScalar:n,equalScalar:i,FibonacciHeap:a}=e;return t.prototype.type="Spa",t.prototype.isSpa=!0,t.prototype.set=function(e,t){if(!this._values[e]){var n=this._heap.insert(e,t);this._values[e]=n}else this._values[e].value=t},t.prototype.get=function(e){var t=this._values[e];return t?t.value:0},t.prototype.accumulate=function(e,t){var i=this._values[e];i?i.value=n(i.value,t):(i=this._heap.insert(e,t),this._values[e]=i)},t.prototype.forEach=function(e,t,a){var r=this._heap,o=this._values,s=[],p=r.extractMinimum();for(p&&s.push(p);p&&p.key<=t;)p.key>=e&&!i(p.value,0)&&a(p.key,p.value,this),p=r.extractMinimum(),p&&s.push(p);for(var l=0,d;l<s.length;l++)d=s[l],p=r.insert(d.key,d.value),o[p.key]=p},t.prototype.swap=function(e,t){var n=this._values[e],i=this._values[t];if(!n&&i)n=this._heap.insert(e,i.value),this._heap.remove(i),this._values[e]=n,this._values[t]=void 0;else if(n&&!i)i=this._heap.insert(t,n.value),this._heap.remove(n),this._values[t]=i,this._values[e]=void 0;else if(n&&i){var a=n.value;n.value=i.value,i.value=a}},t},{isClass:!0}),name$A="dot",dependencies$B=["typed","addScalar","multiplyScalar","conj","size"],createDot=factory(name$A,dependencies$B,e=>{function t(e,t){var i=n(e),a=n(t),r,o;if(1===i.length)r=i[0];else if(2===i.length&&1===i[1])r=i[0];else throw new RangeError("Expected a column vector, instead got a matrix of size ("+i.join(", ")+")");if(1===a.length)o=a[0];else if(2===a.length&&1===a[1])o=a[0];else throw new RangeError("Expected a column vector, instead got a matrix of size ("+a.join(", ")+")");if(r!==o)throw new RangeError("Vectors must have equal length ("+r+" != "+o+")");if(0===r)throw new RangeError("Cannot calculate the dot product of empty vectors");return r}function n(e){return isMatrix(e)?e.size():p(e)}var{typed:i,addScalar:r,multiplyScalar:o,conj:s,size:p}=e;return i(name$A,{"Array | DenseMatrix, Array | DenseMatrix":function(e,a){var p=t(e,a),l=isMatrix(e)?e._data:e,d=isMatrix(e)?e._datatype:void 0,m=isMatrix(a)?a._data:a,u=isMatrix(a)?a._datatype:void 0,g=2===n(e).length,h=2===n(a).length,y=r,x=o;if(d&&u&&d===u&&"string"==typeof d){var _=d;y=i.find(r,[_,_]),x=i.find(o,[_,_])}if(!g&&!h){for(var f=x(s(l[0]),m[0]),v=1;v<p;v++)f=y(f,x(s(l[v]),m[v]));return f}if(!g&&h){for(var b=x(s(l[0]),m[0][0]),M=1;M<p;M++)b=y(b,x(s(l[M]),m[M][0]));return b}if(g&&!h){for(var S=x(s(l[0][0]),m[0]),N=1;N<p;N++)S=y(S,x(s(l[N][0]),m[N]));return S}if(g&&h){for(var z=x(s(l[0][0]),m[0][0]),E=1;E<p;E++)z=y(z,x(s(l[E][0]),m[E][0]));return z}},"SparseMatrix, SparseMatrix":function(e,n){t(e,n);for(var a=e._index,s=e._values,p=n._index,l=n._values,d=0,m=0,u=0;m<a.length&&u<p.length;){var g=a[m],h=p[u];if(g<h){m++;continue}if(g>h){u++;continue}g===h&&(d=r(d,o(s[m],l[u])),m++,u++)}return d}})}),name$B="lup",dependencies$C=["typed","matrix","abs","addScalar","divideScalar","multiplyScalar","subtract","larger","equalScalar","unaryMinus","DenseMatrix","SparseMatrix","Spa"],createLup=factory(name$B,dependencies$C,e=>{var a=Math.min;function t(e){var t=e._size[0],r=e._size[1],o=a(t,r),g=clone(e._data),y=[],x=[t,o],_=[],f=[o,r],b=[],M,S,N;for(M=0;M<t;M++)b[M]=M;for(S=0;S<r;S++){if(0<S)for(M=0;M<t;M++){var z=a(M,S),E=0;for(N=0;N<z;N++)E=p(E,d(g[M][N],g[N][S]));g[M][S]=c(g[M][S],E)}var C=S,A=0,I=0;for(M=S;M<t;M++){var D=g[M][S],v=s(D);m(v,A)&&(C=M,A=v,I=D)}if(S!==C&&(b[S]=b[C],h._swapRows(S,C,g)),S<t)for(M=S+1;M<t;M++){var P=g[M][S];u(P,0)||(g[M][S]=l(g[M][S],I))}}for(S=0;S<r;S++)for(M=0;M<t;M++){if(0===S&&(M<r&&(_[M]=[]),y[M]=[]),M<S){M<r&&(_[M][S]=g[M][S]),S<t&&(y[M][S]=0);continue}if(M===S){M<r&&(_[M][S]=g[M][S]),S<t&&(y[M][S]=1);continue}M<r&&(_[M][S]=0),S<t&&(y[M][S]=g[M][S])}var O=new h({data:y,size:x}),w=new h({data:_,size:f}),T=[];for(M=0,o=b.length;M<o;M++)T[b[M]]=M;return{L:O,U:w,p:T,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}}function n(e){var t=e._size[0],r=e._size[1],o=a(t,r),n=e._values,p=e._index,c=e._ptr,h=[],_=[],f=[],v=[t,o],b=[],M=[],S=[],N=[o,r],z=[],E=[],C,A,I;for(C=0;C<t;C++)z[C]=C,E[C]=C;var D=function(e,t){var n=E[e],i=E[t];z[n]=t,z[i]=e,E[e]=i,E[t]=n},P=function(){var e=new x;A<t&&(f.push(h.length),h.push(1),_.push(A)),S.push(b.length);var i=c[A],a=c[A+1];for(I=i;I<a;I++)C=p[I],e.set(z[C],n[I]);0<A&&e.forEach(0,A-1,function(t,n){y._forEachRow(t,h,_,f,function(a,i){a>t&&e.accumulate(a,g(d(i,n)))})});var r=A,o=e.get(A),E=s(o);e.forEach(A+1,t-1,function(e,t){var n=s(t);m(n,E)&&(r=e,E=n,o=t)}),A!==r&&(y._swapRows(A,r,v[1],h,_,f),y._swapRows(A,r,N[1],b,M,S),e.swap(A,r),D(A,r)),e.forEach(0,t-1,function(e,t){e<=A?(b.push(t),M.push(e)):(t=l(t,o),!u(t,0)&&(h.push(t),_.push(e)))})};for(A=0;A<r;A++)P();return S.push(b.length),f.push(h.length),{L:new y({values:h,index:_,ptr:f,size:v}),U:new y({values:b,index:M,ptr:S,size:N}),p:z,toString:function(){return"L: "+this.L.toString()+"\nU: "+this.U.toString()+"\nP: "+this.p}}}var{typed:r,matrix:o,abs:s,addScalar:p,divideScalar:l,multiplyScalar:d,subtract:c,larger:m,equalScalar:u,unaryMinus:g,DenseMatrix:h,SparseMatrix:y,Spa:x}=e;return r(name$B,{DenseMatrix:function(e){return t(e)},SparseMatrix:function(e){return n(e)},Array:function(e){var n=o(e),i=t(n);return{L:i.L.valueOf(),U:i.U.valueOf(),p:i.p}}})}),name$C="det",dependencies$D=["typed","matrix","subtract","multiply","unaryMinus","lup"],createDet=factory(name$C,dependencies$D,e=>{function t(e,t){if(1===t)return clone(e[0][0]);if(2===t)return a(r(e[0][0],e[1][1]),r(e[1][0],e[0][1]));for(var n=s(e),p=n.U[0][0],l=1;l<t;l++)p=r(p,n.U[l][l]);for(var d=0,c=0,m=[];;){for(;m[c];)c++;if(c>=t)break;for(var u=c,g=0;!m[n.p[u]];)m[n.p[u]]=!0,u=n.p[u],g++;0==g%2&&d++}return 0==d%2?p:o(p)}var{typed:n,matrix:i,subtract:a,multiply:r,unaryMinus:o,lup:s}=e;return n(name$C,{any:function(e){return clone(e)},"Array | Matrix":function(e){var n;switch(isMatrix(e)?n=e.size():Array.isArray(e)?(e=i(e),n=e.size()):n=[],n.length){case 0:return clone(e);case 1:if(1===n[0])return clone(e.valueOf()[0]);throw new RangeError("Matrix must be square (size: "+format$2(n)+")");case 2:{var a=n[0],r=n[1];if(a===r)return t(e.clone().valueOf(),a);throw new RangeError("Matrix must be square (size: "+format$2(n)+")")}default:throw new RangeError("Matrix must be two dimensional (size: "+format$2(n)+")");}}})}),name$D="inv",dependencies$E=["typed","matrix","divideScalar","addScalar","multiply","unaryMinus","det","identity","abs"],createInv=factory(name$D,dependencies$E,e=>{function t(e,t,n){var i,u,g,h,y;if(1===t){if(h=e[0][0],0===h)throw Error("Cannot calculate inverse, determinant is zero");return[[a(1,h)]]}if(2===t){var x=l(e);if(0===x)throw Error("Cannot calculate inverse, determinant is zero");return[[a(e[1][1],x),a(p(e[0][1]),x)],[a(p(e[1][0]),x),a(e[0][0],x)]]}var _=e.concat();for(i=0;i<t;i++)_[i]=_[i].concat();for(var v=d(t).valueOf(),b=0;b<n;b++){var M=m(_[b][b]),S=b;for(i=b+1;i<t;)m(_[i][b])>M&&(M=m(_[i][b]),S=i),i++;if(0===M)throw Error("Cannot calculate inverse, determinant is zero");i=S,i!==b&&(y=_[b],_[b]=_[i],_[i]=y,y=v[b],v[b]=v[i],v[i]=y);var N=_[b],z=v[b];for(i=0;i<t;i++){var E=_[i],C=v[i];if(i===b){for(g=N[b],u=b;u<n;u++)E[u]=a(E[u],g);for(u=0;u<n;u++)C[u]=a(C[u],g)}else if(0!==E[b]){for(g=a(p(E[b]),N[b]),u=b;u<n;u++)E[u]=r(E[u],o(g,N[u]));for(u=0;u<n;u++)C[u]=r(C[u],o(g,z[u]))}}}return v}var{typed:n,matrix:i,divideScalar:a,addScalar:r,multiply:o,unaryMinus:p,det:l,identity:d,abs:m}=e;return n(name$D,{"Array | Matrix":function(e){var n=isMatrix(e)?e.size():arraySize(e);switch(n.length){case 1:if(1===n[0])return isMatrix(e)?i([a(1,e.valueOf()[0])]):[a(1,e[0])];throw new RangeError("Matrix must be square (size: "+format$2(n)+")");case 2:{var r=n[0],o=n[1];if(r===o)return isMatrix(e)?i(t(e.valueOf(),r,o),e.storage()):t(e,r,o);throw new RangeError("Matrix must be square (size: "+format$2(n)+")")}default:throw new RangeError("Matrix must be two dimensional (size: "+format$2(n)+")");}},any:function(e){return a(1,e)}})}),Complex$1=createComplexClass({}),BigNumber=createBigNumberClass({config}),Matrix=createMatrixClass({}),Fraction$1=createFractionClass({}),DenseMatrix=createDenseMatrixClass({Matrix}),typed=createTyped({BigNumber,Complex:Complex$1,DenseMatrix,Fraction:Fraction$1}),equalScalar=createEqualScalar({config,typed}),number=createNumber({typed}),multiplyScalar=createMultiplyScalar({typed}),fraction$1=createFraction({Fraction:Fraction$1,typed}),unaryMinus=createUnaryMinus({typed}),addScalar=createAddScalar({typed}),conj=createConj({typed}),SparseMatrix=createSparseMatrixClass({Matrix,equalScalar,typed}),matrix=createMatrix({DenseMatrix,Matrix,SparseMatrix,typed}),identity=createIdentity({BigNumber,DenseMatrix,SparseMatrix,config,matrix,typed}),ones=createOnes({BigNumber,config,matrix,typed}),size=createSize({matrix,config,typed}),smaller=createSmaller({DenseMatrix,config,matrix,typed}),larger=createLarger({DenseMatrix,config,matrix,typed}),FibonacciHeap=createFibonacciHeapClass({larger,smaller}),dot=createDot({addScalar,conj,multiplyScalar,size,typed}),abs$1=createAbs({typed}),multiply=createMultiply({addScalar,dot,equalScalar,matrix,multiplyScalar,typed}),bignumber=createBignumber({BigNumber,typed}),numeric=createNumeric({bignumber,fraction:fraction$1,number}),subtract=createSubtract({DenseMatrix,addScalar,equalScalar,matrix,typed,unaryMinus}),divideScalar=createDivideScalar({numeric,typed}),Spa=createSpaClass({FibonacciHeap,addScalar,equalScalar}),lup=createLup({DenseMatrix,Spa,SparseMatrix,abs:abs$1,addScalar,divideScalar,equalScalar,larger,matrix,multiplyScalar,subtract,typed,unaryMinus}),det=createDet({lup,matrix,multiply,subtract,typed,unaryMinus}),inv=createInv({abs:abs$1,addScalar,det,divideScalar,identity,matrix,multiply,typed,unaryMinus});function getOffsetPosition(e,t,n){function i(e){for(var t=e,n=0,i=0;null!==t;)n+=t.offsetTop,i+=t.offsetLeft,t=t.offsetParent;return{top:n,left:i}}function a(e){var t=window.getComputedStyle(e),n=t.transform||"",i=t.transformOrigin||"",a={x:0,y:0},r=ones([3,3]);if("none"!==n){var o=i.split(" ");a.x=parseInt(o[0]),a.y=parseInt(o[1]);var s=n.match(/\(([^)]*)\)/)[1],p=s.split(","),l=[];p.forEach(function(e){l.push(parseFloat(e.trim()))}),l=[[l[0],l[2],l[4]],[l[1],l[3],l[5]],[0,0,1]],r=inv(l)}else r=[[1,0,0],[0,1,0],[0,0,1]];return{matrix:r,origin:a}}function r(n){return n.forEach(function(n){var i=n,a=i.temp,r=i.origin,o=i.vertex,s=o.left,p=o.top;e=e-s-r.x,t=t-p-r.y;var l=multiply(a,[e,t,1]);e=l[0]+r.x,t=l[1]+r.y}),{x:e,y:t}}var o=[];if(n instanceof Node)for(var s=n;null!==s&&1===s.nodeType;){var p=i(s),l=p.left,d=p.top,c=a(s),m=c.matrix,u=c.origin;0<o.length&&(o[0].vertex.left-=l,o[0].vertex.top-=d),o.unshift({temp:m,origin:u,vertex:{left:l,top:d}}),s=s.parentNode}else n instanceof Array&&(o=n);var g=r(o);return{x:g.x,y:g.y,data:o}}function getScroll(e){for(var t=0,n=0,i=e.parentElement;null!==i;){if(t+=i.scrollTop,n+=i.scrollLeft,"fixed"===getComputedStyle(i).position)return{parentScrollTop:t,parentScrollLeft:n};i=i.parentElement}return{parentScrollTop:t,parentScrollLeft:n}}var DrawingBoard=function(){var t=Math.floor,n=Math.PI,i=Math.ceil,a=Math.abs;function e(t,n){var i=this;if(this._handlePointerStart=function(t){"empty"===i.penMode||("paint"===i.penMode&&i._handlePaintStart(t),"drag"===i.penMode&&i._handleDragStart(t),i._bindCurInteractiveModeEvents("move"),i._bindCurInteractiveModeEvents("end"),i._bindCurInteractiveModeEvents("leave"))},this._handlePointerMove=function(t){"empty"===i.penMode||("paint"===i.penMode&&i._handlePaintMove(t),"drag"===i.penMode&&i._handleDragMove(t))},this._handlePointerEnd=function(){"empty"===i.penMode||("paint"===i.penMode&&i._handlePaintEnd(),"drag"===i.penMode&&i._handleDragEnd(),i._cleanCurInteractiveModeEvents({action:"move"}),i._cleanCurInteractiveModeEvents({action:"end"}),i._cleanCurInteractiveModeEvents({action:"leave"}))},this._handlePointerLeave=function(){(i.isPainting||i.isDraging)&&i._handlePointerEnd()},this._handlePointerCancel=function(){(i.isPainting||i.isDraging)&&i._handlePointerEnd()},!t)throw new Error(MSG_CONTAINER_MISS_SELECTOR);this.container=this._getContainer(t),this.originalOptions=n,this.options=__assign(__assign({},e._defaultOptions),n);var a=this.options,r=a.size,o=a.className,s=a.manualMount,p=a.maxRevokeSteps,l=a.interactiveMode,d=a.penColor,c=a.penWidth,m=a.bgImgURL,u=a.bgImgRotate,g=a.bgColor,h=a.onRevokeStackChange,y=a.onPaintEnd,x=a.penMode,_=a.minScale,f=a.maxScale,v=a.initialScale,b=a.scaleTransition,M=a.scaleStep,S=__read(r||[],2),N=S[0],z=S[1];this.width=e.DEFAULT_WIDTH,this.height=e.DEFAULT_HEIGHT,this.setSize([null==N?e.DEFAULT_WIDTH:N,null==z?e.DEFAULT_HEIGHT:z]),this.manualMount=!!s,this.revokeStack=[],this.MAX_REVOKE_STEPS=this._getLawfulMaxRevokeSteps(+p),this.isPainting=!1,this.lastPaintPoint=null,this.isDraging=!1,this.lastDragPoint=null,this.dragTransformX=0,this.dragTransformY=0,this.penMode=this._getPenMode(x),this.interactiveMode=this._getInteractiveMode(l),this.eventList=this._makeEventList(),this.penColor=this._getPenColor(d),this.penWidth=this._getPenWidth(c),this.className=this._getClassName(o),this.bgImgURL=m||"",this.bgColor=g||"",this.bgImgRotate=this._getLawfulRotateAngle(u),this._bgImgObject=null,this.originalSize=[],m&&this._getImgAndDraw(m),this.onRevokeStackChange=h,this.onPaintEnd=y,this.paintCount=0,this.scaleTransition=!!b,this.scaleStep="number"!=typeof M||isNaN(M)?.1:M,this.minScale=this._getLawfulMinScale(_),this.maxScale=this._getLawfulMaxScale(f),this.initialScale=this._getLawfulScale(v),this.scale=this.initialScale,setTimeout(function(){i._handleScaleChange()},0),this.container&&(this.container.style.overflow="hidden"),this.el=null,this.ctx=null,this.manualMount||this.mount()}return e.prototype._getLawfulScale=function(t){return"number"!=typeof t||isNaN(t)?e.DEFAULT_SCALE:t<this.minScale?this.minScale:t>this.maxScale?this.maxScale:t},e.prototype._getLawfulMinScale=function(t){return"number"!=typeof t||isNaN(t)||t<e.LIMIT_MIN_SCALE?e.LIMIT_MIN_SCALE:t},e.prototype._getLawfulMaxScale=function(t){return"number"!=typeof t||isNaN(t)||t<e.LIMIT_MIN_SCALE?e.DEFAULT_MAX_SCALE:t},e.prototype._getInteractiveMode=function(t){return e.INTERACTIVE_MODE_ENUM.includes(t)?t:"mouse"},e.prototype._getPenMode=function(t){return e.PEN_MODE_ENUM.includes(t)?t:"empty"},e.prototype._getContainer=function(e){if(e instanceof HTMLElement)return e;var t=$(e);if(null==t)throw new Error(MSG_CONTAINER_NOT_FOUND);else return t},e.prototype._getClassName=function(e){return e&&"string"==typeof e?e:""},e.prototype._getPenColor=function(e){return e&&"string"==typeof e?e:"red"},e.prototype._getPenWidth=function(e){return!e||"number"!=typeof e||isNaN(e)||0>=e?6:e},e.prototype._getLawfulRotateAngle=function(e){if("number"!=typeof e||isNaN(e))throw new Error(MSG_ANGLE_NOT_LAWFUL);var n=e%360,r=0>n?n+360:n,o=45<=r%90?90*i(r/90)%360:90*t(r/90)%360;return a(o)},e.prototype._getPointOffset=function(t){if(t instanceof MouseEvent)return{x:t.offsetX,y:t.offsetY};var e=t.touches,n=e[0],i=n.clientX,a=n.clientY,r=getScroll(t.target),o=r.parentScrollTop,s=r.parentScrollLeft,p=getOffsetPosition(i+s,a+o,this.el),l=p.x,d=p.y;return{x:l,y:d}},e.prototype._getLawfulMaxRevokeSteps=function(t){return 0>=t||"number"!=typeof t||isNaN(t)?e.LIMIT_MIN_REVOKE_STEPS:t>e.LIMIT_MAX_REVOKE_STEPS?e.LIMIT_MAX_REVOKE_STEPS:t},e.prototype._getPointerType=function(e){return"both"===e?"touchAndMouse":"touch"===e?"touch":"mouse"},e.prototype._makeEventList=function(){return[{pointerType:"mouse",action:"start",name:"mousedown",handler:this._handlePointerStart},{pointerType:"mouse",action:"move",name:"mousemove",handler:this._handlePointerMove},{pointerType:"mouse",action:"end",name:"mouseup",handler:this._handlePointerEnd},{pointerType:"mouse",action:"leave",name:"mouseleave",handler:this._handlePointerLeave},{pointerType:"touch",action:"start",name:"touchstart",handler:this._handlePointerStart},{pointerType:"touch",action:"move",name:"touchmove",handler:this._handlePointerMove},{pointerType:"touch",action:"end",name:"touchend",handler:this._handlePointerEnd},{pointerType:"touch",action:"cancel",name:"touchcancel",handler:this._handlePointerCancel}]},e.prototype._getEventItems=function(e){var t=e.pointerType,n=e.action,i;if(t&&"touchAndMouse"!==t)i=n?function(e){return e.pointerType===t&&e.action===n}:function(e){return e.pointerType===t};else if(n)i=function(e){return e.action===n};else return this.eventList;return this.eventList.filter(i)},e.prototype._makeCanvas=function(){return document.createElement("canvas")},e.prototype._getCtx=function(){var e=this.el&&this.el.getContext&&this.el.getContext("2d");if(null==e)throw new Error(MSG_CTX_CANT_GET);return e},e.prototype._setCanvasTransform=function(e,t,n,i){if(void 0===i&&(i=!1),!!this.el){var a="transform:scale("+n+") translate3d("+e+"px,"+t+"px,0);transform-origin:center;",r=i?a+"transition:0.3s;":a;this.el.setAttribute("style",r)}},e.prototype._setDOMSize=function(e){var t=__read(e,2),n=t[0],i=t[1];null!=n&&this.el&&(this.el.width=n),null!=i&&this.el&&(this.el.height=i)},e.prototype._setPenMode=function(t){e.PEN_MODE_ENUM.includes(t)&&(this.penMode=t)},e.prototype._saveImageData=function(e,t,n){void 0===e&&(e="paint"),["paint","clear"].includes(e)&&null!=t&&n&&n instanceof ImageData&&(this.revokeStack.length>=this.MAX_REVOKE_STEPS&&this.revokeStack.shift(),this.revokeStack.push({type:e,paintCount:t,imageData:n}),this.onRevokeStackChange&&"function"==typeof this.onRevokeStackChange&&this.onRevokeStackChange(this.revokeStack),void 0)},e.prototype._bindCurInteractiveModeEvents=function(e){if(this.el){var t=this._getPointerType(this.interactiveMode),n={pointerType:t,action:e};this._cleanCurInteractiveModeEvents(n),this._bindEvent(n)}},e.prototype._cleanCurInteractiveModeEvents=function(e){var t=e.action;if(this.el){var n=this._getPointerType(this.interactiveMode);this._cleanEvent({pointerType:n,action:t})}},e.prototype._bindEvent=function(e){var t=this;void 0===e&&(e={});var n=this._getEventItems(e);n&&n.length&&n.forEach(function(e){var n=e.name,i=e.handler;t.el&&t.el.addEventListener(n,i,!0)})},e.prototype._cleanEvent=function(e){var t=this;void 0===e&&(e={});var n=this._getEventItems(e);n&&n.length&&n.forEach(function(e){var n=e.name,i=e.handler;return t.el&&t.el.removeEventListener(n,i,!0)})},e.prototype._revoke=function(){if(this.ctx&&this.revokeStack&&this.revokeStack.length){var e=this.revokeStack.pop(),t=e.imageData,n=e.paintCount;this.ctx.putImageData(t,0,0),this.paintCount=n,this.onRevokeStackChange&&"function"==typeof this.onRevokeStackChange&&this.onRevokeStackChange(this.revokeStack)}},e.prototype._getImgAndDraw=function(e){var t=this;getImageFromURL(e).then(function(e){t._bgImgObject=e,t.originalSize=[e.width,e.height],t._drawBg(e,t.originalSize[0],t.originalSize[1])}).catch(function(){t._bgImgObject=null})},e.prototype._drawBg=function(e,t,i){if(e&&this.ctx&&this.ctx.drawImage&&t&&i&&!(0>=t)&&!(0>=i)){var a=0===this.bgImgRotate||180===this.bgImgRotate?-this.width/2:-this.height/2,r=0===this.bgImgRotate||180===this.bgImgRotate?-this.height/2:-this.width/2,o=0===this.bgImgRotate||180===this.bgImgRotate?this.width:this.height,s=0===this.bgImgRotate||180===this.bgImgRotate?this.height:this.width;this.ctx.save(),this.ctx.translate(this.width/2,this.height/2),this.ctx.rotate(n/180*this.bgImgRotate),this.ctx.drawImage(e,0,0,t,i,a,r,o,s),this.ctx.restore()}},e.prototype._drawCircle=function(e,t,i,a){void 0===i&&(i=3),void 0===a&&(a="red"),this.ctx&&(this.ctx.save(),this.ctx.fillStyle=a,this.ctx.beginPath(),this.ctx.arc(e,t,i,0,360*(n/180),!1),this.ctx.fill(),this.ctx.restore())},e.prototype._drawLine=function(e,t,n,i,a,r){void 0===a&&(a=6),void 0===r&&(r="red"),this.ctx&&(this.ctx.save(),this.ctx.strokeStyle=r,this.ctx.lineWidth=a,this.ctx.lineCap="round",this.ctx.lineJoin="round",this.ctx.beginPath(),this.ctx.moveTo(e,t),this.ctx.lineTo(n,i),this.ctx.stroke(),this.ctx.restore())},e.prototype._handlePaintStart=function(t){this.isPainting=!0,this.lastPaintPoint=this._getPointOffset(t),this.ctx&&this._saveImageData("paint",this.paintCount,this.ctx.getImageData(0,0,this.width,this.height)),this._drawCircle(this.lastPaintPoint.x,this.lastPaintPoint.y,this.penWidth/2,this.penColor)},e.prototype._handleDragStart=function(t){this.isDraging=!0,this.lastDragPoint=this._getPointOffset(t)},e.prototype._handlePaintMove=function(t){if(this.isPainting){var e=this._getPointOffset(t),n=e.x,i=e.y;if(null==this.lastPaintPoint)throw new Error(MSG_LAST_PAINT_POINT_NOT_FOUNT);var a=this.lastPaintPoint,r=a.x,o=a.y;this._drawLine(r,o,n,i,this.penWidth,this.penColor),this.lastPaintPoint={x:n,y:i}}},e.prototype._handleDragMove=function(t){if(this.isDraging){var e=this._getPointOffset(t),n=e.x,i=e.y;if(null==this.lastDragPoint)throw new Error(MSG_LAST_DRAG_POINT_NOT_FOUNT);var a=this.lastDragPoint,r=a.x,o=a.y;this.dragTransformX+=n-r,this.dragTransformY+=i-o,this._setCanvasTransform(this.dragTransformX,this.dragTransformY,this.scale)}},e.prototype._handlePaintEnd=function(){this.isPainting=!1,this.paintCount++,this.onPaintEnd&&"function"==typeof this.onPaintEnd&&this.onPaintEnd(this.paintCount)},e.prototype._handleDragEnd=function(){this.isDraging=!1},e.prototype._handleScaleChange=function(){this.el&&this._setCanvasTransform(this.dragTransformX,this.dragTransformY,this.scale,this.scaleTransition)},e.prototype.setPenStyle=function(e){var t=e.color,n=e.width;t&&(this.penColor=this._getPenColor(t)),n&&(this.penWidth=this._getPenWidth(n))},e.prototype.setSize=function(e){var t=__read(e,2),n=t[0],i=t[1];n&&(this.width=n),i&&(this.height=i),this._setDOMSize([n,i])},e.prototype.setClassName=function(e){e&&this.el&&(this.el.className=e)},e.prototype.setPenModePaint=function(){this._setPenMode("paint")},e.prototype.setPenModeDrag=function(){this._setPenMode("drag")},e.prototype.setPenModeEmpty=function(){this._setPenMode("empty")},e.prototype.setScale=function(e){var t=parseFloat(e);isNaN(t)||t===this.scale||(this.scale=this._getLawfulScale(e),this._handleScaleChange())},e.prototype.mount=function(){this.el||(this.el=this._makeCanvas()),this.ctx||(this.ctx=this._getCtx()),this._setDOMSize([this.width,this.height]),this.setClassName(this.className),this._bindCurInteractiveModeEvents("start"),this.container.appendChild(this.el)},e.prototype.destory=function(){this.el&&this.container.removeChild(this.el),this.el=null,this._bgImgObject=null},e.prototype.clear=function(){this.ctx&&this.el&&(this._saveImageData("clear",this.paintCount,this.ctx.getImageData(0,0,this.width,this.height)),this.ctx.clearRect(0,0,this.width,this.height),this.paintCount=0,this._bgImgObject&&this._drawBg(this._bgImgObject,this.originalSize[0],this.originalSize[1]),void 0)},e.prototype.rotate=function(e){void 0===e&&(e=1),[1,-1].includes(e)&&(this.bgImgRotate=this._getLawfulRotateAngle(this.bgImgRotate+90*e),this.setSize([this.height,this.width]),this._bgImgObject&&this._drawBg(this._bgImgObject,this.originalSize[0],this.originalSize[1]),this.paintCount=0,this.revokeStack=[])},e.prototype.revoke=function(){this._revoke()},e.prototype.setBgImg=function(e,t,n){var i=this;if("string"!=typeof e)e!==this._bgImgObject&&(this._bgImgObject=e),this.originalSize=[t||this.width,n||this.height],this._drawBg(e,this.originalSize[0],this.originalSize[1]);else if(/^(http[s]?)|(data:image)/.test(e))getImageFromURL(e).then(function(e){i._bgImgObject=e,i.originalSize=[t||e.width,n||e.height],i._drawBg(e,i.originalSize[0],i.originalSize[1])}).catch(function(){i._bgImgObject=null});else throw new Error(MSG_BG_URL_NOT_LAWFUL)},e.prototype.makeScaleAdd=function(){var e=this.scale+this.scaleStep;this.setScale(e)},e.prototype.makeScaleSubtract=function(){var e=this.scale-this.scaleStep;this.setScale(e)},e.prototype.reset=function(){this.dragTransformX=this.dragTransformY=0,this.scale=this.initialScale,this._setCanvasTransform(this.dragTransformX,this.dragTransformY,this.scale,this.scaleTransition)},e.prototype.getPaintCount=function(){return this.paintCount},e.prototype.getDataUrl=function(t,n){if(void 0===t&&(t="png"),void 0===n&&(n=1),!this.el||!e.IMG_TYPE_ENUM.includes(t)||"number"!=typeof n||isNaN(n))throw new Error(MSG_DATAURL_CANT_GEN);.3>n&&(n=.3),1<n&&(n=1);var i="image/"+("jpg"===t?"jpeg":t);return this.el.toDataURL(i,n)},e.prototype.getBlob=function(t,n){var i=this;if(void 0===t&&(t="png"),void 0===n&&(n=1),!this.el||!e.IMG_TYPE_ENUM.includes(t)||"number"!=typeof n||isNaN(n))throw new Error(MSG_BLOB_CANT_GEN);.3>n&&(n=.3),1<n&&(n=1);var a="image/"+t;return new Promise(function(e){i.el&&i.el.toBlob(function(t){null!=t&&e(t)},a,n)})},e.prototype.getFile=function(e,t,n){return void 0===e&&(e="drawingBoard"),void 0===t&&(t="png"),void 0===n&&(n=1),this.getBlob(t,n).then(function(t){return blob2File(t,e)})},e.prototype.download=function(t,n,i){if(void 0===t&&(t="png"),void 0===n&&(n=1),void 0===i&&(i="drawing-board"),e.IMG_TYPE_ENUM.includes(t)&&"number"==typeof n&&!isNaN(n)){.3>n&&(n=.3),1<n&&(n=1);var a=this.getDataUrl(t,n);if(a){var r=document.createElement("a");document.body.appendChild(r),r.href=a,r.download=i+"-"+new Date().getTime(),r.target="_blank",r.click();var o=setTimeout(function(){r&&document.body.removeChild(r),r=null,clearTimeout(o),o=null},200)}}},e.INTERACTIVE_MODE_ENUM=["mouse","touch","both"],e.IMG_TYPE_ENUM=["jpg","jpeg","png","webp"],e.PEN_MODE_ENUM=["paint","drag","empty"],e.DEFAULT_WIDTH=300,e.DEFAULT_HEIGHT=150,e.LIMIT_MIN_REVOKE_STEPS=10,e.LIMIT_MAX_REVOKE_STEPS=50,e.LIMIT_MIN_SCALE=.1,e.DEFAULT_SCALE=1,e.DEFAULT_MAX_SCALE=5,e._defaultOptions={size:[],className:"",manualMount:!1,maxRevokeSteps:10,interactiveMode:"mouse",penMode:"empty",penColor:"red",penWidth:6,bgImgURL:"",bgImgRotate:0,bgColor:"#fff",onRevokeStackChange:null,onPaintEnd:null,minScale:1,maxScale:3,initialScale:1,scaleTransition:!0,scaleStep:.1},e}();export default DrawingBoard;
//# sourceMappingURL=drawing-board.esm.js.map
